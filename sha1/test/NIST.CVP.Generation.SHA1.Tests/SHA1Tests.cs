using Moq;
using NIST.CVP.Generation.SHA;
using NIST.CVP.Math;
using NUnit.Framework;
using System;

namespace NIST.CVP.Generation.SHA1.Tests
{
    [TestFixture]
    public class SHA1Tests
    {
        [Test]
        [TestCase(
            "6162 63",      // "abc" in hex
            "A999 3E36 4706 816A BA3E 2571 7850 C26C 9CD0 D89D"
        )]
        [TestCase(
            "CAFE BABE FACE DAD0 DECA F888",
            "E6F0 CCF9 9E46 DE75 236E 9A1E E121 EAD4 913F CE61"
        )]
        [TestCase(
            "0000 1111 2222 3333 4444 5555 6666 7777 8888 9999 AAAA BBBB CCCC DDDD EEEE FFFF",
            "460D 008D B9AA 9FFA DB2C 6F2B 1F74 201A 87F0 881A"
        )]
        [TestCase(
            "",             // Check null message also
            "DA39 A3EE 5E6B 4B0D 3255 BFEF 9560 1890 AFD8 0709"
        )]
        public void ShouldHashSuccessfully(string message, string digest)
        {
            var messageBS = new BitString(message);
            var digestBS = new BitString(digest);
            var subject = new SHA1(new SHAFactory());

            var results = subject.HashMessage(messageBS);

            Assert.AreEqual(digestBS, results.Digest);
        }

        [Test]
        [TestCase(
            "f420de4fac7a93304f01e9a4cc3c65f2e042c8a08a682c37c01c5046601131a9699dda0b6b5f7caa3c24c15aed0b5ecdfce8e811cbe7e85a51723102105471ce471e077368c91459cc9ed59ea653305e36778c323f10e6f6ba8221d0ccb29e6df66c0d8e8c0283c46836cc77df5a022df4b65e09cc2a4f926215c9b77c75e00fde4f9565bd51f07376b64fee806afdc39f6e06a15b7f4ab7b1f2d1bf08e35e3b678e47fee4fd83ef60e4050a71c948a7a0672cffd55500ec0fe3e0f058454179f9f3ca63ea4f66bf8c8897d39abf0d615d69772d20f599b9e4ae9e5355e2b051fc44c79cb58fbe6b646cac51e496717a403c8f3226a73ca6981cb5efe504d44cd84ae5af2f05b67c4e57ed8d35949e79b0a71d16cdb2113c93f5caccf1f1d5f1f5cdcda63ff87379b410018e7703bce61574c9e1ff6041023e0188f362f2dac9bb952688ccb220eafd60925c9029f24ad6693a9ca3f7f481ff07946b1e4f0b5b9369995ec079e357910f45006a4f692c5d4f194fa1c0513f3fd1993c0f50912fe312ce2f0296e449d8e5c481ebbc491411ed0d00e10381c667253d6f1c3d94cd14596c037a514c483aaab7e7fdbab98a5a0dbfb94a08ac9eddcc280b2c5d3bbe8f041ce310f143da1f25c53b",
            "644e38c25821211924ebd70d64ccfa33a2e97474"
        )]
        [TestCase(
            "9ff18c3639d8f1f66c2c71435e0909359c5358fc61ee04bd16325a9d1599341bb2bb20a27c7dbe5ec0856a504ff11b9d81488b2c7ab0996fac62eb819d5cd772eb5584df8df64cc55b476596d168c18d1081323f25fbd2748ef1a234fae1712551a80014f4ad63d1465caa406bd6c1ad50e69560eb387871c4c5c7deb492cadbec9adb693a08cb2a88aa8174a6a3e4a44960fcb553cd531154c8a2a651d6a93dc5145f07e6714b79291b325a0837f21b03d5ae66e5232bf948e07ab55b14d8f2e3ffd216804fad663296041c1bfab3b9872ff49c29a2c8d4a7f799335ab61da34f417dbd910ab798aa0241df6755ef27dc54167fa8b2f2487af44547d42341f80fc4a825a00a32b899492fce73ae6d0c0a2e5c36e9bc70fdc8bfc71953c30c982d6e9b7635b6e56d0852160ec76ef6111aa30dea74260b9d994067d25efe452cb0299dd7d8789a60fd0540caebfe52de139d73c2d25a8bcdf65f6c9a7e3cb65ba1dcf77012b71739834af42868c4491afd03d4e78abeb837e504209839e525ce076ff26a6adc259f9f097950c42aa26de0bd798024bc59837117c9f51a615b2deac9d4ed694d8c3a5b2a186b8a972781c5b2aab629bb38599f80b0d8a618201f53d4e520957314b3be9519a13f739efbb3ccafb120231b5f79271d6a67733b4c48776f2c79b685b2d033c4196d25d086b3f2cf98915bcb4006f457d3e4d8765dd49ab8399a7fa6de9aea60fc9b1785c8cc0c539304cd10a24ed0a83aa5b097fafc25096e823440e023a3377152b08569060383cc02e0b12e5aa156c7336467caca01aaf3b83f1b5f74478fa11958971269bda76812fc788b3151aaa4155aae764514e3f1c406ff0493bcb1b47877856bfe230792bd892b61dbc6ecf6d3fc34a57547fc902ff3b4778aece5d1f775151bcc1deb708aef935a61ea64e8f6b1c00063833cf77f6c015f61bd73201fbb10cbdb949a2a0197781ccaa35a9f05e01c2f16aeed4f3fdbb0651e19a2ca77af3d22346e5de9aae7a24f1edb154688f30ed996b155bff4a78730cbe7bbf788ba66c9de957cd50e48d89c6679de0307515fa6ec75bc7028384f696f0f06ced8455167e1ef3f15b423e4aba965fdfe0b62d7401fe16c8962f6cfb71378cb78f1b6c7a54666edd224de8c23ef87ba611b8e3d4c37dcac332b49d1c3be0c521d5b76902b14e1d033e7e399ac40c75c51c03d5b753d50c3960a991b3478b2e2e39cee74a053472e618498d2f0a50d2df881d7f7603824fad9874e77b34952c5f53e853bac0c825083836701942541737ee6c4dab8304099252ad0abe83ad54179c9a2acf846797ec26db7ec43c94b770b776ccc232e8ce8a17c877f7a52219f98c3af912c09140046c9ef5ca3981381c5bd38944938f02e7604dcbd129a1f2779b613b0f05d3b1d361f79195c9a81d9d73f8efcd45954b5cb4a352b5718b720452936d1ea4bd61ebaf8bceb17d77ec66785d7ca6996a0c3c9d7fb93f2d6d2d423a580bec5dacd4bfcda209a7c58f0919e187cc7b2f9bca1973297bb8adc56893cb1593e271308ec21500ded3224c183a37fe3bb578990975fe36f6bc8302d88b7d52918b9fc704954dfebaee243d7e29f42766e004e04ec4673ed6d54dc3d19bd99581522a0ebaabb1122a333be1cf6b9ea9ca7545101ea76697888d5e8708376864efd0a0462567e6d1a95ce9c76091afebc30fb996dd7174d7783f35aac10092373981b32be96c67b3c4b5ae5cf61e90640cf9e2e32fc50a85427573cdb069ff830adfb31e5b2bbc4ee8f80a10e474f8b8f4de51936a14a01763ca995e4ae5f8eeb065209c1f284cf9927e8d91b03741411717761630e2de0458a906eaf50726c0d69c9c3399d4a24a6dc3995dedd7f292e05fd0e9f8a20cd29d8b5ce2434ff1bff9f076534fd344c7b761bdb3f1d98524ecf1e29d45e4b518aefc0bd2ba12f212870b5fa9c586bce82bd38b5260ae918d99983b9e9d3d7f3d0985844ace12a08efa37b8758f716322279352a7bed97023729d3c6c62fec3c639925698f3a1757be02001650225e01c271bd42260ecd99d047b75953bab1b3acbad136bcf51e97fc53edae6c216bc2cc6e76060fb5b1630dbdd77878be4fe011c501b31b59694f105fe958943b64fda738087d1e2a6bea5452da2e1d81ee4bfb805fe795b01d0764ee9d1bb0b9713bbb971cb03cb424b60ecd69802a4cb47dd3b593da104065485fc8b1ffa8e3bc0270535aa54f9d044da4f72b788767ccfdff2a45947553679869b4cc0c64016add2e336966402b32397c98c91d1c1a5c53e9a81c1ead2f4b82ea7b964bcc5ba6515d00f2fbf8a7d7020078ea77d1ad8d08f7f6c07f9f1c3a8b4ae5b9c3c93996e865829c6a5e591a2e975e378f8f6786a393dedabf32645c3df2bada7c41e26229ae8110bd59882447a813576c3c9270ac242612e7504ed81f48c2a47f1e9f339ca0c5f5fcd37d1cd59d60f316c27472ab12970ffde021d6b9b5c5bcd346b831caa415f42db3812b5edd0bb3960755b529c4f97a0cc9268094a28acd80a375833a203bb55ae1da796cd0dc3ef3f57f60aea414fa19f5a5fc3775da7d8f1b1d52747efddf8a44d02d86de9d3d3573399cc019af382e4be5722a987d740798fac50124241ac6c6ad70356f14576568ca91e98b94db52b3300bf6713b5bf0015205687c7810154eb769ffeb0a358abe7b66b062898c8e15ccee226adcda533e6e3931ecc0667fc538416fba487fac5c94449d0757f3e959024536e927983736968ae5dec6c70c11761f0a4493dcd32a5d5239e0c6b76b681a35bb58e53ea4d312200bb950d9c51bba2c5af2b6f408101db90b569d811c285ce8381ede73a2fc29222be52744b1cb4b8fe62a777052f61ea09cd2a6f80582108635a3dae03a9924b8ceca13b1d80a73713655a0f8bac4a63072baa7c52d5e7d363a4fa12d73934b0c7bd0dbc843be78fad3dcf7334762fe901777698f9ca5ec21d08afa0156d0e643ba5f4930f9d0a351442545ca01b86eea1372b4ff5b3da56f7ebcaf04e9393d8813df239202293c9f119a5164f0af3d63ec124fbd7110f047cd4d86df36b698010fb8329567af8b0bc3a2e5aa1d2db5252cbe0470e60515d144a5483a45303ed635523ee22f4cd7bee1a4c7448f1b1c585ae099c0c3035b376b2cbdbc1c8d78300d150f2062e76ae0f30ac0d94e62bb23ffdfd7570ff40c9eca4bac0ec5b78e37206a6cf809688a98813b981163e8daafa22386dad2bf6e30ea68ded84894c812f5b71e122bb6800e149f1796d597c124cb146ef4144cca1552ed1cc1ab0e6dea1565ee15d0bb946b339e050dac56b7a9031a564bde8367758a402c71f80cc7e606dda1aa005e0dd767a02921f10c0566d09d0887374c8f771bcbd69137751c2f52860278c4873579370d4c78aba3f484bd054a51288f88438cf4e4c96e33b5ec80c7d828231e527a2b4d36bae202ca2b4fbae551b8349b0265251cc0a72dda46190aea61260cad01cbc8af909e11cf821024a12eef2310dc2fc5481fe94bd365a4b601ccd4378e37a0e77fa2e8b84db287ab4590d5442ff8703c2e8d3d75e770a933e51035883c4431106d97c7df8ae23cb89b21737f3f7fb3f197b3a9935f8fb1e85ed651e7014f06ac4317446ecf3bb8b16986d0bd8a987d4e4a38388d83ec433f34c6313d2380a824c7cc664d64e58200786af4e4566c58ba11c6ef4b9bace79f2e87dc70eb009edec25b35659107220b9073e8deec23cb9db202d8b6effa257016c25a6aa1f77044fb6fb99c9eca213c7849b39194e45f60f696fab4c7fc861bb21eb4118d8da7bd3caefbdbd25506fafa955de796d79a69a52a5d2e6ada9106cb44f14ff7e8cab04bc0020b77d159acdcffefc73925072187650a0d21bdcf9a28db190b26336187f14ed612d365a3bce72e7018c6f62bf063f0083734cdc63f938c352d6394f5a9f60080da2e3a6a91e3cbe8c48571903f03725f96eb31005ed2ff4b9cf6330d7e227d0749d2773993987d60b2bebfbd742d9418118d12055daedb66422739316e3d6e73490645952aceeddecab9073af9aafe3a8f64975ba6efc98b063ecee9e10e7acdc111cc08be4cc36df4bd7290344257cdfab6e98c9f5d70c4d08219be3f5e4a1c983c3319b7dba612181428468fbc48da39cc2f20b2bf7918883c4337f0f58568b8cfa3517d433ed71e0450e470e2786734ee929d46df8b9017b473dd5c9bd4b908124336784c34c3eed613f2417a907fd3643a8dc2834f326332d236ec18df18704c3c5211bd30de71d298f9694d3727fe754e7790746c0855fe88cc06334d8cd8c7b52dae60d9318d3f0881502316699d6af6e4177a8b1ad55fbc2714b5c71e28c9d74db9fbd8c32b678a105ec4d44c988b5c5bbf5c546ecc9f97cd7c67f4d5489bc93c9857d49d34904730fbf71ad8d720a564f0e46e0e20044048a80e7db92185b482b53c76c58e0366688f8590164271fc8712d88202bbd7df20fe7509d299cec0a576726645230810408237dd0dc2c6874d8d013750835f9edbe863412999c0142f45c04b25d9e66d413cd3aac63d666e3dca27360262e6a303cc9fccc50aa1d9a889efce6b9ae7a4f226219e479c9adae02f1227203fb2161f14f254aed2ba3696a9c796214d51dedca6eb629ac8aaf3bc2589b0b0010c20b827247eeddb5354830f104c4eda6d428525f79dc7a8dee05b15567cbc923ce9556dfdf4890bb45bf6229297fb2883f9770c0ef8d4237dca45653f314bd98a987e4e455e8a4c2472784a15202f21db2a3ac1f81bcb23d1d8007f0d7866be3e55bc32c363f985edc190ef608ef2acbcfe54ae7dadb38f203316c988f814299f4a958140acdd9e5571c6793c8a4cb1709d4f396557954eb3020fad775a5d02f69c93a384e13e7ea5aaa25171bc46193d2eb3cc77c0784ad26e7191a34549318b763e0157a9240f2493adddc7cbe7ca6cd906ce7c90646ac59fc6dfd562e19fa6fe1d0181ac98381c556e86066038ad44c8d2a73d716296d3bc95fed3592c328f5cb80cc993a1e1d3176db4f5223faa0f209ebe7f0978b645ed675665d132d38db9978bf80648f2920233d05dba06aa130cf37d0d00b1b3635cc34f5572fc6bea3d43e4d6ac9454a13e474006cf95939ab2584baeff1273752e31516ae591e0ec0f43812b2e8ded48f2316eb80af24fea3a559029aea5dfc38e39c46bd2fa1cdc581fc8bf333ba6cf477ac03b1327c44bcd72b547b471df95a2641021e03d05023f60235a64a7687d64a9a056913cdc07933820d0ba7e5c3292399d54b86485a5ed8df9c369d8199c714675d32c377d65b32e3a8c67d53ce38741d4cb0276830e892eb1c3e9d6a27298daa7788d2291ac55dd6b42647d69f0a9021b50657ce6863ccbb5228daaec48ffec9e0e5c04ff25a3cb1cbc587ec9a11f06dba9897d98532eed6ca8fc5bde65ce04c15c40e6af18c282b3c0ece1463d12d57d9f178180bd861b3e1cdef15f132eaa7a2ce2cf89ccdd8a9a17c8adc70ea9f567fab791860e6dde9348dd75599847673144eac7758b1a69378993ea335a0df0038210b3928c0abdd3f29feeb33d40c24c6dffd75b9ba1a9f4ddf5a0746a654eb8ffcbf18c81864066e3cc64554a4144346fc90523459bd138dd98d87186da95ed388f535c3308efb5e30ddf270774735112f25bb5d1306a6a4f219a12f6944f0cf605e0ebebb95326ba0a6810bbffda0b1e1fe1f98787fbf4fc3bec3f01ba037c01d5a01ff0c0f3222f6a06fbb00afecb5afa9ed8afc90c3dac8cd8e0f0743aa521a69be18c4657120bd5c2cd2cbe69f78f2b9a38901d26ad26bc65dd0bec7bef1e20da1a0573085c16f5a36f7842a2f9855add0373acd0ac34749b1e9a474ec2bfec64b0a46e8d6a186fb1c9dcbf3137042e701fa09e92a29c5c838ce5b03b86cdb2418db1606ea2d9eef4c39f5d9f1bd44f5a765f1af4f7271b240d344dcba311197a977470346e201875460b43720bbc66a3eef8487f139d5a878ace46858150ca16b834c76635b7953b38669a3571861b5471b251ba5fc6c0b2ecfcc4f288556d1dd73b8c8c5e640e4e83f9896db4f81573e6d75d2d416af6af1906ef9821e7a998dbcfe82f53f02bb70d0c39a43cdbfd0b34ad93612250a386fb34ee01b2cd268eae3903d67b23937dc0e7d26171f67a21457d1cdd6b41703d79cdeab5a5d08d0737c104093ec4efa882d17b2dbb1335bf008e2029820504de7a1b0a3a60b8860b5eae1450049de6413d145c8f82f8d5ec4d2ac6ced1640970e864771a4d4db8a30b4a5a343574214ed8f69e0f2e6e03b114973653be2624fcaaf158ddd256ccd626dbff3c391247da3bc06935273d67153d1e9940b312ff89a80ad609599d69ad97aa2af1793f01ea4eb9e48ad52da820b107171e17f1421fcaf7192849e8382e46ff04d95bc2f788f92b3895a1066fda569ad774528b95c6f8ff48c10a00e1631c22b57e4865d0bb245c8cdef18f634c151f02cacca89e871a6b8b5d04ad0b54ff5a6468a9ee358cb79509ee2e912d7dd7ddbfa9ec10086918830c839fb65e08d8f0391de426cd019a1ed74cc1d57475821d37971c8a7975da8ff0bb43e58487902c5d2763d54125b53f1d801020e13dff27911ec4e099b248d7628e580022d90d56f80e8cc338fdf0400413853d1cdc3743f6c64ad812284ba3888246d0e30739b63158c9b75b933468b38c87f2cc5a11b98e16173b89dfc93a8a21751d6c17fb94318f817b52ee670152737d0999c074d0809693d0a9e0abe591f34daf68143a37203a1bd5c41673510b51d1482d154ad1f5ce26611732daecc57f374d7d03e0e825e2018e59143ea104adea782d617a04144739b47edd3d974d4d99c153eed4ef680e9a6ebaefb238650f306144acecb10688329384eabb2d51e5dcd193dcfe9412464e3c8fafb66057ff0bca18ff8820f2197bc4d1603ef8fbd06946e5d6461f4b1385c27f5d315f0206e37c5161369901837a0f0e47ad3e7195a7e7f0e394d73afba7c633ff0d7e8dab204098dbde635b4d993ee3a7ef48dbbcfd7e5d0bd00508881c1153a0310520772adc957468c727ff3f17f789ee5e62cdd5d1d356e2f1dc424d6b8645853ce5f16a18ef34bc0d8e22d364f3f491c82e5196aafbcdb2e3dfb0a09b74f8f16a01a146be4e23c27db73dbfeb7ef1c0cd66d0a7cf7d772923395a7e6bc6c05dd99f0f27945c4a635ecad86a75418763b632d07208005d2df811c850a124a6b1cfe5c47664beb085faf17b3cc9e4be63cbbbdb5e1f2c85a7ac8f837c0635b0d595fb4799f41f5d119752af9db10e9ea6542978d3daabf98085dd126c62a2e8b1730a20fa0c255af07e15fbf5f367301599a430390322c19ecc20fd867d12562eb03ad8ff7678ae08f763e8ac58987b98e25389f9603ce3ebc883cd341e2e013296b2f612f9c161434964fd2aa8498718765e0d79ba9f694ec32b09dd0f9ef1a66b9b029a5ca87c88be3fc2d8ab215d7b9eee4422d8f35aae034339e816092e73781c84ff68d406be9c1dbf1c28c904aba22bb55c84e1bff5d1f1e5bffc18c17f055e05a8e5ee07cf2c257d5fe9e9848eca3ce89084109f0a755d96c98872b1b45a890dff9b9d88a2b680830ab428e60e5d496524a12a02d537b1d36e84bf06f9bec4226b518a8f1f82555983522e3112a57cb582a3d4f13e5f122516b6a9c8357b37ce54d15d272ed7cd88348ba46d81e8fb5f1052b8722d34aa1329e8d60052d70b9822e1bd55b7ff1097832632a3456feeeb38767e908affa1250fe0eeb6371b68083e4a5223a240450edaed7fda45827ee161d6ce503d081fe331679af0cc8e75a70ed3c598d7e39476a0a6341a6969d2caf23b4ebc2e974bd6f54482b8f97a5bfcfb46bebc3f2f26553d1af86b996b142e556da9db46f44d85c4414d15a62541906e6ae498c06e2336191174d6bdd16993f13485b56b674e780724a310bbd850e9cd06e03343e6b39e9c535062bde4fb832e588b538637763824b62eaf20dbb09181e35996b1e1fc172ea7331881e9f28574a062bc80adec4c85bf93fcbe768810f3c9f8c7f0a5292837d6c5fef22b76222bd5b2f83f11d93c90077dff7bf100ec8a7f65d0ea7a605a1fa9af1ff6f1ade0bbbf2510adab6491af5592bf409342afadcf47b885aac9334ee599807682c24a8d26610bb1c2b6d249727a44f6a673e0c67f4788ab7c8e3d2c552a2b5b27dbe507d20ef1329ff687c527de968370be083c580c474337d40022c00b278b28213b928bd5cb1a8b4d398d3a66bed13a49ae77223ffd3524c60396ede47cf0cdbbd397185ea050cce36f0873b9c3c64b3c5adfa587b3698b89cef1a55c33715ed1357c425078bcaadfb19e9c80ad4cedc095dca88d70c6b448e99cb01b52f5228deaabd1535b466f6987b77b62844a66fde5d6f5f83c36e629ddfdd6cae4666215798a8d1152d661ab7abbda0851a7ff1ad53552711fa16a54307edf11eeab66916a833d2f6454caca11127f191c4d003fea6188a022ed89f26d8692977aac762a46fcab589aa8f0f1d525323eeb23b196aec25f2c4c03882b197cb8058f51da07935f9d32faba1c464c5abd1fc8115944a8c09ebea6cbb226beca19023682d952dc13dc658f7295f1001ae763baff427460c40ffd362d4e0ce3d77d377627bc30a680309a5eb9a51b79ce77b3cad5b24c5f3478920612a304110bac4b5728cccb7b0e6079717592ec3ddc36b6fe7bf2f42c7aa2241e60fa37cfce6de7e16d4e4be22536a9cf90a58bd6aeec1560da4a954ffc555c84019bcda5888ab31dde8dd8642d78d380f02621ccaa6077f8d80157512458e242dbceed1ba1c9561264d098888eef9e8d7f5dd5a53a5c85cc5e6161b959755d60d8dbbfba81f379c8e55eb6d6b063b3fd2391d0ebc5a6e7e755b0dc0f027275e4df096c0991d0c3484a8058d6fc9cb9d8c60c3925b307444ea337efdc8918d3d8d7a21c913727dd997c7ea711d86159264f1439dc6b4744",
            "eda9df791239cd8d343f4ba9e11db9c4ea679d31"
        )]
        [TestCase(
            "638985ba4eed2b8ad7a546b620a1105b6578d86278090c4a6d62982796e16eebb29866e561f64987dba4286ce2aef39af5e34704c77e8653ef062de5e17262161d91cdbfa6a9a9fdb65f1b34b0d6c253561b8f593cc1d7187cc8a638acc457800d3a6151054e7473d09bc5157263a60ef0e85969bf1926217d71ab29df1d74afeb5dcba2672cd1729123ce17109bc6542b124d3d39d09bf758c9e3bf62c6e12d1dc0b3",
            "fd7f2c5502a682eaf2977d7d12cc1616feb97c3e"
        )]
        public void ShouldHashLongMessagesSuccessfully(string message, string digest)
        {
            var messageBS = new BitString(message);
            var digestBS = new BitString(digest);
            var subject = new SHA1();

            var results = subject.HashMessage(messageBS);

            Assert.AreEqual(digestBS, results.Digest);
        }

        [Test]
        public void ShouldReturnHashResultWithErrorOnException()
        {
            var iSHAFactory = new Mock<ISHAFactory>();
            var subject = new SHA1(iSHAFactory.Object);
            var exceptionMessage = "Error message";

            iSHAFactory
                .Setup(s => s.GetSHA(It.IsAny<HashFunction>()))
                .Throws(new Exception(exceptionMessage));

            var results = subject.HashMessage(new BitString(0));

            Assert.IsFalse(results.Success, nameof(results));
            Assert.IsInstanceOf<HashResult>(results, $"{nameof(results)} type");
            Assert.AreEqual(exceptionMessage, results.ErrorMessage, nameof(exceptionMessage));
        }

        [Test]
        public void ShouldInvokeSHAHashMessageForHash()
        {
            var iSHAFactory = new Mock<ISHAFactory>();
            var subject = new SHA1(iSHAFactory.Object);
            var hashFunction = new HashFunction
            {
                DigestSize = DigestSizes.d160,
                Mode = ModeValues.SHA1
            };

            iSHAFactory
                .Setup(s => s.GetSHA(hashFunction))
                .Returns(new SHA.SHA1(new SHAInternals(hashFunction)));

            var results = subject.HashMessage(new BitString(20));

            Assert.IsTrue(results.Success, nameof(results));
            Assert.IsInstanceOf<HashResult>(results, $"{nameof(results)} type");
        }
    }
}
