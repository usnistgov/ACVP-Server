<div class="container">

  <!--Row containing all the page content.  i.e. two columns -->
  <div class="row mt-3">

    <!-- The lefthand column containing a table of sessions -->
    <div class="col-lg-6">

      <!-- Row just for the page title-->
      <div class="mt-3">
        <table width="100%">
          <tr>
            <td width="70%"><h2>ACVP Test Sessions</h2></td>
            <td width="30%" style="text-align:right;"><a [routerLink]="" queryParamsHandling="preserve" (click)="showFilters = !showFilters">Filters</a></td> <!--data-target="#TestSessionFilters"-->
          </tr>
        </table>
      </div>

      <!-- NOTE: Handling the collapsing of the box using ngClass instead of basic data-toggle allows us to set
           the filters manually upon the user loading the page with the params set.  This allows the flters to appear to
           remain after navigating away and back again. - RLS4 -->
      <div id="TestSessionFilters" class="collapse" [ngClass]="{'show': showFilters}">
        <label class="bold-heading">TS Status</label><br />
        <select class="form-control" #selectList [(ngModel)]="listData.TestSessionStatus" (change)="loadData()">
          <!--<option (click)="setTestSessionStatus('All')" value="All">All</option>-->
          <option *ngFor="let status of TestSessionStatus?.values()" [ngValue]="status">
            {{status}}
          </option>
        </select>
        <div class="row mt-3">
          <div class="col-lg-6">
            <label class="bold-heading">TSID</label><br />
            <input type="text" class="form-control" [(ngModel)]="listData.TestSessionId" (ngModelChange)="loadData()" placeholder="TSID..." />
          </div>
          <div class="col-lg-6">
            <label class="bold-heading">VSID</label><br />
            <input type="text" class="form-control" [(ngModel)]="listData.VectorSetId" (ngModelChange)="loadData()" placeholder="VSID..." />
          </div>
        </div>

      </div>
      <div style="min-height:540px;">
        <table class="table mt-3">
          <thead class="thead-light">
            <tr>
              <th scope="col">TSID</th>
              <th scope="col">Created</th>
              <th scope="col">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let session of sessions?.data" [ngClass]="(session.testSessionId == selectedSession?.testSessionId) ? 'table-active' : ''" (click)="setSelectedSession(session.testSessionId)">
              <th scope="row">{{session?.testSessionId}}</th>
              <td>{{session?.created | date:'yyyy-MM-dd HH:mm'}}</td>
              <td>{{session?.status}}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="text-center">
        Page {{sessions?.currentPage}} of {{ sessions?.totalPages }}
      </div>

      <nav aria-label="Pagination Buttons">
        <ul class="pagination justify-content-center">
          <li class="page-item">
            <a class="page-link" (click)="getPage('first')" aria-label="First">
              <span>&lt;&lt;</span>
            </a>
          </li>
          <li class="page-item">
            <a class="page-link" (click)="getPage('previous')" aria-label="Previous">
              <span>&lt;</span>
            </a>
          </li>
          <li class="page-item"><a class="page-link" (click)="getPage('next')">&gt;</a></li>
          <li class="page-item"><a class="page-link" (click)="getPage('last')">&gt;&gt;</a></li>
        </ul>
      </nav>
    </div>

    <div class="col-lg-6" *ngIf="selectedSession">
      <app-testsession [session]="selectedSession"></app-testsession>
    </div>

  </div>
</div>
