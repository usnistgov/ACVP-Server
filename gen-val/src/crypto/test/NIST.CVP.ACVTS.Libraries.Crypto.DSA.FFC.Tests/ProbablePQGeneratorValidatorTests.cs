using System;
using NIST.CVP.ACVTS.Libraries.Crypto.Common.Asymmetric.DSA.FFC;
using NIST.CVP.ACVTS.Libraries.Crypto.Common.Hash.ShaWrapper;
using NIST.CVP.ACVTS.Libraries.Crypto.DSA.FFC.Helpers;
using NIST.CVP.ACVTS.Libraries.Crypto.DSA.FFC.PQGeneratorValidators;
using NIST.CVP.ACVTS.Libraries.Crypto.DSA.FFC.Tests.Fakes;
using NIST.CVP.ACVTS.Libraries.Crypto.SHA.NativeFastSha;
using NIST.CVP.ACVTS.Libraries.Math;
using NIST.CVP.ACVTS.Libraries.Math.Entropy;
using NIST.CVP.ACVTS.Tests.Core.TestCategoryAttributes;
using NUnit.Framework;

namespace NIST.CVP.ACVTS.Libraries.Crypto.DSA.FFC.Tests
{
    [TestFixture, LongCryptoTest]
    public class ProbablePQGeneratorValidatorTests
    {
        private IShaFactory _shaFactory = new NativeShaFactory();

        [Test]
        #region Generate Tests
        [TestCase("SHA-1", 1024, 160, 372, "e735ffec143c6a19c44c0418ecd7a3654d746bd4", "f1276cbd3a5fc31bd60b98f6258b9f9134dfa2c67bf982d7a33949384dc088d77ff11787f92c8d7f1ee505434ad2f1c44a7abda95b197e3d42a00de62959e093eab6ef0bc7ae9443fb3dfb40943da4c6d9f1cca1da8aa7fbba72d5ee436f56bb1dea6d445a066a6b346f0ccb767368535327091f6a2df03474af298d00a73767", "a821e6e9808f3062c9970abc492bf3b34a69bc55", "ProbablePQ Generate - 1024 - 160 - SHA-1 - #1")]
        [TestCase("SHA-1", 1024, 160, 120, "91fa5641d6c7dcd1bbb267a661c277cbce3c0235", "df1f3d5b870f7dfa31ec6231a40e1561f9e9ca1fd3ed8a717e9be3df6a5c9ac7ce5cdd9d329a203e2a04d237b55da18105494e7c212c4e106515b8acb758acbf6ea0ede72bb7192065da45e73fe784991ffb3ba6ae71cb0404aa52d800d3ec7cd3dccb1cd6215826b3f21a69b20cf442b7328db632a56dbfade8ca48dc7e1ce7", "e3d398e45c4410dc110c616ea425b88bf0c1e2b9", "ProbablePQ Generate - 1024 - 160 - SHA-1 - #2")]

        [TestCase("SHA2-224", 1024, 160, 125, "de012d7d4d4d30fa6d82dc4f66a031b46aa2b4fa", "8e890fa8535d1866750d52728cbffc3a59990568e90629b4236ac822a135f806d8ab6e964ff43eede0a14783d5613198e2ce65e14c65a268d798718276c4257d452f9b9e498dac48bd2189ed8ce6bf08008692ac7c1864ee3a3e030d6fef2183d22849a5e40c18e7cb79f5355b45b41a0a37d0dfde801059f3d2a0d44d48a49d", "bb6ff15394523b7d8d4d9acb391e9be9cf9fc741", "ProbablePQ Generate - 1024 - 160 - SHA2-224 - #1")]
        [TestCase("SHA2-224", 1024, 160, 420, "56d37ae56e30281487447915a7565870620fce49", "ccecac97f59b444ab6ff79017a5dc34c995c061906f29420606d3905c8baf1c43a911d44575f12cebe8160cd773f877adbf7aa7f1180d643d00d6f2b87213f465b72e85e974875fa91090fd5b9baedbd901118510f5335334533340974dbc700466b6d469264fe0167739ebbf3f7d1269d52da289af35daf1e60735d0f081fe9", "ebb94d6fb2129a98fbdd2508e2a5a8a1bdbe8e19", "ProbablePQ Generate - 1024 - 160 - SHA2-224 - #2")]
        [TestCase("SHA2-224", 2048, 224, 1209, "78cb902177b7adfdf5bfb6f2c74b6d8fa7ffa5f32299538007d19c7c", "f75857d42213aa471c47c5bec4137d32903d5436fe66fe5bf92ace3db6b0d706ea8a8dbea67ee8da4843486e6a3ae0290210b0c3745fa366ea21d6a0497efe4ebc679045ff27cd70f75b09d92561ced827b185503ee1b4215d0014833916b02ac16bc55c1f82477cb41a2d6b07d8b2c163646760f4c2f678e6cf9ee944526a16e4bc5d4afa8997d2d89c0610a6eab33593dc8dbdb4fe9ce4d5effcbd94b5da6f7ea1b3e89279ea4a93ffc32cdaf29081b134134f894b701363cf44ff28092071d53d2a762a5e289c4be29d08e2c96cede3babbcce986738a740cb7a1b1b263faa5f24f9035f01326f7c34bdc10c2463df446e3fb3c734faf4000e300a8744ce3", "b552cb84a63945f33809aad2db217b96325bb81e127b910ae81920e7", "ProbablePQ Generate - 2048 - 224 - SHA2-224 - #1")]
        [TestCase("SHA2-224", 2048, 224, 585, "01b707f9178c28063734180b689d5a771f4ad3e2e1c00c6df9da5239", "9a2dac8050164207c01115f15d296fd8450e03a73f314ca783463143dd8e413d9112c7943a3facd922d9eb3a484fb1bd2aa07130d66eaae600495b79fca781813ddf9135ee4a31e1539af34dad3aa32324a20a7fbbfb36d23ff290d24821ad990c7edc4efadea0200042be078fe2b21c5ba7b2d437f6633aafc52f32fb8a87365e9d863906255298d2c1e539296cee41a5ccde41756f91be0eea680649ca9d78c19a82b6dfd3956e268c7a5156cc8f98ecb1945d78945576a23e4ac73641435933d67ceb97f23feb50e3405b527103f039959a9faee17d9e598f1c6d8be5d2c9e8828cc0d9369c0d1338716b097d28e1ba1d0335dae9c185c252f3d99b1fadd3", "bd39bec5d89b39a65dd6cb873d10a14fdb2c14ba17d224ba61cc4e7f", "ProbablePQ Generate - 2048 - 224 - SHA2-224 - #2")]

        [TestCase("SHA2-256", 1024, 160, 211, "45a6de36c291f126457fa78a786bd80d2f61f85b", "db635be050c751a8abbeca6cd22e3bcd4dfa3b38a8011a03afebc5e35b6db582ab6914965be95fdb93005eda1e522e18fac4b94a70bb9ed4b64724f08c22585595bfc43135c7128634f108b12936263bfca076872879bd042e8499c1478cf24346fdd3abfb8b38abde970b82e6f8a8b1923c1d61bf1ecdc7fcfa75303c843c3b", "d1c29fcc0148b0405255eb4c8fb527f658d20de1", "ProbablePQ Generate - 1024 - 160 - SHA2-256 - #1")]
        [TestCase("SHA2-256", 1024, 160, 86, "4da9cb15c2e24111b2b419bdd0b5c46e90db7d9c", "de1e0466fb8113ea9cf3845556816813a14d19ef18fa174f6f9167e6b3ad6121725bf17f41b6d002554e2cd80e79cf01989f046aaee80e5e830095d24d426a01c919b75f8937f67bb01f46b44738ffb7fcb08abc790458a6cffaada3fb0fd191bb8a93c907595a89fd971f9d552fc4419b65427bf61ba31796f4ef5c2e0eda49", "c73f2fb7901a3d3ecefa7c318feb5b741872fa63", "ProbablePQ Generate - 1024 - 160 - SHA2-256 - #2")]
        [TestCase("SHA2-256", 2048, 224, 2319, "a3455f8dff7c7c4235b6182064bd70f176cc99f604d2efdfc1f92b5c", "d77bc268ecbf739ec83eb6db480df5ae8b2c1e1e18ffb1e39aedf6baec24cc55ae2baa0185b92d1db150404f236f753e8608e681c1922ba3a50a5600d4165fca9cf9de8fafc38c9508e6fa934ced9552ed482a4453dc7cd5e926b20cc45e754085504ae7e01390bd1710c1d2b061c53546c81e51971a2a68867c21667a6672fab06c95e39c0f46323c48216b6f1b463ced265ef526c582151fc1cd03f6b008c8f8840f8b4508ffbf5768023d33766d687ed485cc49d1fc3dac601558781efc1a5d107ccf66d0331a60f2438e16bb132b5593c234d73f4618182352863bbf9e0b15f39cb2ac3ed279ad0f55eeaa7540d3abac3c6d6a23e06dada6a112e3d9d925", "dac11b8c66d1f25e325f11a33858ae89bef2a120a78767550c975613", "ProbablePQ Generate - 2048 - 224 - SHA2-256 - #1")]
        [TestCase("SHA2-256", 2048, 256, 483, "927565cccf370a427d3254eb7ffd06879d6e09ff6d66b1dd9b3d8c60e8f41a5b", "d3daede9b97ac9b74531ce77cf6798e42a10fddce4bae11e05c212105e7df16bcd622577fb9b32b4b8890517f26784dbd0bc3195761d5656571d74059a521a2de062707f32c527258650cd8517415c5a00c17fcab03cbfad148a819c78af29a6b8130ef7748fe95e38a85f383afea6622b27b4e00bdc4b8fdeb142ea43d4034aa93d46b9baee9c69499a0f8ec6f3379bbdb71e65b1012e4dcb5e41ac3bc5ca1cbea3727e2cfba7726f5bd2cef8e818bc7f51227e9eb7154ad8cb12964098a33ce58a57376c13b5a789de06807e7e34f1d1d939f4f6f6e006853250bb9728b66bb13af22d7b97442fcb2110ffd51ec84163e3a6d18794144c3ccdbde2c304bf25", "bebfa0b71138fadebd19fc5c8bcf3f130b8252d76d105e9e2f1eb3ef986427e1", "ProbablePQ Generate - 2048 - 256 - SHA2-256 - #1")]
        [TestCase("SHA2-256", 3072, 256, 638, "cb609ef8b138809ffa0c1d82fec0f422d04092db1f9510c8101d978978dd0a7e", "e9a7b33d75e64dcea79702f9d63b9e283f4b2c7c56dcf2c1af3d780f2af55421aefe05938949d9761d2b84c82581d5a46e9b5ca9d3fc50a6e079bb4418c30d61b9b0107209fdc1201b638fb1c745d2ccf36ba51060435acd8d2595757cd58018c5aa13573c97b4805414c7b0a63be156a9738e953389ee7d0a9986c78f636d4921207c7f5b3a1c7cf449627231fe087a0e7006218f7cc8dc2e0ed4b16c57c4e574ea044a18fa9c831092e3554516fdee0817f6393428f1775e5325f6e81765bd075349b0cdaf98f2a88eaefc7efc4a93f1fe325c77b65ed9d377086d5ac272c85a7eeb9b48a56a220475ada07d5cf14498351986f751a880f36881f0992e7bc938e83dfabca9ce50e60ac58c7db0f20b0b4cf3080c46ad74801749030b78860b84ea25c687b0daeb12b5aaf057ea18590987ecd5a7dd53aa79667f05f7afcf59ffb108839316bb2af6bda9f2736d98e99078e953e154f35a9dca7171721c620feceb3e0a04f4e2764ad77d5c80d2e6e86c0b15da4970078262de24428d1f1495", "f30efdcdbc1b83fb1762f40e5b6ace13acaf8e711a68d1018d91f8fc1ae0b89d", "ProbablePQ Generate - 3072 - 256 - SHA2-256 - #1")]

        [TestCase("SHA2-384", 1024, 160, 248, "263d9c57e738cbd6da43d7397762b41ca7654173", "992d80e12787b70e74969866a7953ed034a61d4c4ec3824694efeb17b5f482085720a5e47bdea4a539f2968931ff4e911364160b20bd6b132e8e7e78792501494c44139392fa80bd3ee5020f2e6a73ff305c6a7571cd9be125be50384071434af27964a654d76419943405ae24a2e9394eb1a658a5c4039c6efe5022558b4481", "ae480f4b62a824455771c201c8b3493523acca65", "ProbablePQ Generate - 1024 - 160 - SHA2-384 - #1")]
        [TestCase("SHA2-384", 1024, 160, 429, "9b6c5cdb9c817b0bbf8200ba7f166246177da37b", "fe97701f97a7c6093b4b46af2dfa13413ec19a184c06b884fa5646ad1b0c59265117094b91055340641fc7c3a1a6310d43ab9d3cb87eec470fa5babcb162a7236c630dfe980b3a98d844ad73808cf91f72baed4e924e7b9e16b8aa82752431d3bfe82175458a750a0a23cf08a11aa6326e7562cca01c87d492bf43b528721bb1", "9565545819d431560ee049de17e893e2e34dc3a9", "ProbablePQ Generate - 1024 - 160 - SHA2-384 - #2")]
        [TestCase("SHA2-384", 2048, 224, 596, "f0a81c4eb942c9ded7d2ad36c77f1cb4e5265684789e5756c9ff316e", "b9031813f14763b80310ae46f1633a67770c773d280fc2431ced1a7d6a6a07215a6ae75375ecbfa7a4e71b92f5382a40189ca25c8898fd53ed155785cbaf3779cd920b6e2f4711a301d06d7e7289d3eee381b8086645e90b564f4929093b741ad721356a6a0c0d499cc78f878c3d800c7302e61547d8aaf0d5a8daa64d80df3546bc3c79cbffd9a6df937fdcd0c6f095d316ef3b2c59bd7fa2e68941cf970ce875f2f76e723e1c7876de05da4623ecbb6ef8bf915f74f960429d9a5041045ea9b00a98aa91c0a206ee52c0810024c33f03a758972de82c7d3af35b618693fab7a11323e7da3f0028d53978f7f4459003393b2ccc080459e50d043d8e47f6c257", "bc9fdcec353446f0a4493b293d88d9f3d59dd3db135644d0dbe245db", "ProbablePQ Generate - 2048 - 224 - SHA2-384 - #1")]
        [TestCase("SHA2-384", 2048, 256, 1018, "0d1f0850e7239f94fe02812341f55b464e4a458b0e9b79326dce4781bade90c9", "c50bfc3e18d143a3c2eba605ce1c9f4c5a3d6fcf23f4f39fe7bda36f4a902835272b641f107a40273699c5cf06eb5365312d544364a8541e436ac3829fc9b321bbfbc5182777c8338fac49dd18238ca4b7fa4ea7cc32b629be6e750528de8470448223f258ae6faa491d652e32b8b7eb4e7ac86e4b790d3c7df3eb3a7fd3335e73c968619cf4c2fc3c0d5294609ed6870f82325934de05a6a382a62218e9f239e83472f2ef90ae13d69781c2e78cd030d0b75396cc464197a02da3de3318f6f53b9963463089426be4649eb393a00a23f6b0ee027683380a147de03173a3837839e0d54d457de74b8f6d007b18aa1d4859c007b8f612e91c229e02fc7a1c0905", "9e7640d15615875ca08d45420b40537d99e43d7b6a4ee66c1846a2fddd98b2f9", "ProbablePQ Generate - 2048 - 256 - SHA2-384 - #1")]
        [TestCase("SHA2-384", 3072, 256, 1301, "b36e1ca2c8636a54e898982d6e824f9e615d1ea61eb671e94292b3b2d5e6349e", "85a3bcf1dfcc0f8ed00bfa64164c9a1fef360cd5f9792da7aa4bbce4c4d0f6059640196283aae17ef73d5cc05fd13b37c94cb127e8611886d1ef6471df356ae2584437c0010ec07a3ab79fd67c4c587703fb52205342304f69fc5e81ca468ba0cdb8d100859da20e46151b500e319c28e6e1b8fe260f9b17aae967de1de71663e1daff01d7d72f65d395c4db84b4581168d015cc6c2bf60cdce00ca3323604c5d76216720fae9c5460260348af3e2e472e68a2283bccd0a9ccf275083551b8030bab6446d12974ab927bcf47e0bf1298c35e0e72ca23791af75e959b8e9419a9ced4ce88056e1a80de99a6c3fadbbfb61189eecc627505c72b1358d7a80fac7456304815386f56c6f033de37b784f149e3d65c463b5eb94e7982a00fedd2669a1300198809127c4d8b704e4249d0c73f5bce2c995c1893111a03816b2e2002b1250e6c0b396c6c1bc46aa1bc3423dcdcb4d3641830ec61a6fffe8d42b7bdea7deb88d2ffc2885e48f8120e8a65c30d583751cf822d50d3029b7ae24e1c3faa7f", "d4cfed6fcec9d783a7c7701b7a1496ac0d0ad763f3f068c746d2f9686e57771b", "ProbablePQ Generate - 3072 - 256 - SHA2-384 - #1")]

        [TestCase("SHA2-512", 1024, 160, 151, "2711691fc693a79b0f3d8075c1a147c1e65003d1", "d3507d973045546a98822275988692b1331c371b40ea90f14e090e2254c394858eb5ab13d96adb5b9957a4da0ee1c864ce51968f11b46a3e3b27e49958860704066e7c7c1ecc0bd3fd2ca6352c72c18403639e4d7993d96eed8a9329bff4dc3e0896e512982b12ff5fc509decb830f33feb2d88dd346d13f53c21e496056ad1d", "884ca0ca3fc864f84e70351b688a2b7eb3d864f1", "ProbablePQ Generate - 1024 - 160 - SHA2-512 - #1")]
        [TestCase("SHA2-512", 1024, 160, 194, "25adbe80544969ac866a34c5f7d4d999f80033e8", "856f57d5df7c827eeb5eed51c748a37434a47c4ce08f7911e27b235bb275fea4ace536729199cbc42827c14d93573eddeef7ae16ded49328c26dfa7e34096deb58cfda922acd08a90da3815789219c39ea8ea6491b991fc2bf141ed9953bca5d3ebe0b5320c7f9e5d804b06ba987e2809ef4afffae37f38bf8a4c08f737612c7", "fb75e02bedf896a00a2fd7d9f0af397c92a4ba39", "ProbablePQ Generate - 1024 - 160 - SHA2-512 - #2")]
        [TestCase("SHA2-512", 2048, 224, 42, "f186bfbac25495bcbfe584cc5eb6b97d178630ef1e07da5a66631815", "be3455ec537e13b6945f0d61dc9a3d689ef37f4e14525e761e1a7859bda7278d165f4bfbf6e3824b370a1ce9665921d5c1f29f1cddbe3e62832914d655f3425de23745578ba8a7ff36b2d18d720631374b493a9816a1efc22b1a5ee71b02c06bfd1e65aede7b1814bf128db070cc68fffe2c51ca49d57e57920d9c4ca4bce6aed5632cdbc3fb0e9e44731302a14cf99239bca518d011d8ef0fb3bc638d3ccf2dd10cb98fd530f1488bdf7d6c54163fde2752f3e90bbf9a4bd83e9b01acf88ea2970ba31d6421601c433c7f9a64eb03e2316ddad3b9317260decceaabad5dc6413ae57be9da45f08da3a5dfd030145eedf105ef9ba114c2a57ab0c504ebb555d1", "eee92d39f521963f558ef5387b71cfb91881a479b51672caacb97273", "ProbablePQ Generate - 2048 - 224 - SHA2-512 - #1")]
        [TestCase("SHA2-512", 2048, 256, 38, "0eb5863646b17a970426429f2639e5ee90b4b5713644db05f84c09b228f22fd5", "eae2bdae5e6644ff25fa5fba6ba4917e24eb005a2848faa09356cd7761e274829b7ca50e7fb520dc227c8e054ddf5c34d8827b7e99b23712f23233f6c5841c20a13d828fb241d84fe883aaca3fa0178f07e56a4d6e82bc3d8a84558126e1dc753ecfb7d3a605262d7aeb1c8252653f2402987cd05a48f97217b3ece1fc9d74ad051a842921f976b17f0dfcc3d6a59176c278a93358f3f2653d9f20c8cf28215ddd871783bf77e8cf04a9de7b10df96bdcd9487074a307510174fa20226f7bc02b4d2f3edea9d89ac3e4cd5daf5666bd8b249d87901eb86ee09ab7c703f948d2262762b4b56b5acffbaea26d65f2f2742ff3dbceebd2c68f769ccf2c79fb46725", "de35826dcbe1af62943bcd170b013d0820db0ac98f3516f0192c06cebba86eb5", "ProbablePQ Generate - 2048 - 256 - SHA2-512 - #1")]
        [TestCase("SHA2-512", 3072, 256, 98, "6d3d16fca80b15b654d3a3ca0e1b6a38225d5a04dd1328f48bd62e3c1631261a", "875e37dfb357f5a0f9f6bbaeb3e25f407c08f9ace9eab575077defe7effc88110b514ad3fa41b78891b963f580df10a24e744e27504ce2153013d92efc8249470d669386e828990572a38a541be2505a0813b049a6ae2edf8332a07443b3118acb97cf1ad9486c1b536e5ad9aa5a164062cc012044d74c164fb2ccc3f327a1956df5b8f6e231d25d39d0cfa4ca3d96abba8e581c76b6a14da562a89ce70e65ca885633bb2b2c28519629c5ebd580d6c91ea51f16213730aafc3057f22e6b5b5adf2910e86cedf686c1b4ca26cd3cd692f149cd0876a8ada6e26bf9ae7c58974b56e7c55dab7c4b90eecc935d9a7e8f214f474d4d3e5a5a92b16df28729db29a05f56fee6f3f7d5b894afedd5f1cb9de9b6a962fcae05e101c7dd256d804e33de1783f80452ffc575d9d4c8c011087327663446d7c11a0fb6e4df793622b599166e96ad753d13809b982c0984de7cc72162282c19a097bd364100152f5ea208d67c23feaf3709b2ff46de520891a42650ea0a34694b58c978fd64386eb23254cf", "f42e1a1395854018741a8c4387c21453fa70cd82c01c14e172af00d1a22b85af", "ProbablePQ Generate - 3072 - 256 - SHA2-512 - #1")]

        [TestCase("SHA2-512/224", 1024, 160, 1, "432287b2605d4e3ab9f9af0fc9902f1995591057", "b1973c0e0a32fd8a450c607ef887303d65f5adf9e97d01462692c984a3a0c4e077fa210301aa60f323b48e57cdf9c664281fb293e632fdb354874b4bd27790af6b8895b89299ef2f9d923ec8b91eb0835f32789558df08de464ce7cb1d079dbe7dd2f80a9271eaa6b7dbe8710aa003f73f10911da8d2d7be953dbae03cb5a94f", "e009ad785b8fc73d24e7bcc1e91181cccaf73065", "ProbablePQ Generate - 1024 - 160 - SHA2-512/224 - #1")]
        [TestCase("SHA2-512/224", 1024, 160, 54, "e280a88057ce7d2eaa969028a22bc806d75af1af", "d08a927d68db703af30f670ce6b86b1c06a38a1e128b316f185db6aa24ba9a931abc245c4ee6c1b85421930833bece952780eaef09245a1187e9715ca7c88144eaf3315eb4bed8e819adbe6325a925dc0a545a536346581f21fee936304d0379f2b7e028e843795775ea8d61ab671c537e788a9b5e5077fa5dc58b93a8eb0ed3", "917c3edd03e888be945831d9302905a4c0f3abd9", "ProbablePQ Generate - 1024 - 160 - SHA2-512/224 - #2")]
        [TestCase("SHA2-512/224", 2048, 224, 75, "8378a109a6a2f1dad3fbbd29b8b56a053ecfba264654fc2ebc5a3739", "a08360e2244e21d9865cd6f2d128cbd5b7a0f56b230d60de1274d154f719f02c9a7a1fa7434f314efdd1523fed79a50062fcf73cada497b2c51aa758352fda0b20fa21407d41ac7eaf0884b98353428933b3ebd533d5ca71581964ab085a3515927a6fd586edb9eb5e29b8d6f9c1883e3c358af4dbebc3c2c338f71bd4bd30b536da9081e91ac50a4b65e31b3cdd4844e87da21493c25d80cc3282c4888f95effb4333712965c7ebfecad6f141a783f128844ca179ec307ccf55e4486f8ce0b3524a0cdd148edd879171f801d978f2842061d30b2d47b7dd5b6d8246ec17d6c32aa4914a6bdceb29f1f07f25303ac1912e843255909750a5a2540570a65268e3", "aaa43646daf52c17be5ea91798db89c25ae00d3d959edc98e24b8fb9", "ProbablePQ Generate - 2048 - 224 - SHA2-512/224 - #1")]

        [TestCase("SHA2-512/256", 1024, 160, 59, "9e8867358445403a6fbd3581073b50ae1fcc3ec8", "f0dac689df1cf3e251add8feb507aa6319ed90621d67356d70c4109de9c49600a89c2b53180f835de53ecabe2e093429829a50093a0520fb08f3338aa66961eb37dd5efee0ddb0bb3f45a6038ba925e29eede48b04ce018e41e1c8c6316c8f284abb547ad09e9232a1130631a8168bd93024e06932a626bed0afd03fa7b94a05", "b6f0b5880099d65a09b6b38dece4e4ed4cf824ff", "ProbablePQ Generate - 1024 - 160 - SHA2-512/256 - #1")]
        [TestCase("SHA2-512/256", 1024, 160, 39, "ba894a7b95d4780878185e96021742bda714c22f", "e8267ca27c9e182310a2007acde7e02a8804ae2dd00d841986ab02127357af52fd2d1e2dbc066a2903232437b2eff2d775f424ccde2fa0f2b8af7ed5003ce4d1b511c61f78dfa4f1dc687689e7c621b9605190023247d5f10186dab889699498b8295c4e604d01eef50fa147c1df0c30be8dce107d75a718dd38de374105065b", "a305b7cc77a8d5e462637567eeaaf2424128584b", "ProbablePQ Generate - 1024 - 160 - SHA2-512/256 - #2")]
        [TestCase("SHA2-512/256", 2048, 224, 26, "eff4d5c39ce9932ee43466c5bd955533ce604bc7c98be752cc6d9b9d", "e6e5f5cd50324b1422093c1a958e66448eda35e6314b44fec22fb930c14e4b7cd121003137553dc2756f9e78b3c638c8204890c689f5d3cabafa5ee084bfd0424665e9c11b42d7099527ece3032375556514962c692ba8ec377c7308a9a3e3aeb881080ab90d1331ea9be10a126ff8aa311d8ee1688774d9f6011e53920f1877996d1053fb919edde95fdd41919e196a5140fcc4dd502b6c5272fd4865f9c55b42503701c7eb610899b320fd5e05aa748b66a5d7efd7827068e72fd8b02873ecc10c8ce68974cfbd67604e3a822d6bad73617170cdc8da2752d945b686943596d391e25f65f78d06b648e07894cb31b5f8d28d915b663098720a265e0055a8d7", "e4554cc6b6e68875b71ba32e63a18802c202e2e1e68f873458c9540f", "ProbablePQ Generate - 2048 - 224 - SHA2-512/256 - #1")]
        [TestCase("SHA2-512/256", 2048, 256, 919, "a4e6a4e283be41d9c8ccecb4821fb44f4faeac5ff3c57bb24d5fb0ea766f6d39", "e559e7ea77715150144007157173e9da9fb7e84102e906bd1ce2c26d54ffb39d0b9e062b04c0810460047f6012049fc192ff76094705ae5ca6c00a1bbd0a010c885ca3efe8d0e323d9d7de16c0e9a0e751e0a2b246c98b04cae7726f00cc75cf259b5b0e55e8cb8af8ee82572858203d34e4906445becd5ff0513e4f472fa1280c95f96cde3d779ac9ffb9e8f880f336e2db6e120ae7be8e888dfd82725830220e608fc9fc73b99554189a02aef63192e38bf143e495a31c256d03ecfd59806ada50ee4594241662e5d17b687c8fb5f659a82a07113cbc57f30b45e08c6bbf93e2699fcd90e610f9d7d83e5c1628f62bd88be5a38a436fdb9729a8ec13d9aec7", "af57ff6aef56cf4f1a4e918d0c61515cc84ff7881d1c101481eaf17ce490f5bb", "ProbablePQ Generate - 2048 - 256 - SHA2-512/256 - #1")]
        [TestCase("SHA2-512/256", 3072, 256, 1336, "d16da8a495e72fad8b7965178d188c0bed152e1ed4ede0956a6a1fa9471bb34a", "e9ef3ab2f972da161df44f3f048ae98a770b87cb12e44c589f9b9cd947d6a1ef12b3e0947aa64ebe25e606462af30b86a9b557d0e7009091437c00a612a3b3953f577075b3e6edfc6402247c4171e6f222913493e58fda17f53ce58ca3a572cea9095cc43dd71e8dd6a2223464467464165e3c38749ee347db092fe222efe438b79f2bf71322b2e8519358ddbc3ce5e6c71bba2780e5ab80e84bfa006e8d6aab8da5f04906194cd44c7c1ad525d6436a92784d9bacc74219c447c9de7b9eb28272a910676987c5009f29f0e416667d7ecf7254d90e8dbf30316732136ea5d636409b5c54e0d1cb214bddb1f78d00a808264b84191deeb6c613e3c33b846282b8eb72bd2f2681151c4dbf08bbf26f1cf78afa41d7f055c7e49f8315904c19f92874c573218e910a5e43222d33feb859591628459b94fa6284caef21ee7e58b524ba8211970f0353f15736b2c2dbb3803deb52ddc2249d9c0744017136784c670ceb5da0379479c14aef94b7169b8b91c802d8c7e45e73fff54cd8ccc9c5fc7715", "80cf798039dd6998a28a885351e4781b98d60ea07375bfc9a62062fcecc8f425", "ProbablePQ Generate - 3072 - 256 - SHA2-512/256 - #1")]
        #endregion Generate Tests
        public void ShouldGeneratePQProperly(string hash, int L, int N, int counter, string seedHex, string pHex, string qHex, string testName)
        {
            var sha = GetSha(hash);
            var seed = new BitString(seedHex);
            var seedLen = seed.BitLength;
            var p = new BitString(pHex).ToPositiveBigInteger();
            var q = new BitString(qHex).ToPositiveBigInteger();

            var fakeSha = new FakeSha(sha);

            var subject = new ProbablePQGeneratorValidator(fakeSha, EntropyProviderTypes.Testable);
            subject.AddEntropy(seed);

            var result = subject.Generate(L, N, seedLen);

            Assert.That(result.Success, Is.True, result.ErrorMessage);
            Assert.That(result.P, Is.EqualTo(p), "p");
            Assert.That(result.Q, Is.EqualTo(q), "q");
            Assert.That(result.Count.Count, Is.EqualTo(counter), "count");

            Console.Write($"Hash functions run: {fakeSha.Count}");
        }

        [Test]
        #region Verify Tests
        [TestCase("SHA-1", 372,
            "f1276cbd3a5fc31bd60b98f6258b9f9134dfa2c67bf982d7a33949384dc088d77ff11787f92c8d7f1ee505434ad2f1c44a7abda95b197e3d42a00de62959e093eab6ef0bc7ae9443fb3dfb40943da4c6d9f1cca1da8aa7fbba72d5ee436f56bb1dea6d445a066a6b346f0ccb767368535327091f6a2df03474af298d00a73767",
            "a821e6e9808f3062c9970abc492bf3b34a69bc55",
            "e735ffec143c6a19c44c0418ecd7a3654d746bd4",
            true, "ProbablePQ Verify - 1024 - 160 - SHA-1 - #1")]
        [TestCase("SHA-1", 258,
            "9e59345586f6e88daa441ab8b9530df750808e1914d2ab2472587b4e1645043f21d12c4dbfdeadf62215215cec57b2e6f1078e1c5ff7e6fd08d145b4a27eb1d7bf38318d861e4d7283240e36653bff471351024d32a7e41e0c2b526a7e7e835fb22a438f160fc775ada1c5826f1e60c0856a6390621f71f9d51119ee42dfa53b",
            "9ec8478cd1f0bbf802bf4abe60996ad6fdb0c6ab",
            "e0f38d2593f2baf0c40ddd66b89040c46b26865e",
            false, "ProbablePQ Verify - 1024 - 160 - SHA-1 - #2")]
        [TestCase("SHA2-224", 938,
            "bbc096469897ce93ee0b62d46abe37767cd0bcff14eeca3a7d3d4192476dca662c471f0f5cbcc1e58b2b595de9c7eab23ce500a220feaf5ecde0302910607ff44b70022566473de9eae9e9e3adfd1808b91229eaf23817cd763bf5c43473e9b6388f38d0e93e917ac72f80a7e31ce1ea93c94bc395c67c53d9888533a0d91173afd1479d910ecc8be525137291909ee093e568a51c7b9f041c7ef6d3cc6d50e44e7015da5b1ff952d25583c48eb03993193a3f94f9d8648ddf2137cd85b161809a29f2d005d73b0b413e7258b3803417343ccae5d986dd01d9dc751b7bf9ee6047d3d9813c1dfb0e42d6576ef0af4f65ae9eda020c9268227ffdc16e59faaa25",
            "dbbc089715ebf28cf41f4537068555bee4efa78d0de42984abe75d47",
            "34f6d24222109dcb3ab59c2c4c8cd2b54f8a65566259d575c0824284",
            false, "ProbablePQ Verify - 2048 - 224 - SHA2-224 - #1")]
        [TestCase("SHA2-224", 1209,
            "f75857d42213aa471c47c5bec4137d32903d5436fe66fe5bf92ace3db6b0d706ea8a8dbea67ee8da4843486e6a3ae0290210b0c3745fa366ea21d6a0497efe4ebc679045ff27cd70f75b09d92561ced827b185503ee1b4215d0014833916b02ac16bc55c1f82477cb41a2d6b07d8b2c163646760f4c2f678e6cf9ee944526a16e4bc5d4afa8997d2d89c0610a6eab33593dc8dbdb4fe9ce4d5effcbd94b5da6f7ea1b3e89279ea4a93ffc32cdaf29081b134134f894b701363cf44ff28092071d53d2a762a5e289c4be29d08e2c96cede3babbcce986738a740cb7a1b1b263faa5f24f9035f01326f7c34bdc10c2463df446e3fb3c734faf4000e300a8744ce3",
            "b552cb84a63945f33809aad2db217b96325bb81e127b910ae81920e7",
            "78cb902177b7adfdf5bfb6f2c74b6d8fa7ffa5f32299538007d19c7c",
            true, "ProbablePQ Verify - 2048 - 224 - SHA2-224 - #2")]
        [TestCase("SHA2-384", 437,
            "cbcddddd571d7b6de59dc19f1bb8a7f1deb87744aa8b5ebf4dfae497746941be77034b52ac40f6af76c732eafcff69040ed10771af89a91fd8e2a3298a273c1e3ad2fbceece5986885be6e8f31636bea21521788b44183c213aee627166101405a7509e68418a8bd48157f5020efd9d0c8a866cdb48bf6587bd201f8b57a256d5a605cd176658cd42a5ac86f5b0d07966c69e82f615a9beadf030a58075ea9bf71ef91f88e558193af84c8663b19cc7d0e8461e4f9b86111deb135c8216fcb060250c350ea1e96d05c8e8b257dd9811ab6d24fbe246c6faa7dd6162a455dbfc7c002a5307c7cf8cd8d11bfc5f91a41dcf30be37f37a230a2b38de7699fbfb25d8dd09c469ec953f19b40f14ff6038cd5411f367d7469066ccbd1efec8a6d80303fcf0d609ab4bcf14d3763aaf973004e20bc26af642181ef3045b40f01868699f46e4860899d71e1f8c94888314dbadb1e12b9ce7d658b945a14c9fbff1466b447b1dc14ad94c614c1a95e1cfee84359bcf115542adaa9037c555b4bfd189529",
            "94a3ec97ccb053d408e4fed79cb352180364da9e721068204b1d7aba1be73097",
            "dbff028600c384626c970e30e040654cb0165f69d61c0bf2712c2133eb08e283",
            false, "ProbablePQ Verify - 2048 - 256 - SHA2-384 - #1")]
        [TestCase("SHA2-384", 1301,
            "85a3bcf1dfcc0f8ed00bfa64164c9a1fef360cd5f9792da7aa4bbce4c4d0f6059640196283aae17ef73d5cc05fd13b37c94cb127e8611886d1ef6471df356ae2584437c0010ec07a3ab79fd67c4c587703fb52205342304f69fc5e81ca468ba0cdb8d100859da20e46151b500e319c28e6e1b8fe260f9b17aae967de1de71663e1daff01d7d72f65d395c4db84b4581168d015cc6c2bf60cdce00ca3323604c5d76216720fae9c5460260348af3e2e472e68a2283bccd0a9ccf275083551b8030bab6446d12974ab927bcf47e0bf1298c35e0e72ca23791af75e959b8e9419a9ced4ce88056e1a80de99a6c3fadbbfb61189eecc627505c72b1358d7a80fac7456304815386f56c6f033de37b784f149e3d65c463b5eb94e7982a00fedd2669a1300198809127c4d8b704e4249d0c73f5bce2c995c1893111a03816b2e2002b1250e6c0b396c6c1bc46aa1bc3423dcdcb4d3641830ec61a6fffe8d42b7bdea7deb88d2ffc2885e48f8120e8a65c30d583751cf822d50d3029b7ae24e1c3faa7f",
            "d4cfed6fcec9d783a7c7701b7a1496ac0d0ad763f3f068c746d2f9686e57771b",
            "b36e1ca2c8636a54e898982d6e824f9e615d1ea61eb671e94292b3b2d5e6349e",
            true, "ProbablePQ Verify - 2048 - 256 - SHA2-384 - #2")]
        [TestCase("SHA2-512", 3124,
            "d533861ae0e404521a53a8b473eb8f2a68c019f45a8b39bada2fb162e383a99999892a135e5fce4d125a5e9ba0d93bebfbedf5cf9fcb2611f1d5d1957052dd1288a7631c932d3081a77a72f2532ca8dac8294051ca23c1da480f0a7cbf4336d7af77a876b8525f8ba9b8e971a6f24a01b47149485fe0c33960507e33bcd610d25d82039c30f0d1d09772be3261ca1959cbb7ebf1c0a25bd6523f6cc8ec2608426558d22b4b010b2e5768eb6c7060f8f254db3712d4ab3c0049b4436ce9b688926a09479b70d56b1665eee1271b0a413a965c0faa6ee8079353a007d3d35c70260521c37051c8b28391ef5aa78e174613b6398ddfb947ad2efa35dc5f6b591a067194f3df6430697dce42521126113a98f2a32e5cdc0305d590f01e133c0876ea18e1293b40cc47b3f91c197f6463555291bd6f84aa4b7cd803e1a4f0f63e55413bce008f2760535b71a71ca3315d373ab91381dc288dca9421558a986d36223b619e0b6dbba8ceb529d29afb263e26ca739a0f806b6f010f9ef6d9f5095b4b47",
            "9ab6ff88f70f35ed6cac11b7d8d544923f0f2d829e285aaa74ddf8ba27b32d25",
            "29533d87ddc604f8a565820696d1a1a708166829c9139f3a41d4e3be7c954632",
            false, "ProbablePQ Verify - 3072 - 256 - SHA2-512 - #1")]
        [TestCase("SHA2-512", 98,
            "875e37dfb357f5a0f9f6bbaeb3e25f407c08f9ace9eab575077defe7effc88110b514ad3fa41b78891b963f580df10a24e744e27504ce2153013d92efc8249470d669386e828990572a38a541be2505a0813b049a6ae2edf8332a07443b3118acb97cf1ad9486c1b536e5ad9aa5a164062cc012044d74c164fb2ccc3f327a1956df5b8f6e231d25d39d0cfa4ca3d96abba8e581c76b6a14da562a89ce70e65ca885633bb2b2c28519629c5ebd580d6c91ea51f16213730aafc3057f22e6b5b5adf2910e86cedf686c1b4ca26cd3cd692f149cd0876a8ada6e26bf9ae7c58974b56e7c55dab7c4b90eecc935d9a7e8f214f474d4d3e5a5a92b16df28729db29a05f56fee6f3f7d5b894afedd5f1cb9de9b6a962fcae05e101c7dd256d804e33de1783f80452ffc575d9d4c8c011087327663446d7c11a0fb6e4df793622b599166e96ad753d13809b982c0984de7cc72162282c19a097bd364100152f5ea208d67c23feaf3709b2ff46de520891a42650ea0a34694b58c978fd64386eb23254cf",
            "f42e1a1395854018741a8c4387c21453fa70cd82c01c14e172af00d1a22b85af",
            "6d3d16fca80b15b654d3a3ca0e1b6a38225d5a04dd1328f48bd62e3c1631261a",
            true, "ProbablePQ Verify - 3072 - 256 - SHA2-512 - #2")]
        [TestCase("SHA2-224", 376,
            "c24c3e2bbf03cdbe2a3d56703f9286458d2ff38a46ab138917fa3afc926bd818f296a1ad6e473ad1ba302dff03042f25acb792bcf2edd6af5aee0f8dab8f271dd406239a5f8eec1b7aa72c8aa58d67288f0240e592cb1ebd4dc5fb5e927c39c01db232252acf2a23b3ceb982c3e08091e1f2b88510d70c7b039c2cc332f70ca2d4586793db9a30fe0751e056c154823764d697a274dab2ce7221d7aee89f4f8caf3ee8cd3f07c4f29fd2d0b1324e6684579a7f58d3ac0f51d3cdaf3281e0c56dcdf111887256e9a549fce7053af64f6403bdfe84c9a535ca8048d5a2166a1cb13d8c8efc2b0896f4c6e2230124b9b9d651625fbe2809ced354564428df51b3f3",
            "f52ee0d146394408910a4facfc29d2eeb0506eac848c5e1e992ed309",
            "0071a09cf731e31920d0dd62c7a337f3ddfe4cdb41358a16d8916721",
            true, "ProbablePQ Verify - 2048 - 224 - SHA2-224 - Leading zeroes in seed")]
        #endregion Verify Tests
        public void ShouldVerifyPQProperly(string hash, int counter, string pHex, string qHex, string seedHex, bool success, string testName)
        {
            var sha = GetSha(hash);
            var firstSeed = new BitString(seedHex).ToPositiveBigInteger();
            var p = new BitString(pHex).ToPositiveBigInteger();
            var q = new BitString(qHex).ToPositiveBigInteger();

            var seed = new DomainSeed(firstSeed);
            var count = new Counter(counter);

            var subject = new ProbablePQGeneratorValidator(sha);

            var result = subject.Validate(p, q, seed, count);
            Assert.That(result.Success, Is.EqualTo(success), result.ErrorMessage);
        }

        private ISha GetSha(string hash)
        {
            var mapping = AlgorithmSpecificationToDomainMapping.GetMappingFromAlgorithm(hash);
            return _shaFactory.GetShaInstance(new HashFunction(mapping.shaMode, mapping.shaDigestSize));
        }
    }
}
