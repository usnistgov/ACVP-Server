using System;
using System.IO;
using NIST.CVP.ACVTS.Libraries.Generation.KAS.v1_0.ECC.Parsers;
using NIST.CVP.ACVTS.Tests.Core;
using NIST.CVP.ACVTS.Tests.Core.TestCategoryAttributes;
using NUnit.Framework;

namespace NIST.CVP.ACVTS.Libraries.Generation.Tests.KAS.ECC.Parsers
{
    [TestFixture, UnitTest]
    public class LegacyResponseFileParserTests
    {

        private string _unitTestPath;
        private LegacyResponseFileParser _subject;

        #region zz file
        private const string _testFileContentsZzOnly =
@"
[EB]

[Curve selected:  B-233]
[SHA(s) supported (Used for hashing Z):  SHA512]

#  Generated on Sat Aug 12 11:31:28 2017



[EB - SHA512]


COUNT = 0
deCAVS = 00000080360eaea873fb66a2341845ce310f0b8b144deb1cb5e938520aedae52
QeCAVSx = 000000dfe9cd18b4613008e13a086e7a69b3752916829a32e06aa246cf91aa79
QeCAVSy = 000001c68825ce9f2355eaa86f7bc58235988c0d7ff5441acdf0eca1ee2494a9
deIUT = 000000c2ca50d96624bd2e6857c98a0d14206a4402ecb21cda2135c48c652844
QeIUTx = 000000483b5e148ac734963d7aac2194c6e96294d83289ba77ef1edb45c0debd
QeIUTy = 0000014e8ca9033f04c5b102f37d4b253874a8bd54260fd35b61a32a800c9d79
Z = 005d1321a08c24af3bb28b7a9e98873fa00593d4b9b2200155af5e97765e
CAVSHashZZ = 694eabfc6465a165e20ca9dc9b605de69ed28f4582e18d785c6136ad2b61636907d4c724d66541d540fc23008f94e3c18917105d848cdd1ed3f5708ab26dd1cf
Result = P (13 - Z value should have leading 0 nibble )



COUNT = 1
deCAVS = 0000007a7b27b43cdecd6427f9e9e74034e10ea3012e2b470ce56cbc6409a3d1
QeCAVSx = 0000008113e7eac50a62138716fc932c3b166c21245b70629dcbe715a3127325
QeCAVSy = 0000000d5f025cb3956acfbae0e9aedb85a7f8cd3c7c0f7bf69fe8eb19c74fed
deIUT = 00000015f3e891947736b897cd479af278e6a8dba587a4890351c077fd29f0ac
QeIUTx = 00000091b9014d6cdc60a302cd1213afc13a54865b4a8ddece015840763e3c32
QeIUTy = 0000012f1ed54a6078ccc0174f07da5afa98ca1e003ee266897fb384b3846015
Z = 00afed9b63e0604c42b3aedd6ab8e38dff65d967a1005d181706860f055e
CAVSHashZZ = 882c8e1e0a8d02b89d3fcb0dfe1356aab80b018b35b2b006c57013f318610b6f85baf4ebe7ca4f2c7f3fd7427317bb33f8a208567b36ebaa300cf29862b05517
Result = P (0 - Correct)



COUNT = 2
deCAVS = 000000c578c4df6e3c6c434787a4d79beb7cc02c583bde8ba40d7674e26d8589
QeCAVSx = 0000001f5b4dc1af43ab4f8db3a6982016f2acb026736d658f5d9dbdb1e32cee
QeCAVSy = 000000ca1e5b573ce4dd078e7d1641f40629bc85eebc1b3f6fd7f1c96402f52f
deIUT = 000000fe4fdb00ae1bbae4bd60cae102c207223f9694cfd807b13b7621e0f39f
QeIUTx = 000001220e4e7c6ba7ac569396272ada30ffd404f570d877843f7b8e70139b30
QeIUTy = 0000007d79bf50be19d058448e514ac6e75d492a9eaa9b125a3db32775f32977
Z = 00d9f2c37875ea63b30e641a483e16564efe65ca6e3b04cb4769801232af
CAVSHashZZ = 5c93203f7d443588110f9e54f3978f514d85bec597100671efa21fd75c80b3d024acc9d21ff856c998a3e2f44f1517affc27f5843118ea84b217cea056f5c7fe
Result = P (0 - Correct)



COUNT = 3
deCAVS = 000000ad3825d72fae63b5d6b451ddfa97d609e88a2f2d452441fc015a98a5b3
QeCAVSx = 0000001a7ec3fd6d1f95e53bb386cdb4c7b69ed33227a6c85ca9d9b49733dc30
QeCAVSy = 00000168905bb9a88e8ede75c292937634b3652858c16332104068bf7295bac1
deIUT = 000000f763174386c505bdffc3dd0efba8dd7cf9a974517bb6c2b750e3bdeeec
QeIUTx = 000000e77dd6bf6c8ce64a36567b512f1e8bce2c1dc0b3bfb073882f0c5d3ae9
QeIUTy = 000001395d0a709cd9ff407850a248a628fca6671abb29bfc97fd0ffc33f8187
Z = 02c8a30d28d914e47c7202fdc7760071b9adfde26ea18fbf07415b9d3391
CAVSHashZZ = 9ef9482543501e317aaa26e15efca74f4deed6eaa98636ebb7c12742381483b63f6889fc7ffe90506be4610c9d71289a8aa94fd1eca92dc8c549c12947823415
Result = F (8 - Z changed )



COUNT = 4
deCAVS = 0000008c8d055831e45ade645bd93e8ca9ab20284f8f1fba6dcb3f824911b4f9
QeCAVSx = 0000010251ad7c3cab0a06ccefcea72adaad7106840ea86ffab44f0e61632ac0
QeCAVSy = 000001f74ae89ec053301efd4f43aea5dea2d119aa0ca1f9219f5518c06fa8be
deIUT = 000000179cba9c8ff812ed3ea9f8f036fbbb147d9a4cad2253fc0d64e504dde6
QeIUTx = 00000112a972683ad4fd85bb8e6875da641b973378526b214432d3f2b970478a
QeIUTy = 0000018e8aa14c8afaf130ece4c21c3ca25f282284f69e5b038df876b9a6513f
Z = 007cd6af70a586bc1e5c49394e13152d0994e0940386804a5b4ae287463b
CAVSHashZZ = 28966839f3abde51e6740fceff570561e35ff0448566d2fe2bb7e22fdaffbc561f996d246ae384c357de023e3df91568a571794508b9ad3de9a2211b43cfbc5c
Result = P (0 - Correct)



COUNT = 5
deCAVS = 0000006e8c0cc1d83edfbb2804ffbe97817cb43d4d91525db555df6a0f0b923e
QeCAVSx = 00000147f2f4ba4a9b30ecbccabdd8b553f1ea4b9f415e7730f3a10a1cab8db4
QeCAVSy = 000001557d17c41e9e2a2470f1ced3a35764d8f05b48b18899d0a405b8b8eccc
deIUT = 000000a5cbcb019caa30062264d83ca6cb54ce387cf68a38d7b78bb04c3831ab
QeIUTx = 0000010cc4c287311f2839570e509a23b37779e025bf9f02dcdb959c8ffadffd
QeIUTy = 0000006082b813472c59ef5bea349bed3b5b3e8a2801ccbfa538909da207eeb9
Z = 008653828414aeabb7243225c0e4474d3ef6adc840a0c43b1dd266733935
CAVSHashZZ = bbafe29d4853f979c803eb48259c0841b914f48b05746ceacfac121f0725ba53421381eb231d2bef96571e614f59cdfa9a1f0619bbfd74aaadc7213e7b6c5a64
Result = P (0 - Correct)



COUNT = 6
deCAVS = 000000978c13c2991a0c3576c9e8af0e73324e02f847727dfcce97c6c61fc274
QeCAVSx = 0000017e9a0271afa50d4a5cc83b1624a6a18a5d649d97041c058d5e6518f402
QeCAVSy = 000002ce55c0bd03b6714af70510499a40c58b740f56b595b2eb4cb75f39b504
deIUT = 00000094a4d58d45690c8fb9bacd787c93d2737d4448f29f9637b0fc214010be
QeIUTx = 000000100da016b4540b2738fd29a6cf497360685f191e9105a5c298238efeb0
QeIUTy = 0000014a58894bcf72bbbfca89d41265b63517e6c4eddbb68cacd56eac8f7b14
Z = 01266411d547b7463322a0856d83e9e77feeb4c345e17ead4c9e9fffa4a8
CAVSHashZZ = a2327867fc84f58b93695f4113a790c0cbf7035d28cd63d54fcbeeded6c3ce69da45a6140f6afff3bd4dec8c8982f09d0bf886b12dca9ff980330eecc37e0c4b
Result = F (4 - CAVS's Ephemeral public key Y fails PKV 5.6.2.5)



COUNT = 7
deCAVS = 00000057a6a35adc8fbf6855c630190a637cd1313080bd7e3b1623f4e50510ed
QeCAVSx = 000001c6b4bb36f2243ec4b37fe003e2801e3ea9b373e20cd5cfb39579f060f1
QeCAVSy = 000000bfccf60aac12b59f9a4645105871930071c91f737970ddb58cb8da38b9
deIUT = 000000c82cf0dcd8be12716ce3a19f53bb8070528a5287673ca66d7ee66dbf5f
QeIUTx = 000000418b7791c897a8b14253e4695897d40accbab8c81331734a0cd845b773
QeIUTy = 000001678b20293f6c194110a67a8dded8d4f1eac663c55672f76c6eae86bc4c
Z = 0003203c24bcefa6a0989b52e533976d892c24e11dffa237fe7c4fdd8fb2
CAVSHashZZ = 08a59259ab694ba3fcfb0d5032033a9e7f8ee73b04904261547bf6f3c61f0593f7a163098dacc013987f3d0a62adcffab970d111c16d955b6c37ea0b06d933fd
Result = P (0 - Correct)



COUNT = 8
deCAVS = 000000405ac8ae0b830651dbbc3ade7633f32d5872c39bfc99815e9716be886d
QeCAVSx = 000000a73caefb8dd977012c85d105497db91e6aafb92dd8ffbe219ea0f2648e
QeCAVSy = 000001b08e1287b34ca1f9b1607e31e2ca0f54ff17b1a2bbb8682a89846de841
deIUT = 000000dd28831b1d82655ce7af0e6908ed68a029ffa9453774053ca9de942723
QeIUTx = 0000016060bd6843ecf9f8d77fd211eef931fbcbf27550547816b179d90ef6db
QeIUTy = 000000f5519b7eca9c623d441a44a9d72aece66528b23ecb196e06bb0de218b7
Z = 008c550ef1c4643ca6f20940a417f6647587d963d94001a3faa2284d7fcd
CAVSHashZZ = e487509352c9ebc0fe435243b20ab8ecaa0e24aef4b8e922a8640851c73844952107cd5141ebc73e10dc0acc0fff374570ba18ddf6487cd12d48543e31f381e4
Result = P (0 - Correct)



COUNT = 9
deCAVS = 000000c63dabd6635471ad68c0e3b9e29d785eb6f61e5bbd3e2b3219c674376b
QeCAVSx = 000001b15b4c52e5539e79752b3bb0247a65c003281beae9594b1c8d3f056f9b
QeCAVSy = 0000006f1f5666d45fb6342910c52825b569e0c799cd7e3233c9278cd13dc97f
deIUT = 0000001162151d412e3475bb55da08bbf0530c6451c8a11a0948a575579b9c92
QeIUTx = 000001fb0535c9b9653b857558d00f5cd8028c06434413258cb9d724bac07f8f
QeIUTy = 0000005a826168367a2acecac1776c06717335d81c87c6564d41375b4e39e791
Z = 00de1895c0dfc2e81d3d83a5e23774fa84853cb4c2b804edf7358a8fe602
CAVSHashZZ = e3cac39f8b6996917d573d5b440d16f2ee2d4b31797d35a04cb806bee26bb213dd6a99a0b9525bd9aa261d36f250be1fb265eeb44032a620952d9646224e198a
Result = P (0 - Correct)



COUNT = 10
deCAVS = 000000868cb1294d8aa6d064b091a8487eedb48c122a9e5252c96aaa97fb9fea
QeCAVSx = 0000009881debdfa054d35afa12c41d9e316a712395fb561ed43a234798cf504
QeCAVSy = 000000e8c4c2d3d57eab1e0ce51da807153d0c97bef289e567c0cc0c1dc979dc
deIUT = 0000008292ca811f33320f32395d1b6944598b7335b6aa814e7e801dbb5d7bec
QeIUTx = 00000140525633124c5ec953500a7ad11212db47f1c30db9824a14383c9bf6bd
QeIUTy = 0000007bc11775b712dd57094b46624f9efd42e207f5021e11e305b0708c7da0
Z = 0026f7e613ccef066ee6504f1c3b6fc3ef3198094fec3ed0638e2e881999
CAVSHashZZ = f517cace7be6d96e50aa85e82b8f3965be82c402b09a24fbea63bab16a88ee66cbc214bbafe14ae30306d90f8e79f860ca92b1c985dc5f78adaa61951f6ac8d3
Result = P (0 - Correct)



COUNT = 11
deCAVS = 000000d1432c3fcdbe326ece109f1061d60a61e3bb64e3c8910303b4cce79384
QeCAVSx = 00000140555ca951d6e636adca67e6449f5b89bc4a5b6b14c5465a23ecda5358
QeCAVSy = 000000fe33ede63e0484ab963b6d140a6c000a2673d45c9fdb7c2f3fb19b5aa4
deIUT = 00000020eeb3289078acf4054e9f1f1af5b81a486c06bf844e051e712be9ce5a
QeIUTx = 00000025e01edcbd04d965a066fd2d1544666d42e3ca8108e1441a8bfcb49373
QeIUTy = 000001c4eb321d3862adc2f2c6668bf1866fff018fe9f0e349559abe951baa8c
Z = 005c11478d24843d0096bc1c07d99b540fcfd772b5b40b039609975389a2
CAVSHashZZ = 00d46412d0e96fe521bec79d633edd9b813dd1a144397a2bb3051ed4cbafde13e8514b2a13bfb8659ecd7909e8dcb11f03c2fc015b9da1aeb285bd1992d1bfdf
Result = P (0 - Correct)



COUNT = 12
deCAVS = 0000009d78a76fc496e8a4a56979ba65b0b01336074749404fcbf62efcfa3242
QeCAVSx = 000003c1bf516f605d58ccfc3860e16768d72c603c8dd15cc285d580c07502c1
QeCAVSy = 000000301f35b3a2ed55ddd3b41e2c337ba79eee545d1c258a6f9cc7b7995fbd
deIUT = 000000a4bc92a6f713772022e77ae8cd5c9ca85f2974a1d8f1651d18344acd8d
QeIUTx = 0000016cd2256fff8c953252bc4807e2f71d9362ddb3815310c52f39f7247d7a
QeIUTy = 000000632d880697dba484291e5349e546ec5d88a99007dea0f7a8afc35ac0cc
Z = 01f733dac919890c9838782262ddfb796992444bcc3e9fe9e93d674b0027
CAVSHashZZ = b66f1717fc170b2539e86d623ea1d54b05e1196c725a154c52c8cdf2063b764ffebe3c57ad6cd55a4a6d7483dffd49aeb0e9a7f56f523db8a7d8da150200d45d
Result = F (3 - CAVS's Ephemeral public key X fails PKV 5.6.2.5)



COUNT = 13
deCAVS = 0000007e8a65c75dca1e460417845a9238243d8d4f78737562c16b8b3cb87f71
QeCAVSx = 000001275a8cc04d8eabc433270bf03547ab6708d925287baaf6e220b44136eb
QeCAVSy = 0000017f55a6ccb828c68d6d7b47f898ead5cd195b44f388169a20f6f74f1a33
deIUT = 000000df0a8fe816b506f79b5a937fe35362d18bfc1edbc2676edf421ffe42e2
QeIUTx = 000000f27f7070ba605821f4c2bf59473270cb56714ead4a067416d93ae8692c
QeIUTy = 0000004a51cc38de5309ea2fb613076548580d5bef3a7bec98442b0cb55cbcfd
Z = 00f1adf8c9a599c6927837085114dcb6672e6add3893cdb53d10fc8429e1
CAVSHashZZ = bc839c6469218e449ee6561301959c696190b16b0ae71c7668f7ee3621f6d9166d5bddfe622a5d0b2fe736f49d38a29d9d6f74d80a969d7f1c55a4f633c11e7c
Result = P (0 - Correct)



COUNT = 14
deCAVS = 0000000e3a08484b36c0aab8c37cff93e6467f00a1ebafe6f5a5d5db990b87e7
QeCAVSx = 000001a702ed49fdcf02009fc605fecbbc76bdcb358f150f09167a71a5b6083e
QeCAVSy = 000001ceb2b470bf4df0684250ce4769e813ff7bbaa504e4b83ddc28cbb1b265
deIUT = 0000002d6c33c883cc873eafda42d0a1ebeec8baf624bb7f007d565b45ce2f6e
QeIUTx = 00000057bc6da49ed0a385232af268d53128d8a8490e59ea1e58a06beea83b2d
QeIUTy = 0000005a93ee2db03f0bf5baa2d48d849b213fcf63b67bf344ad341d9385ae7c
Z = 00bab86004fa60d2576b3f95756b847651ee066e301b56003577ea1e2093
CAVSHashZZ = a57b645f82d9862cc2c5120b9e88f1a90e90af6a988ec1d0bd3abaeb4e9074be0085942e629b8c742014b686893d80ae6f03c8fad032a48634e982b60165fb6e
Result = P (0 - Correct)



COUNT = 15
deCAVS = 000000b07943ebe59b2b34f399a5c15d679af1366a358bf083aeed982c777d1e
QeCAVSx = 00000119c17519fa575d31299a104366bc6d2c8d08e0853541670feb71ea64c0
QeCAVSy = 0000003eaf00864b707282feb258eed2b1627e2c66adc5b175ba9200522bf990
deIUT = 000000c5731b66d4b3e043fc615a2c67a4950dce9c9e6317ce999ab6b9b35735
QeIUTx = 000000cb67b709fc1f41906518aa7725b71fcbd52398f9054676dbb46a5f4555
QeIUTy = 000000c1c1c967dcc9cbfb9ff0cc436275798a383804d177b26fb99cf6d1b9c0
Z = 01611844189543ed3e88d6248a1074e83f5a2c56acbd5345ec524221ecc0
CAVSHashZZ = 663977a9cb16392a2a8d0d558ef87364ea7227b1c17ccbfeec6c2eb89cd3c37b39a46fb423193f2704e6902b893f5d11269ca2231ab1d4e6eb04979b640e5e12
Result = P (13 - Z value should have leading 0 nibble )



COUNT = 16
deCAVS = 000000c4d28bd03172d5036a5c8d5e0b744a9db45bb147b07600b9a851bb4bf0
QeCAVSx = 00000191de6469e4bb7c03cbb05443423c510a908f30539e8558948531eff732
QeCAVSy = 000000c4e1807b3230411bee0278e126805a27d7e127bd383dd3e693e15124d7
deIUT = 0000001640cfec62f4ee29464e343e796ff8233443ec73535762d2a4dd087970
QeIUTx = 000001b4b1c99c8ec2f7d8be5d85a57d67fdd0cfbd7aa825edcb808d00298c13
QeIUTy = 00000113b43256e0817c528f007ec591b7ea5119f108793a88b5cd40289cbd5d
Z = 01a5409a27618437063e20b3c1abd59f1df883ce5e24bc026e29562d85f3
CAVSHashZZ = 0375c4baba64ee191195599b36fa1a284ce2c54f71e290c95056cc28f8af9570c04ebc090521542b48c13c2fbe1ba42b74494bcac68e94c5bf8f4fee637ac44b
Result = P (0 - Correct)



COUNT = 17
deCAVS = 7fb46073a9f798b9df77f1966f71ab19fc09a44f6f20f5ea58df6a69
QeCAVSx = 0000018752f29951ab531ece132ab35ee0e46968698961ee0b553486c88115eb
QeCAVSy = 000001faf5accaa4d1dd2c830fab300bc123075a5fc59e72f775873b551cd136
deIUT = 0000000af62eb8a221f953c2c0cbfc508cf90ff81693ee770b488ae516a1354c
QeIUTx = 000001dd07f043db14599d47bb8678b5046c48dadd99fa3822d1dc42153bbf02
QeIUTy = 000000f2cbdaf846b06186fcc7d11089e0fc237a2560f1fde028180e9773075b
Z = 004d4b7b66a4bf1b4f52ff31903c727c4de29c2d3612ea10954f3ba8c28c
CAVSHashZZ = f3b9e7b83311aa79130fed535e39521b396ebeee20e18dbea7b25028aeb5ea8dcc3e6275f883cf04267b087703fbab861db9ed86d87da395c9248ca5e38127dd
Result = P (0 - Correct)



COUNT = 18
deCAVS = 00000081563cd13148d45076ba4345fd352e8064178a955e8c91e973e28a4f47
QeCAVSx = 000000e7c7139533f06cabdb61a2677ce841a0a83e19624ae462d92600dc04fb
QeCAVSy = 0000013b0ca8c61df6d9bfba5a6dfc087fe5f9b3d08798c40f327e1729f775cf
deIUT = 000000f69ed4695f9bcac81173759259f6a20dffdde58f6cac12d5769ae11ad5
QeIUTx = 0000014bdbe215ae7d5c22553d1cf1a4d3c4e6f07da16739ce08cf85d2c58ca1
QeIUTy = 0000010a11229ad66d8f78c4780aedff3ffc3f41662b4d638f1e6a131c673924
Z = 029c844bfb3e5e39599c64255af722042752eb8d2c86f8bbc4ca057cbaf5
CAVSHashZZ = 1d2d7362e46597dab1b5fe5578f545f09a95bcebfb15c452c52b163a03dc03128aad90bf3c610ae35e8394e831929b1eb37a13310191565af52f6b97003fc32b
Result = F (8 - Z changed )



COUNT = 19
deCAVS = 0000003acfe3f861f6b2f391a47ff201a1c53d2fd27a4ea2a9c5926835542ce9
QeCAVSx = 0000012b6c170d679f9e38c33b62f5643b2eba42705114d1f050ecacc2cd43cf
QeCAVSy = 000001504f0e1ebfa0af082e6642f902e71f0fecdb4d0b6f881f1806356c2b7a
deIUT = 000000967a8b13546c850d61f755059ecbff80670373b125bb3d57b8f62b3b22
QeIUTx = 000000160132d70f42edb230fcd09219af3e1011c16c033e38569b86884c594e
QeIUTy = 0000007ac5b43d16e0452931a89c9e5aecc20ceee721806e6bdbed75d3a40260
Z = 01fe4cca906d2ce2835722edff70ba9869db0ad323355b761fad27bc6403
CAVSHashZZ = 2862f3e835a11c336f9a945edab826ea73bf14a95b3ab617e85d9aa997a24917904dfe06cff5aae81664b2145020299a0ad465d66c4b3321248a22ae847858dd
Result = P (0 - Correct)



COUNT = 20
deCAVS = 000000276f7488921977092ddc7f44eacf408dc5c60ee7e458e1bc3467b78407
QeCAVSx = 00000180f627c99c5bf8e092e64b37de824dd68080ec60b1e50b9e57a6f68cd0
QeCAVSy = 000001e6b39451339f7cc2e6c38803f4939190a4b5ea47a5bcb84075146b2fa6
deIUT = 0000005e0baec8c9a7e737b453039d90be5c7af2fe0d2cff4ad40c35d1d067c0
QeIUTx = 00000142555ed38f86e01887c1383b4bf8f3cc82a25eda41d94b162a45a77654
QeIUTy = 000001caa04814361977c6576e26d3a3c087348be2648a407590f9b294d35c1b
Z = 016d6b2aed6ac921a83fef2b2eec0a894f43c884cfd1c851d4f888e09778
CAVSHashZZ = 905ffd15c50ef15b25d029e6f86eece3cfc12e24579bea5443ab751dac8452e781b5f8ee4009027f8a739f40b469e27819c3de591e0248b8a8775a22ba4ac509
Result = P (0 - Correct)



COUNT = 21
deCAVS = 000000531fbb54e4a71158183841baa806234923661d30e4258d29377c169e8b
QeCAVSx = 0000017c946749dcefc77b1267950004a3d3edb7c7ee9e4b149f6edab61b4bbb
QeCAVSy = 000002c3a6bd41d65213907e42f974d0f8899de483dcdd3f04749c28ea644f26
deIUT = 0000002f341bcc6a3327e61aab7e3b88e8d040415174d1f0989f891c77519974
QeIUTx = 000001f267722b5c449430b8b8bb95a6e7875b73ff3b09da26331c591a26658e
QeIUTy = 00000095413eb2ba30a40a45f204e8a44ba63e4a21c652757c18befee0f632e8
Z = 00623695feee788b5d7def2e48a1325739220a7f530b00aaaa8198d6c5ca
CAVSHashZZ = b6a4fcf00de0ee80e9767041bbda12a2d19ebec8a1730dd7bfdf92ab17feb890f84c8bced7f2c8a464925bbcbcf6b997b69f39edeebf620a20dbfaa016b09e8c
Result = F (4 - CAVS's Ephemeral public key Y fails PKV 5.6.2.5)



COUNT = 22
deCAVS = 000000e1b3bc02646af2a51b9ecf7082ab812a41dc94fa3021d363031584acf2
QeCAVSx = 000001cc08e429f5e0f028db27e3bcacb4666907326cefe28c3474c29d60cc11
QeCAVSy = 0000008929106dd47e8b88d01875bc9f469997a8bd5f00b5433d4438efb2491b
deIUT = 00000026d0c35486a3ba224a5a3d9a20a9dcab34c14f6a707a9a0fddef23322a
QeIUTx = 00000067ac69ccf487dbb5e21480b83874aea5526d91bf6a2a800d9e03d59659
QeIUTy = 000001334834e12797471cc0ed12f2c3c942801516cbe80d3df6be80e3f6a6f8
Z = 00f826f70bed30215419177ce7386e1ca0c3f72a0dfc2c8c1bbf7e5de79f
CAVSHashZZ = 1edf7d1b007c2891ffa2c0a128ecd8b952dc47307a8bdc3b0988551c3e1d40f6d4e0a84c5a0c1a107b78772707477941c40fc0baec9fc7818051431d8e592d0a
Result = P (0 - Correct)



COUNT = 23
deCAVS = 000000c5a6b3b7625d3fb852c04c9530710d9ac3bd58eeba9c1d2940528f19d3
QeCAVSx = 00000186f2341dc0af1d0ddf683047f45b5a5a4734777ad1ac29e94fe2aea36f
QeCAVSy = 0000003de88e116666f2dabdf3f09e6eb725acb7fb1d1ba35eb7e5802133d126
deIUT = 000000c2d9ca8f643d2e8239220f345e3e2bf549f1499a7383629afcd87eb2b6
QeIUTx = 000000243ee6ecb5a8cfcb03286de28b377c337123fc14ae485644252910f0dd
QeIUTy = 0000007bdea3669b777176f1486cb5c826a9692d021096b62a98dc1a9e3dfce2
Z = 00ff851d59df4a8fef27fe8960c5c5632da0a504d0bf89dff2220eb54eca
CAVSHashZZ = 58a7f5290f359ab9d9528040ca0b28d22e6b8818e5c68e2264378f17ba8d752a242b30c1d6b1c457d73f1dd0c36b1d4a5c048bcca541d80c522601262aa36ec0
Result = P (0 - Correct)



COUNT = 24
deCAVS = 000000698c4cd2adf6f15ac346b7771faf4952d7cdf3d84a12a2a99505c849dd
QeCAVSx = 000000ca31adf4a89e0d6c7834e83c4e248df8f32b111c32f7d2a86ddb7fec99
QeCAVSy = 00000168fef5079384713457020dcae4fb49d23dd678c545f82e675b5f49c0f2
deIUT = 00000020952928734d24d8d68186f5f5a6a8a25f0bd6cab3adf9dde45dfd3bda
QeIUTx = 000001a9de898bfa0def65a2f4ccc61ffef09fea8a956760eb76fcf358dbf9ec
QeIUTy = 00000129f3ef267f0ddd119aa6e092381ebec66b6cad7d2f718c68a8122e1ed2
Z = 00f4d024cb5e70c409910cf851327121f4ad81f58b0b4ec38525eda3ab7b
CAVSHashZZ = 493b1f10b6c711b93d7f7a6b6878477f77da9bc1f0ce6f16a2bc7af509a3388a54ac6b82d3e671b60d3c9d2fac086b72e3573d7b67bb3926c8112f243e2ab7c0
Result = P (0 - Correct)



COUNT = 25
deCAVS = 00000008b885ab4f8524189df1c4bdc953096932fb0698f2471032aa4461e225
QeCAVSx = 0000007c3368536f468bf13a9e88f23987392daf161f9fb3762dffadf9161744
QeCAVSy = 0000008725dc4fad1eaccca5ae170198c162e2ec4a0726518085d92408ddc323
deIUT = 0000000a9992775ade19e8e6675033bb556722adede325d0cc1416bda0b8c57c
QeIUTx = 0000017c39a29cb8f7e54821c50e399114ba9dfa4632067d71624c12ef91e054
QeIUTy = 0000010f1bf59cb592aa7538ec90db8b43cdbbb080b46be569576b00bd6be662
Z = 00b5cbd2684095e821cea3a31425a5f1837c68e8490e5fa6face875cee6e
CAVSHashZZ = 63258d4d27939299c2312d2342e016d63e130d763742e1a49d83550ae5ca217289c151424b239d15db0019e7ab2b93bfc2786b65bca8217d402e121ba5e2e8c4
Result = P (0 - Correct)



COUNT = 26
deCAVS = 000000795856665d0b2be0c2ea9c8b178efab121faea42985f59efd332356ec2
QeCAVSx = 00000148d6659d8b14877f926344fb8c815aee1969f0d8c5f36ace19098bcc45
QeCAVSy = 000001e159bc4a42ea2839b144356b20926eef0695aff344f3292ae5bbca4598
deIUT = 000000138224a15f6b322906ddb8392cbeb65f55c8abfc46c9bf95861e82983a
QeIUTx = 000001fbf92aacee58b048c6521e7f476da787e8736dba56b0374a0d4e4ef197
QeIUTy = 0000017bf3a4eafaa1de2e04010e22e245daa2ed1c21307aa9d16deb1e1cb267
Z = 0006deaf58fb3ed6c19dd38e5096caeb40b8eaa23f8311f6a7109b445900
CAVSHashZZ = 14547c9706ff84c93055c0698f902e6e4f2d28524f746a1fbcd63bc373756e4e10a445cb047ecbb7bef98f08918b1643eee882e029e906e7f90f0473c720b384
Result = P (0 - Correct)



COUNT = 27
deCAVS = 0000006977463f2f0e09f336b96a7178a0f297151886cb6c6e5bef6b7145cf0c
QeCAVSx = 000003055df1b1f78e7f7f2b529b227ce4dfa0d24fb25bd5e66ed940d50a38ab
QeCAVSy = 000000345b5c2606abfffe58f4231ba4c676241bc56890c4e6a940668cb1e61d
deIUT = 0000008735a0a22f753f0940916b920e1052b44a4382ca43a61b1e31f51ba31c
QeIUTx = 000000078711b74358611a72b7a8e7529d2e40b51158c3c029ab97dd25d6c9fc
QeIUTy = 000000f599cb0af55e4ad2597b235b5f909029d94cac4219566ebb76919be1bb
Z = 01e81a3db4f40de7af82c92d0cd5c16542bc9fcf182c141d4126e4eab4a8
CAVSHashZZ = 7317387f2b0acfb8c70b16743ab768f57e92a0a01eff15bf5fdc63a56ee5965981f51b06a33702bf0fe5dd90c46498a9b2c6f6f7e0499618a8d7f53ed8bc920b
Result = F (3 - CAVS's Ephemeral public key X fails PKV 5.6.2.5)



COUNT = 28
deCAVS = 00000009135445df0a326b3ce1c5ceedb65f1f72cb546feb216a7b2bc7637ff0
QeCAVSx = 00000097cb98abc6a76351d2c8b73b5fa036b2ffa38f6808c6a0e8cb042ebf04
QeCAVSy = 0000011de172b8b792657eada396658dd569b55048b08cd94652dc7cc44d289a
deIUT = 000000f70d1914fd065e166b4dee0bb8b1c065e51c7b316eb08d68d658b7c549
QeIUTx = 000001f9601630486fa5e176775f6ac6a78d66e52553bfb3b9a279eb8c7a16a5
QeIUTy = 000001200076339227942899a5d95403168f4d79a272d5dd12e174ee9b4b2738
Z = 00a85dc261f54ec2a7cc3e7566c7b7eb6d5714412f4fc5e599981dc71c13
CAVSHashZZ = 59a672d25c0d74614f5e23eeb751afbf5c421525ece3fc08e6646c8bf8605514d416da89f7a42142c7e6d5e623f3c91ca344a068635fd71db858923e2af77174
Result = P (0 - Correct)



COUNT = 29
deCAVS = 000000a3bc9794a865805853d11abe9888aea04990dd29c33e7ef587a7a12871
QeCAVSx = 0000015c5e0f96564080f69c90069a63b16be1ed978d610be383abbc161300b8
QeCAVSy = 000001cc30d148d12d8c9595cd1962089ded6af1cbb03bfa259cfda0626e3c34
deIUT = 0000007067d5496d377201279a2fed274b40c0b9c6e63d428a8424b247a44fa9
QeIUTx = 000000d3e0f6ae5b49ba204c80003426898533047234d9bf231929aa936217e4
QeIUTy = 00000162a3b75c090d5f5c0587c69bf988bd91b95ffe3a917c5192f5cecbebc0
Z = 01c1176f912f28c0b3785c100d03a047e2a9a7112f9ab9111f9636e1505f
CAVSHashZZ = 07f11bc805db3c2e330752faf71db714fc30a2d0892282571f2bfb399ea9e54817cb03b1d5ff1efe0e12ecb6d533e089164d4ee4bbc28b573ff225805f887bd2
Result = P (0 - Correct)


";
        #endregion zz file
        #region kdf file

        private const string _testFileContentsKdf =
@"

[EB]

[Curve selected:  P-224]
[SHA(s) supported (Used in the KDF function):  SHA224 ]
[MAC algorithm supported:  HMAC]
[HMAC SHAs supported:  SHA512]
[HMACKeySize(in bits):  112]
[HMAC Tag length(in bits):  64]

#  Generated on Thu Jun 16 14:55:32 2016



[EB - SHA224]


COUNT = 0
deCAVS = d58751997b3a551ccdc6f507bf6ab87e2be7f8267067a455a5815a54
QeCAVSx = c7893ced15c3009b93cb0abeaea2ede308b67fbbd902c6c5d94c24a4
QeCAVSy = 858afc2edd61fcefef3469dd5a004e74a3c727d16498a9408a8e3224
Nonce = 123817b69860aa195a9cb405b9554750
deIUT = e935434303d842605d07112b3b7789ccbe4c6d987db5fa15ea1cdadb
QeIUTx = 784028a2246950401ec81f8e4e03fd3765c4da4d45eba652ed5ba2b5
QeIUTy = d071c32634bcf058f072493b6943453a0bd117f5ee5c5866f037f6ab
OI = a1b2c3d4e5434156536964a6a68a65ab05652a9cb3152d9bdf5d3526995afae189667f96e13da17a905ff0b2b9b5bf
CAVSTag = 5f5f30f60bb868ca
Z = dfd0570d4ae5c9f690c757aead04f7e14758fdc4ee05d8f0d089b91a
MacData = 5374616e646172642054657374204d657373616765123817b69860aa195a9cb405b9554750
DKM = 24b6b6e6d10b2e5482c20ba3b06c
Result = P (0 - Correct)



COUNT = 1
deCAVS = 9fd42aa07e42d1fdf2ae0f0acb7a421803b0b33782fb7c4faeaf83cb
QeCAVSx = 5bc6baafbda2a335fa2ce37e5fe46873bc00af558d0cd307b764b3d4
QeCAVSy = f63b5cf3de9b81bfebbf612c296c5255dce14725667338551a352d1f
Nonce = 00a52d5fd7f7ee3649fffecc76ea27d2
deIUT = 905fa62cace9a468292ee1f952adf1067cdde8ca8c0a2e1ac231f219
QeIUTx = 9e6b07341c9a61fc436fae6eb3c089bc5c032a4ad900742bca1961c0
QeIUTy = da1957cd88d693becb137e2fd91b27ac3f8f3e47fa1e72cf2f09f00b
OI = a1b2c3d4e543415653696400c40e1d19dfcfe4e74569f361251d1a610039ff4bbbdfcbf0f30723b290c75ae89dd3e5
CAVSTag = b23b5c10390e65df
Z = 08c4d35fed10a3901463f23a93390377dffd30cbce0f6b2e6b79971a
MacData = 5374616e646172642054657374204d65737361676500a52d5fd7f7ee3649fffecc76ea27d2
DKM = 0b614d3f8ea34fe9c93a517b575d
Result = P (13 - Z value should have leading 0 nibble )



COUNT = 2
deCAVS = 3b0df0220c5c03aa26ca60614325c9df60a25ff1740af317f5752bcf
QeCAVSx = c2b7a13c78901df6213f2c7d97f1ca59caac2d2ff69eefb2c64e5fe1
QeCAVSy = fa444b748f4d3bba325f563a56b7c997a8f2bf89111862424eba8682
Nonce = 017f6545df8f70aa586f38604f7e69ef
deIUT = f9b6921e3686e0731d1f36c210552d0c468cfe199373524da69b1818
QeIUTx = 03bb65aeed9ee9b79a8c52f277a569cc39f7062dcc9c49b87edf1c45
QeIUTy = 08d4e4553fa1add2f4d09e312bfc78c9a5ee02b775c8553c5e4a4be7
OI = a1b2c3d4e54341565369649658a66db3fff5f6fac9f51387b3c638916872149ca9c515eff25f2a495b07ccd0bc423f
CAVSTag = ed2628aaa85232b9
Z = 42c6bd541f1578daebb98e39ec473646486003993982fc9ec9b6a593
MacData = 5374616e646172642054657374204d657373616765017f6545df8f70aa586f38604f7e69ef
DKM = 79784262315709a7375a17fc7876
Result = F (3 - CAVS's Ephemeral public key X fails PKV 5.6.2.5)



COUNT = 3
deCAVS = eda11808068a90556ad708ed66371b3850d2d3d8b78997192f2cb00c
QeCAVSx = 49eb42be0cc838353f93b8a0b26b66292d0feddedaac39182ed1f3ff
QeCAVSy = 3daf6de14a5f562c2de4c7547dec1a2f2fae3fa8d0be3e30a2e596c4
Nonce = a67c057b55c760fa69190676efd61c8c
deIUT = c9e34f7d9864a46490343af81bce5c095b91b944fa059140531873c8
QeIUTx = 153619fe6773a1808727f1a16f3a6ebe24f1befd888e56f699b1f08c
QeIUTy = 4f643807be49ba16ce3166ec7edb2ade9bdcf52fca1a0fd01702c4cb
OI = a1b2c3d4e54341565369646a37f2cdc43afdb1485dc508776fecba2d304228d1b796b5cf11cd85482b318508f10bab
CAVSTag = a44d98fc40a4fa78
Z = 57f66f60ed9baf59421ae4b1318f4e2d080930a3157adf3147e60d06
MacData = 5374616e646172642054657374204d657373616765a67c057b55c760fa69190676efd61c8c
DKM = 7f4f7e2c640bdc8879d921fc6cea
Result = P (0 - Correct)



COUNT = 4
deCAVS = 73d47209d395920a2cadf87cd8e398aaf66417a475c9855d987a87f0
QeCAVSx = dd1d1e96d6fb1e2fc500ef0051207b733fcc6956be9489c633b85da6
QeCAVSy = de5777e1fa17b49cf55fdf6e6a1e580b94fa39c4304be0c7d99b8c0b
Nonce = fa66f86f774b7b9537b093b0fb6b9651
deIUT = 9e45a5f575e0f1f66a692662c0deadb17908c52b7ef985bb00babd8f
QeIUTx = 4277a44b00a8695e61b3abaa720e13c6fa907df4665d4f45a1d95727
QeIUTy = 577251ef960f7c91612f6428c2d0df4f9aba854df271c58d35dbc230
OI = a1b2c3d4e543415653696462076987d2b0c4aef2cc3935ed6fd9f5055caee720785739847ef2a1dff33ff28a5d01ed
CAVSTag = 91b0529d9e163d59
Z = beaf1ecc2ab19c7f74070fa324cd89d01e7437eea7c086ca23f0294f
MacData = 5374616e646172642054657374204d657373616765fa66f86f774b7b9537b093b0fb6b9651
DKM = c622b5061fb09563253a920ca84d
Result = F (4 - CAVS's Ephemeral public key Y fails PKV 5.6.2.5)



COUNT = 5
deCAVS = 5508786ca56b599e010625a56a0b706dd0097b323e6c5a2fb1a23375
QeCAVSx = 5c35a5d88c28740921e94ddd30b6ef0fc64183334fd916459fea90e4
QeCAVSy = 8f5c10dae521b479b25311b0a3d7afd919cc32b8a4232fc202d0a710
Nonce = 00114fb2e332d0c91577af5b0bd22c7f
deIUT = c0e3b23ebc33f9f286ce73d7d3ad321d2fc352378a4e9bdfbe1a6c3a
QeIUTx = 7f3c30184c4cd7c09369239f211369c0fe37b642743ef8aa67bd6413
QeIUTy = c21eec8ec448e14361e24f39b89590df294aab27edf1044ca7dde115
OI = a1b2c3d4e543415655696490715058c4aa6a002e83d520e8430b5dd5d0aaec27231aa424f9705829cb9263ef019c84
CAVSTag = e78b6e880ec805d4
Z = 891cde8978eebf66c0b9733affa5eb726265d043d2fde7567f4efc75
MacData = 5374616e646172642054657374204d65737361676500114fb2e332d0c91577af5b0bd22c7f
DKM = bdb878aba6a72f02ed67b3555040
Result = F (10 - OI changed )



COUNT = 6
deCAVS = 5f977342aa952a49b42bfea7d1fa639b355ebc75424e2d2446313654
QeCAVSx = fc588727beabf89cdada2c51453d4addd843c2224141f84ebfa1bd81
QeCAVSy = f8e660ca1fa4f07fb1c717d00da3e8e70e337c0d1e715d8f7252e643
Nonce = 978d1d84bbc3d78665f8dfb92facc732
deIUT = e0509bea4c9037f9f9b19b874cbff978a20bebbd09d5fcb55604070e
QeIUTx = 8dbdfee7b27d0cb99ec20e33cb19c2bafa698b4b2713f87ca8a97a71
QeIUTy = 8784a0b948392a11d7aca113ce31398da22707532b6038beb703d978
OI = a1b2c3d4e543415653696488e00dd9a71ae021d1d927fc6eb9a27e5210dc528e73a6598c7cc3955bcbe546474bd952
CAVSTag = e72ff143a8719ad5
Z = 410330a347337c4440f5aa8a12e8cc8265359b6752d16bf9ea0b973f
MacData = 5574616e646172642054657374204d657373616765978d1d84bbc3d78665f8dfb92facc732
DKM = 767600e82c6b460d8fdc9c0a51e1
Result = F (11 - MACData changed )



COUNT = 7
deCAVS = 83c4a9b3e9e378f023b1946775adb4b17c7044969b42f017c63d4ce8
QeCAVSx = aa2fbb8f2a6e32f24e8871007c1a83fbbdcbf85135899b5ccfda288c
QeCAVSy = 06a8073e46987ebfff1c873cbd30dca5fdb619022a7e4cd1d748b285
Nonce = 80b22b816f45922eff0e0c85f09d763d
deIUT = c05397b811b46da0bf7b7631fe60452cf76250147d9e8aad10d1f16c
QeIUTx = 7bb11bcfc625424454ffe54f56717e1b9fc7e5a6e02857b83ba9a67f
QeIUTy = 0d8114944ce0de1554764a89aa26abe3fc9b861b07e8ce7475dd1bd0
OI = a1b2c3d4e5434156536964a6a416af88c1b52c3c5df85c0443d07af9b7bf104fab3cc8da36597ed141a399d3844a9c
CAVSTag = 0d240b82dfeafb38
Z = 49206a7ab82d470c5b86c9bf5bad92949bf6e0b201e5bcf09f46190d
MacData = 5374616e646172642054657374204d65737361676580b22b816f45922eff0e0c85f09d763d
DKM = 2a84fadf10dad0b06ca9e82eb9ba
Result = P (0 - Correct)



COUNT = 8
deCAVS = aed6cd978a0edf82123ab4104e39292b3e3f8edad2a6446c6b9a88a2
QeCAVSx = 5aa17d3044f5d2298d87043d06d9835ff07791244440735c2479b7cb
QeCAVSy = e3260f636ce293f03f037ecdd413a4d33512e59ba13fad6ebc210e2f
Nonce = 740a57f76f32d3e1d9ba2a4e7c531998
deIUT = d8e2c433814333cb9e43f2666dd1ae0def5ad760b3eb612a3ae00dab
QeIUTx = 01919c9020b1d616365ea82c553dd6f84eedac0ac7c0e0d4e425d2de
QeIUTy = bda2c7cc4489e0decf1706834979eab21467c8119122120737d66579
OI = a1b2c3d4e5434156536964796cad13136c853eb74fb36f300083953f96c314453319c8432b9a4704699767990fba01
CAVSTag = 8db19decc288aeb1
Z = c299a32b0cde07625b90dfc4714b49e2e044986b36fed7c166b1c555
MacData = 5374616e646172642054657374204d657373616765740a57f76f32d3e1d9ba2a4e7c531998
DKM = 9b94fa849b16a0ea81ad71f0f5d0
Result = F (8 - Z changed )



COUNT = 9
deCAVS = 2aa12715f96b694dbd13133e28dd0da7841c0e05bcd9f2bb97c8a199
QeCAVSx = 09f8bfe2645a568b189dd3f5381020d8c214b28c281bcb7fe6e3e99c
QeCAVSy = c788a04044bc9d6a4ea7a4f480790857243d2d76f2de345d2c7d5b77
Nonce = 9a1bd0f6e469a0951bc7b7000ca455c5
deIUT = c092b5174648c43cfe9678701ede25490adfac155bac577837f0e179
QeIUTx = 35cde19492fd1b0e35212d551d07ef4dfd676801c2b678934319721f
QeIUTy = 24c5ddc7e9aa7c291e2c87a58f97c9500a2a26ddb9c1445acf2fd48b
OI = a1b2c3d4e5434156536964d1b9473d27f6138e5450a6358392adf6fd38c6ce54d44a7ae1b0693e71b57ddf3c8b98f1
CAVSTag = 8f79e3498d5aa63a
Z = 8554aee7824cd6b67e37f3aa0fd63ac4e10b0c34dc85af2fb005aa47
MacData = 5374616e646172642054657374204d6573736167659a1bd0f6e469a0951bc7b7000ca455c5
DKM = 84dd2e985b058ca6193af4703576
Result = F (9 - DKM changed )



COUNT = 10
deCAVS = 5b9e20fb6cd6da572eafb509b790ebbaa0f4f11d89229380a9e1cb20
QeCAVSx = 4c58c828598235a36bded8cc375cf05efac7de510a0a0e86f21348ba
QeCAVSy = 8a082bf92dc3e8011c72bf1958fea91d917e3e79bf4964fefa933891
Nonce = 8e8cfe96768f0b71211bfb1fdbe015dd
deIUT = a6920deff57f9bdd391817392c54fffeba5b8cfab58d0ce205b6d718
QeIUTx = 384d7f2123b10e980589e01585e05b4bec75930180cd59a8a45bf001
QeIUTy = ccbdfa19bf3912b24e67b408c3c3338ae437a6ca8511c3f7a851311d
OI = a1b2c3d4e54341565369649768357c51caa4b553f2dd387f8fe4cc0f41e7b2ccff172d80b6b641ad3271ba7f42f170
CAVSTag = c2bb521241ba07c4
Z = c7388197fe720c6b4aede0b3a642bdf0011e63b7c992e540ed50f11d
MacData = 5374616e646172642054657374204d6573736167658e8cfe96768f0b71211bfb1fdbe015dd
DKM = 0459338b394663014437c13f72ce
Result = P (14 - DKM value should have leading 0 nibble )



COUNT = 11
deCAVS = 5083cdad31d681d980a09a94e8f7734455e83b2a0a0694632da8afe9
QeCAVSx = e0b4b916f5db093ea887d9b201b1b79276c848b9ca42f5b4b6d593f8
QeCAVSy = 051f510b68ad3297f0b30750e5bdbaa378bb1b3a07737ffbbe83f3dc
Nonce = fccd2e7f5fb58490345f4c2bc8b65044
deIUT = 9ffa33f30559ced424951694d5e2c6c8c451fd62e422ba516995d533
QeIUTx = 708032ba21514401a8d5dc71b8a0189829104f0d4d69fecc56e5905a
QeIUTy = 6fc6837195affca287712643a7d795fa695ac5f2432d5bbe34ca6eec
OI = a1b2c3d4e5434156536964491b455c0721b0e2609902fb2460b311a6cecfd16f96492e34ed91a906ef68d0c93ef405
CAVSTag = 2c4d542c9edfacc0
Z = e7b647402ce9bb2a8fd63df0eb6b8aee162158ec4ad70583d7e7254f
MacData = 5374616e646172642054657374204d657373616765fccd2e7f5fb58490345f4c2bc8b65044
DKM = 78da590faefda52478b69ecd858c
Result = P (0 - Correct)



COUNT = 12
deCAVS = 01398c98d91b60b947c0f2b76899454a749742cc48c5fba5d582f3c5
QeCAVSx = 7d4c90f6741500a148db0a24999e9a3295e1c6d597ca05866d13e217
QeCAVSy = 69b8db344029a0e0b70d47c061e337a50afa67844833a7379fd5fcc5
Nonce = f0b4512e277ee7d34829f4b9acfeb5fe
deIUT = d0665be70648d231f97b5c14af7823ba2d6a1bd209a38f9bd6f4a83e
QeIUTx = bcb5d857ecf21ced2d4675a6d13493f16b0efe0d3afa169df71d6422
QeIUTy = 02e4b512288d052574206661a91ff37b42f6e51f8ef6dc3729df793d
OI = a1b2c3d4e54341565369644fec28a83e279d19bd739bb65f686d71d93690a2b78b0a084db7fd0aef0e7c43658d9d3e
CAVSTag = f64236f86768d914
Z = f4a79ac75cf20b979196cb3d18f6aa8fd3da4e1bd2a4394dfa4f5eee
MacData = 5374616e646172642054657374204d657373616765f0b4512e277ee7d34829f4b9acfeb5fe
DKM = f915cac836fc912bd1c06775c312
Result = F (12 - Tag changed )



COUNT = 13
deCAVS = 8b6d7549240e142dedf68d19fde262c862350fdc6ec95aeda59bd27b
QeCAVSx = 4083656a3924c90c0ac2f1fd3f1b42f3ce9a1745b24229dc6dc956be
QeCAVSy = 526ff7326113540e2aed2f61608cd07377c10f70fbdbec53005af0a5
Nonce = bf59acc0106ba67b1dc93dea712369f5
deIUT = e9e770eb773f40ae552dfe4a6622cefcd8f81f958779fe439af3079c
QeIUTx = 57d45f07c4e1321ecc99338d35e3ccdf8aa294c76bea168f54c4afd1
QeIUTy = 308d8ad61de1b572e9eeb488907ea251869fd9ccb5363605ad6929c0
OI = a1b2c3d4e5434156536964970f6bfb8e8058b520cac0ee6377922adbcf8b814c56aa48cd95e5ed1e1d1a233bca483f
CAVSTag = b071c7c6cc9198cd
Z = 51d116177b5337d36028a7a290e977f2594786a5d22ff9edbf3da2f6
MacData = 5374616e646172642054657374204d657373616765bf59acc0106ba67b1dc93dea712369f5
DKM = 3f8aa685e3284db93cc315a151bb
Result = P (0 - Correct)



COUNT = 14
deCAVS = a311b96ef0daa8ea24c50a0aaf7966b91c70f314ff54849cf7c365ce
QeCAVSx = 4871d7f6544681414d0945bcd653d8e444f0e54b55b63e31e0e13969
QeCAVSy = 18ab7d57abba995a7dc35e1f8d2c82a208619155ed676eb3dd2525e9
Nonce = 61b92537eb415b69228038485d7e704c
deIUT = 48b30b3a6298db2300dc21e24e2de31a9a01a9ba13cc2f9a1d5ec076
QeIUTx = 7306cc70c06c6efdf9a3bb0ba817a1b76e477e144dd9d012bdd5a5e1
QeIUTy = 74eaa0947c290c0e5bb7df7d66c35e2c188a06af1c3dfeae51921e7f
OI = a1b2c3d4e54341565369645a7b7c79f3e6d9cb0abc47f4740ee1b7b9d50def17e3a424ca19545c8bdb433357c1f52e
CAVSTag = ca4c94fc3ea16391
Z = b6c27b6f07b9f11aa0c90c0db2bff94ce0c1d58f0d241ecf5a128421
MacData = 5374616e646172642054657374204d65737361676561b92537eb415b69228038485d7e704c
DKM = fda4833ccbd8476195ff05abef2d
Result = P (0 - Correct)



COUNT = 15
deCAVS = d35843857e9d0f6b9d2233fca7c851bb08a1c864e2d7505558467bc3
QeCAVSx = 4b1f780b0d01b6e6256227a6051899564fb923c664da976d4d1b4f82
QeCAVSy = 5aebf7048126744de142ee346f966297645db26bdd0db0ab03486dd5
Nonce = b48a16fca0e00a7b4ba5aa0d7f8ab20c
deIUT = 90b71e7f46c052d2a4c573f6515464eaf68a330b81aca8fd72537559
QeIUTx = 429a79b5262a39c655bac6d90003445d65db35fc20f8405ec8e94edd
QeIUTy = e4262cb2e30a527ce93ff8ba8c268cbf677a37ff31710eb0048dcece
OI = a1b2c3d4e54341565369645be69fd2d3f44e7cf18523ad9051ff91bb8a647320788783c161a7d7edab9eaf6f44b6fd
CAVSTag = cfe6bee45c5cc653
Z = 61e5c62d0ccc0d639fc51c15bb1fdf97ad9f685bc72c28cbd28374b4
MacData = 5374616e646172642054657374204d657373616765b48a16fca0e00a7b4ba5aa0d7f8ab20c
DKM = a5ab69db0afe4ed52a0e61a139d8
Result = P (0 - Correct)



COUNT = 16
deCAVS = f36f4e372fa0cd5917e2807771b0b423cfef437d4cb8b66bb8355b8c
QeCAVSx = ed07da0c9a8020f7f870be32624ebc60d9cc4c725466bb36cbc91003
QeCAVSy = 9a7014f5548e28b99dd5cddfa6aa6e8d5d2021af4c0d5ce38f94841b
Nonce = 2775a9e905cb1881c52f4050cc024be0
deIUT = a15615cd10df2f0032e2d3929b16f9fee0fc0c79a31b82ffa266a176
QeIUTx = 13b25fd32050ae3dc1109180281221580aa2a75dd9558b2c27bfe917
QeIUTy = b0d2e214a8bff517d4325eaa9e45b6df001174ae2db65b5dde0d35e8
OI = a1b2c3d4e5434156536964c714dc6a42a375103e25c8c840e292ad095ed210b3227e63fdbf7455e411b33f73c1cbbf
CAVSTag = fa1c4a3c9dce8348
Z = a389ce3e71ac1bea494cc697a90bb9d5f4f775be841a785b2be767bf
MacData = 5374616e646172642054657374204d6573736167652775a9e905cb1881c52f4050cc024be0
DKM = 5e3d2a6e3dce92c670b4b5998c70
Result = P (0 - Correct)



COUNT = 17
deCAVS = 5dcc3999dff1bd5b38195bf14fda73ea604bf7b364e480b2ce4babab
QeCAVSx = a7e3661790ae703691bef4710eb3e59263ae1f1c314075960c0a572f
QeCAVSy = b72ccc68f29840dc764771cfb9b2318ef18566d13dba37b3199b2571
Nonce = e8470a0d4e209852f3154bca1b2c9a5d
deIUT = 79118c5fbd5a69f74c6b1e5bffb6c1b3eccb54083d6550f859126fcd
QeIUTx = 372ff40a656ada0bc8f8fd7bfb2479ace7b976bca3d053632e6f7815
QeIUTy = bd6937c29ec9508b26a5cd56b5a83dc8504770ad3eb765e563499671
OI = a1b2c3d4e543415653696422ff3cb2bb93a457789a199811f6c787a36741f30e5a0dde9b026331e3aa32afec4a6428
CAVSTag = ed136f9f9fe0b6f5
Z = 18629e311c609896446553817e82c6aa2e1067536b7039517d1a71ba
MacData = 5374616e646172642054657374204d657373616765e8470a0d4e209852f3154bca1b2c9a5d
DKM = ec5d23bdf587ca109399f808d0b1
Result = F (8 - Z changed )



COUNT = 18
deCAVS = 6eaf4fac3bf6481c7963657850d7344667ebb3fd1406887efb8f9d30
QeCAVSx = 0e718fbd958d2a3633c73c0a69e80670953ca94a6379b1f0d990118e
QeCAVSy = 0c47cb97949a2345330ca77f271a7a2f90766ef56ef2f56a2bb199aa
Nonce = 9e8f4147d38ac1b6f9ffecdadf92a696
deIUT = ab9a668cc7743287131f42e310df71dd62c541cca63b3be70ddd6595
QeIUTx = 305627affa8ee3614c8d5519fe9e14f851632dff3ee6a52054e4c117
QeIUTy = 7d8b2fd502c62e1cc3da085ed45be6c6d01b09ed4e3f25fa78e17654
OI = a1b2c3d4e54341565369646d2e2d598e3420b51fd587e4a35426ec1a8220b6d63d67b88a3777d1a4f94474dc277009
CAVSTag = deb670d52d4c8baa
Z = 3cc1a53a14c082e388e5c99200a856c6fa5934aa5ea282348842e2d6
MacData = 5374616e646172642054657374204d6573736167659e8f4147d38ac1b6f9ffecdadf92a696
DKM = 283d2522546118ad3485ae1915f1
Result = F (3 - CAVS's Ephemeral public key X fails PKV 5.6.2.5)



COUNT = 19
deCAVS = ca2cd62578b3c60aecfaf7bebf46ac360a68747a1bb6e2031a0fe687
QeCAVSx = 9ec61f6f49b46805398c10f26ff4735fb28cd0090e9cc9c97190c8a6
QeCAVSy = e72e0e65fa6fc4bc5f9739e8021806e07f61750d2c85aeba41358924
Nonce = b7ea6b8a73587b91010a93ffd573e984
deIUT = 4ac2d957bc8b30ba5fbc0b73988b7964d22949450da52cc1c016eeeb
QeIUTx = 23e2e7b5fc5bc50edf7e546f3f73759aa2fd94a21e6fa08eeb86aa51
QeIUTy = dfbe6e15e980a0a22658dff9900dba1d87fa8bad96f9917791c9a93e
OI = a1b2c3d4e5434156536964411544e0ff7a776a42572f8e2bd449c91a66b8562d4324450319d7cdc6ffdae368ac5b0b
CAVSTag = a5cee4720cfdcb05
Z = dd1583bc5929921fcac7261c36b4a874fb8228dba648b1242acb8ad0
MacData = 5374616e646172642054657374204d657373616765b7ea6b8a73587b91010a93ffd573e984
DKM = 18d6ad5a05924df2d3c3a9dc24b5
Result = F (12 - Tag changed )



COUNT = 20
deCAVS = ec863675cae06466b5de3f940501f3268ab25f056e2196c5db894607
QeCAVSx = dac4cb0e7101831feea5056182bc9bfa2403ffc4fa6925c0aaa77e57
QeCAVSy = cf3870ef62839e2d13fb805c08d09d450b8cdc5101af17f09fa39c39
Nonce = 4f36aa4639f630a0a77c739ca3f8ee9b
deIUT = 1280437ebab4dac1424cbaa7f97cfc946b94396f5b8e3530a443e85d
QeIUTx = edcb34f0fd2a93e4875013689c85f35030a69b33d2e5d15438314641
QeIUTy = e24ce041d57217e802d7db0af921aa5f82077abd5526f054d89930ae
OI = a1b2c3d4e5434156536964037021164ece84b078ab237777eed33bed87540db5b384a4bc7bd3ff137ef74c42f1e109
CAVSTag = 6cd8212af894e733
Z = 39497d5d16cbefa1e54eff2d684ff76c7fb3b2be6aa817b37e044557
MacData = 5374616e646172642054657374204d6573736167654f36aa4639f630a0a77c739ca3f8ee9b
DKM = 0c7256bf191d51508b0ed4df0d8c
Result = P (0 - Correct)



COUNT = 21
deCAVS = 06720cf67b555f13ded7a9f1514d7f8da8dd217af5130380d3a4ebf4
QeCAVSx = ab0eb1f0a5dd37b108aa04f421879b59ca0a3c240a4e512c418fa070
QeCAVSy = 420a77a666cdac4ba4334929105e5669f27f19992903bb9629b4950a
Nonce = 82baba701fcb0e2244f217c74e25c71e
deIUT = da74f58b0c80dc5da9a65eb8f99dc088b17dda8acd83df651a97740e
QeIUTx = 6f2d24bd100ac96b34ff245af854fcd5e9217edcb39990554221604d
QeIUTy = ec0e4519756e4b3402c91f02b1fd073ba5da41a797b71a76aa1c54da
OI = a1b2c3d4e5434156536964de68ebae6d4ec2d14e09b0e5bef5773138b3028695c0a675784ca8bfe949ff0d40c25ce1
CAVSTag = a812c1910783e79f
Z = 52f469170a50b0d747a3b4dd95d1093790b0e14feedc3c0a3bc7d129
MacData = 5374616e646172642054657374204d65737361676582baba701fcb0e2244f217c74e25c71e
DKM = db90c71426af56c07a81af5c1cff
Result = F (9 - DKM changed )



COUNT = 22
deCAVS = 2eb0e0ad28bd8af0c5a6584e4aa894d513e0850009841905a360f148
QeCAVSx = 3fefe487a271903480ee9df41802f476023f86f71d1333194320313b
QeCAVSy = 7d8c675ecb28dda692f59dbfa6806a8fac702e12a1ef3be441785ed3
Nonce = a7070a8b9735c8ba15e28e4232ac134b
deIUT = 0c54079795fc67a95f7cab5773caeedd6fe6df6de5d45f1b988c5c5c
QeIUTx = 69413583a6d0af853fa4c0cb83ec04606efb11de71a3d3e96564b09a
QeIUTy = 138dd4c8c7d41cbe2f9d2f1469211d9edafa3189739ef5bb251dddaa
OI = a1b2c3d4e54341565369641704204fae802ee5e912e7a9146b8ede3507fd0892a547fd73fa9d3f29a66e894f67d2a8
CAVSTag = 19f812e9f4b4b98e
Z = 1e61f34e2cc4e92131ad08e5d7629afff747b64bd4412813634f3c36
MacData = 5374616e646172642054657374204d657373616765a7070a8b9735c8ba15e28e4232ac134b
DKM = e849e881cd74dd7e61ead787f830
Result = P (0 - Correct)



COUNT = 23
deCAVS = 7e1938ec75bd20ffa842ca5651486b5bb6de387aa9fed5b98b63a62c
QeCAVSx = fe703c07774441579997d9e1a3874f4bc518a948dfcd107689c085d2
QeCAVSy = b6c9150e890122a781336028c85d1aaba4333e8844133e54d434df08
Nonce = e9ec0b679ad88a6187c6e426f86b4a38
deIUT = 38af464850446c1586423bebb3d8f4552be87fb15bf7b9ffce926229
QeIUTx = 6f32c7c019af39a2e7361074a03aa4635afc495d7642e115da5743ae
QeIUTy = fcaba89ce42772cc39c098ac14fd2ad47a629d85b20b5a00ea5d1826
OI = a1b2c3d4e543415653696447e1d1bcf8b9c5a62a980c6666b3948817944d86e41d24e93dca35b134363cf78fe14dd1
CAVSTag = 6cab05d8e07dccd3
Z = ad2e81b898940ae8fae0bb7cc8d7362c0905d45638b8c8207e3279e3
MacData = 5374616e646172642054657374204d657373616765e9ec0b679ad88a6187c6e426f86b4a38
DKM = 9feefb0ec7901b55ce80f3e30550
Result = P (0 - Correct)



COUNT = 24
deCAVS = c3970d2c9a09e7b1b645a3c25edd3d572a2ed902d55a019b7068343e
QeCAVSx = f09d6672391555428134c95311c3a92d043ceef0d4a8298f25b0e2c4
QeCAVSy = c093f0adf9a823378e2380f4f784f32346d6fafa51f39f913a202e08
Nonce = 0ff99df9bed29c974b33a34b1c3968ba
deIUT = 608e964e0f14c4864676a918cac34a35f399da554a7b33a6b53d9e16
QeIUTx = a715d88b36d50e1c95d68a83fd270472b730722590b37c18b03de1f8
QeIUTy = 34a3027a75a8f44480dbab84f25c16ddb61f9aea0687226bf78435e1
OI = a1b2c3d4e5434156536964a35561ca160e414493100ab51933ca4541760c9f178a4d992895b417dc30fd2c06b1b783
CAVSTag = 06ea443d77f6a51a
Z = adb155d98daea3e9f2a00ba41112a5045c4cf913bebe6dd82066cd08
MacData = 5374616e646172642054657374204d6573736167650ff99df9bed29c974b33a34b1c3968ba
DKM = e8b01082312a43f68162177b5214
Result = F (4 - CAVS's Ephemeral public key Y fails PKV 5.6.2.5)



COUNT = 25
deCAVS = 15a33778e9ef1acd0f230cd727b1977a5198b6dce8f0cd965d1954be
QeCAVSx = bb5683e359afd8218a392af8b60263f380e06fa2526e3dd17a1febd8
QeCAVSy = c6e66686e12233f0ed3f8b57d8bf94f288db2f28304f9c6fc291ea6b
Nonce = 00e1ff94788efae21858ddb17b00b7ea
deIUT = 1619c8da848a1558dc114dfd048510a850a273195ac5d741c2548f2d
QeIUTx = 6c11091bc46f51266dcc735cd8232844d07009268bdafbafc2577d91
QeIUTy = 4597bf2b893ec8f47a4bda1c1386f0ac6dfce1b1b12a89cc9393878a
OI = a1b2c3d4e5434156556964c824c18b3d23eec491706a66a872d22aabbe327aaa30ca26863b125a0e7dfbcd6897783a
CAVSTag = 35d30f2c357c8418
Z = 684541f7e33e0f6b0ca49d7e9b7b6fe37c6c80fc050f3ae678be5b1e
MacData = 5374616e646172642054657374204d65737361676500e1ff94788efae21858ddb17b00b7ea
DKM = 23600d20003b34042546cf7400a9
Result = F (10 - OI changed )



COUNT = 26
deCAVS = bb750f2c281c2b4824d8b297e05548dc424e381148a6e3253f15d6b8
QeCAVSx = 97fc844f54bd493b5c903a7d2f4fa4258026ffc4ea934aef338d3740
QeCAVSy = 9b92446d97fb3bca43b1c861ad8240f102f0e9e2f9ac4ef079c05f05
Nonce = dac6f8b1092c33f985fc2ffbd92c606c
deIUT = 14ce8ee8606e6b062354fa81eabfce54e3a438bd2f2362932c16ce4c
QeIUTx = 1ed1516885e56483299e1a115a7775765cc75c79250325ddc594f886
QeIUTy = b8c42b67e2debcc4fb07e0de3243a3470ca958c75f030258f12f25ba
OI = a1b2c3d4e5434156536964770855e292695e86a575b06aad816217a0fb341c5e962255e5a7396dc5cfaaa2d5db1dc8
CAVSTag = b97942aa943db50b
Z = 00081b453df694f007f93720018158cfc606731ba036dae624eb6d69
MacData = 5374616e646172642054657374204d657373616765dac6f8b1092c33f985fc2ffbd92c606c
DKM = 87774cc52500997b132f232cbf4a
Result = P (13 - Z value should have leading 0 nibble )



COUNT = 27
deCAVS = c53bfcf20b83eed1e678565ae568299a9cc151b3d11cb1002aeae394
QeCAVSx = 78f6051f004a3d4b93d284adadb3a0cb2a430f8ace8bdcc9a09c03c7
QeCAVSy = 65410e4a6763252356b55e618b8df1b028b076c0d3d4f958a07fb73a
Nonce = 02f5157ce7f64b7275360bf3f6ea89ec
deIUT = f4b1754097fa5632868e781321d597d229fac2a48157ebbd0e577a26
QeIUTx = ae73c378e7151ed26c8de4cb7746b67fab0ac9bf40d0bb9f6badc884
QeIUTy = 749926637aea47c75d264d7df9fae54fbcc1a909c3db78b420e45bb8
OI = a1b2c3d4e5434156536964782949bc9c479627ad5cbad3a0df5f9488e263a152f22d99b23f3dc35dfd079a79090289
CAVSTag = 7038a665bca4bd5b
Z = 6436e8d6c9dd8b7c1798d5df64e382a1d78bc186d34d6c05d515757b
MacData = 5374616e646172642054657374204d65737361676502f5157ce7f64b7275360bf3f6ea89ec
DKM = 0b9a9d27fa9eec2c77ee34bd78e0
Result = P (14 - DKM value should have leading 0 nibble )



COUNT = 28
deCAVS = 870122b2781827b9a4b901fda28a0f3650b471437969a1078c3a82df
QeCAVSx = 2cc227ba89ca3bd63071e21da2726f74d192bfa32bb48942419b6198
QeCAVSy = 958ec4e140741f834481be2df7e93bd126dac7b7dbafb00b5cbf4a14
Nonce = dae6da638a04376671b81bfa3a161cec
deIUT = 354c3307eade3719e5afd259040abf3a302c8fb7ef478afbe8c92287
QeIUTx = c2b841a7c8b2d82cdca7e10fdbe28d95d12fde8822f0eb036823fa1e
QeIUTy = f850d6c765ff6c3f1b043063e15287cb99f1ea43e388aa8758e79ca2
OI = a1b2c3d4e5434156536964c55194cb1691786d7eaa7abcd328c9b95f4090753dac778306b66cadae92a3e6a8f0db80
CAVSTag = 251e8832694fe066
Z = 0f3b1a8b4577dac6618e0422baa2871a0d5e154a6f4e88a368507253
MacData = 5574616e646172642054657374204d657373616765dae6da638a04376671b81bfa3a161cec
DKM = a39b6a1a5159eae52d42a612a919
Result = F (11 - MACData changed )



COUNT = 29
deCAVS = 368628a9e1d9ac25d93ad990868aadcc56c910903633febb0bdbad52
QeCAVSx = b6f46308ba57409d7160491f79a80b0d008d88e012dd62ebcf2b7f08
QeCAVSy = 5235d0ad127ffea270297a1732f248e530688dafbc4957b3c0fc734b
Nonce = 299f0dc44c9f15d1f28519e6943774bc
deIUT = 0419bc209119b22a560b76570032cd701c6ca37bdb821746b764ea49
QeIUTx = cfe5f82b0e428e8de3e4e4c1c15e9aebc74a732886848c701ae80c92
QeIUTy = f29c50324dd64167450f42c1fd01fcfc7e9366e0b591eac03dc0910d
OI = a1b2c3d4e5434156536964845af152733a97dab139a9b42de19e512ab7f3043564c3515a149867971c81eb91df64f7
CAVSTag = b05a7cf526d19b30
Z = 4fd0115d2232d09cdb7b32fec928efaf1f36913d1567872aa8061be6
MacData = 5374616e646172642054657374204d657373616765299f0dc44c9f15d1f28519e6943774bc
DKM = ebaae2552fdfed183da784a35e62
Result = P (0 - Correct)


";
        #endregion kdf file

        [OneTimeSetUp]
        public void Setup()
        {
            _unitTestPath = Utilities.GetConsistentTestingStartPath(GetType(), @"..\..\TestFiles\temp_LegacyFileParser");
            if (Directory.Exists(_unitTestPath))
            {
                Directory.Delete(_unitTestPath, true);
            }
            Directory.CreateDirectory(_unitTestPath);
            File.WriteAllText(Path.Combine(_unitTestPath, "KASValidityTest_ECCephemeralUnified_KDFASN1_NOKC_ZZonly_init.fax"), _testFileContentsZzOnly);
            File.WriteAllText(Path.Combine(_unitTestPath, "KASValidityTest_ECCephemeralUnified_KDFASN1_NOKC_init.fax"), _testFileContentsKdf);
        }

        [OneTimeTearDown]
        public void TearDown()
        {
            Directory.Delete(_unitTestPath, true);
        }

        [Test]
        public void ShouldReturnErrorForNonExistentPath()
        {
            _subject = new LegacyResponseFileParser();
            var result = _subject.Parse(Path.Combine(_unitTestPath, $"{Guid.NewGuid()}.rsp"));
            Assert.IsNotNull(result);
            Assert.IsFalse(result.Success);
        }

        [Test]
        [TestCase("")]
        [TestCase(null)]
        public void ShouldReturnErrorForNullOrEmptyPath(string path)
        {
            _subject = new LegacyResponseFileParser();
            var result = _subject.Parse(path);
            Assert.IsNotNull(result);
            Assert.IsFalse(result.Success);
        }

        [Test]
        public void ShouldParseValidFile()
        {
            _subject = new LegacyResponseFileParser();
            var result = _subject.Parse(_unitTestPath);
            Assert.IsNotNull(result);
            Assert.IsTrue(result.Success);
        }

    }
}
