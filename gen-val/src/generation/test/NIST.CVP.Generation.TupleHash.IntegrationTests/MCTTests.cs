using NIST.CVP.Crypto.Common.Hash.TupleHash;
using NIST.CVP.Crypto.TupleHash;
using NIST.CVP.Math;
using NIST.CVP.Math.Domain;
using NIST.CVP.Tests.Core.TestCategoryAttributes;
using NUnit.Framework;
using System;
using System.Collections.Generic;

namespace NIST.CVP.Generation.TupleHash.IntegrationTests
{
    [TestFixture, LongRunningIntegrationTest]
    public class MCTTests
    {
        [Test]
        [TestCase(128, "6dc13301be877363018fbbbddd779b7d8a33acb91ac0a42bb1653fdd3b43ce7e8aa259f3", "78885AF07438414574A07475222F7395AE5911966D7A19C119A8A06A1A0C66DB0B5ED71F18D2FC8C098FEBF96B964190921038C61A9C9A216CA725340ED7C4BE56CCCE0E104A30187FC7C611D0523DEE0D6FAEE491AB36B8741AADC2F8EEBE5335F1F6C7D01D61BC8DC91708D71E95689537F474556FF7E47D51BE1C0DF0434CDAD93C02DBFB4B6D9C0898BC198E6F002B5E190B4E79C7C966D030A248AB8A8A50B5303AF3933B2D77E9A23A4EF3A8F850B5B37527997DEEA0692EF5B3B38897809529A1A8A8A36D5717508A282F1E6B6C0C8550E0F462774BD831062FBD3331E480CAF676C070C0A8D4E6764D306C117E7182AF2546177AA16824ACE60B024AE83D0D571F8D4FC0801322712C47234BFC90565A4DA702EAF83D8A7BE944988E97A0210F3300FA3570B07F98FAA5F1931118AAA5A2BBD26DD0FE846A6ABC96E5865AF660B300FB731E51EC07C2BC1DC9F3238546DCB5708E4299FEAB9D72BAC09C4EE5699028A4827C18F34853DA0E4F0AEA233AE8589760A46EA7E32AC713EC03EEBBA634C97F8F38B60B8A12680B0E16D28EAA7EC20B5E9BC32EA0728B973DFF9AE11E124CFCC8872478D73B26EC045213030179939387E2140311224E72693337AD1BA470A572A082182A124D991B74A8AEDC588A4ABACEB1B7831BE1C86160A48CC18825A735E0917A740C7BB3311E0F3AFDEB3AE6184DB756D5C17581BA042C5034D2BFEF3D6975196B17D4AC46E8EB49A13C90681F05188CC01B9C24D2EBDE2947E7E668BC9893FA1FA2C1D4F2B201A5BA5EC5B579E2E3916143BDD6CB0675862ABDAB67F384D2A10AAFE835C5EC0DBFDE7AA508CE30D15776503D17E08D4892022ED37FDB2D594DE72D73490B632088E9BE05FD760BA66846E36DFA5F7A4F5077FE626A101CB3182EC9ED7B9CDE25DA6E5F7CC625E2854F8EE1D743F5E772807C5476CB65BBFB11F3C04F4DF9953DF4F6C7039B9AD12C3774F64AB8288274149C4A503A4F12BD50FA22E338E19A06D77BB710FB64A1B27C8B07F57E74FB55A7E083920613018B94C8FA7984BFC415AECD78775334919C03AF4C8276962446B549E3E9116AB7403A0DE386C76457B8DB8F66E5938C22B8367261863792E022D39A2CEFB77FC76CE0913B5E2CF40A9E6987010228A12E1DAB4FBAF272E9B13A663DD2CD17F6CA01316A56321EECA6CAE90C9EFC8B635E6067E72623153F3C35C18E89323E47B35220C7D40DF2A4F0E727B6517365035D0FBB69237C95E6FA5AB2EAAEAD9D7567C65F200B940D095EDC707740EAC342A7A025B52E77425DD81CE2978F30DEDF5EA2BD8D1D00BBD1F5B36756B9421555B124DFF5823A2BA46565E54A9953C7E284886548E464E18F9CCCED24D12E3B2B527038A2B46079B2BF6911CC133A75C034494664FCA9F15D3CC5B388A4EF307BA39350DE8C909B726F3C12F8761F73E7C16E364DD2B2F73AB5858E04671222346FA97E92829888736D988DB915029B0C23026886746CAB079FF4FDAD0FC3E773F5AF9A68F8AF3733FC2570B6AAF99576B74010232992388EAD581826FCB4E0CB0986C26FD548EA4DB14E2069939BC1862B50F94E65E232A628DFE1089038315304F242F7BCE0B20C16DF3061A84F7D42536C9A2A2EC2B09A784CDDA69ABB510A02EB5843DF993F790809E91F72DEC845E3FE800F2EB644C60846E5D311F1E27873D55B79E98629AACC69489BCC2CD346C4420A791520ECCACE833891ABF0A4644F01241382FC617A28A8DA5A3419A07992E40080050B9796063B6A01314C8B9A434900CF3E493BD6A09AEBBE91A7AC3BB06BDF2C9A3A999B0DA9A355947AF9231FD073C7749AF6EA2D4097B381B18122DED1FA74DF7D39080176D28F3B0D98371750C297B386383369C75A7B7CEE7DDCDA0CBF594E6D67BD45A19A75F3FF3091266B26CD431AD0B6A3563CF8D1E0E53BDDFCAD27346CE290DE802569BC1995586BD77BAF036A09A6908432BB81EE36A18AAC3BFDC7DF3E54CA8366E40C5DCDDAE3C586AE7023F3C8D2BC9830F64599DCFC7D5B90028C151DE5946AA03C8B56214D8C6B1DC3BAA5736C376DC6F01D78BBD817925E5E21AAA5840DB7429BF2494864F1EB9D06FF4A91D1DE006D1A195C3FEF4627689139AE2A1C9EE2D135F2883EDFC4B55FBE0DA2EE343E6C6FBAC43CFA6BA59020593774736A8AAB790BC725E42C4C1062FCE9455A263FFA026FFFA61DE55835D1998B85EF9368917710F53786EFFAF09C0CBAF3F378F5EE21C29BB64E56D302D05CF00F802F90B6886083F1AAEC956B4BF006C0A0F88B784B9972833742EA03E272221E3D34D9A211FB9099BE3AA44433569E03D0BACBA3F161599A3EFEA5C76DDC56BA6146B2C44484E1D55406B3EEA770DA2AF548A2310334396CBBC36176CD8A241707519E729BF354CFA7097F088B39380D823EEFC15D0960982063234F56BF8FAA1FFB505B9AFD6C9A74D5044FD0F279EFA792347EBF042185D29A2E26A9C1F55C09E886EE336E976DDCA86E6839A393E33537EF4C761D9665E2E19B04FD345D14954926C9D042301A01037C428790D0BCB7BD7F89A3D59469E90A58062ED14AB52D2469417DCDA83D5F9AEF04FDEF95565A76B9E0F08821494A0566837D04098AA13EAC0EFBCDBC1E3DAFA37B03DEDAC7991D5352BE5B7C20FD8569DB16F4569A410BEF2F72DE799E0C443F05A9F2064AFC705381685D9B8EC3197B04C931D39CF3BF3F2791AA37E0AE4F07D1ACBA13F08BAD4D3F55FAE84C5EE387C10D5656D9D5E48AC4D8E6B3D01AE18C6E396F1BE2CE738F37035AD114076A5441E998F2031E3D5B2B450C0D602E28A1375716D54635091E66675C99A1AAC5C55D0F7EBA2DB2759861FB421E00BCB8BACA0A3384B7F4952567E717D8D77C17278297FABB85AB3B3CB3F9BEDEE0BE5C5E6D1DDE66BDBA38F1D87276A4F7F8981915155D425455CE85D6C80B48D5586DF4A3431D46272D3751653965F44DFDC5700AC7338DF9F4D7AC0482888DD2390A2D97640E47EA1B460D8CC845B912B9B491A146AEA49203F770D7CB8CC2607248BA2EFDE95E4EB604DD0AA728D960180E4B0EA17C2952EDE4F31F94F37A6A68029364824E3AFFC838E2AB701FC7337ABF19A42AC3E1CE8F9600B9A67F653303E014E9B6E3EB28B09EA8E24494430262B1E97B92332E62266B0C92A9F7353E42A5AAFB587FD892306A73C07609EF68CCA2D46B6861363457E24B9EE3CCBB5E9FB03219E7C0E181B7EE6F30C3843B5085D2557F6F303E1AC57661AB654C7225E67F263D77E466962BAECF057CFA6A682A6AF30A40A2ACD0310BE9A0CAC69E390FF119155BC2379056C176A5730B9389BA43E69AFF454BA725FBEB44EE3C017BA2615EEDAB7925FB10645420705C0A8C0F99FC86AA88E15B2B23674AE4809EDCD9F3B350705638A0C2C0E90AC897B2888A9952D319938CD3C121CA9691289F337864860BDD280C7EBEAEDB23E41028E5F4E9D28E70B48493A1B7D9903EB2F6E0DD9C9264C2C10462958824213F0840E8C7EEFBC81F3E0FE9265956C308EE69930F8B1B81961C97EF26EE4FF2FE19782EDBD6C6B8ED74E09137616148602A374E50EA97977CB556983B11FC0AD5575085B1F5CA113071372B357D5A96AA6E281E028C7881E15FBB1B4E1FEEC023D9A1DC7E2F27F25F9AFE999B888271340EE9BF4224916CC434ABE41574C2483BFF96096722BBEA50A873113415A2A7935B5F382946C2A0BC6B4D7951730FD3C0E7740CF6FA13ABFB714DBCC45DA2E379D9ABD8653A9329A4F26C94FCA951B5C65ECBAFDEE4D358EC33A7C0067493AEC47C3429EAF17FBC7EAE0E0C1118DAEA608BD6FD5B2C6CC97DEA092D4DC091158C69D9D49F1E2278383C8C7A425A6A428D392BFF57A50A871902D9B0D5548F90A891D6C1450B480318161B7FEEF52606267C153F452A77FFDD562373CC6273053AA0FC0AF11662B7E4A1109F106E94F6FFB8305E94B4D951BB761B736D7A9367390021B51AB562DDEB55218747C2E682FF87F63846CE4AF7AA10480848605E56224B050B8C2B61359C7E8107152BA3F226B0CEDF421D80A4872918F6312EBCC2467F5AB1870CE438B997A299B466E4C4764A07A78AB943DC3F53DDFB5C6D86F38A9A6120265895F100190E45CEEDC90CED977B033F3C341CEDC9537E4FB0C6F897D38A16DE359A5A7BAABD44E02B3BB3EF14FAA03C2DF400489D67A72DEAA655D767BCCFC022C2526BC82F58D68B1A79A86E97275E59E24B47DAB2DE17C6A4F61965F6CC3B4D304670008B33DC1ED47FAF2FB5A9CC43191587D792F27EC339EFCF33C0C6CE14610430EBEF71C6E7F91EA775EAB7F6EAFFC158BA4E7F20625102D5766137B9956A3F224A9053DF85CB0401FD8895BC7C1E81FB628C67CBD1EC6C8334C965A2C6949A248AD00C441886532E6E8B5072655C2CBC988D1F9F90FC28346326F4342183AD7104451A1C5799A10F7C6344518DC4C6E095A1EB44AA8D765377E21CFB4EFBA3ED0B3814C25C0F613F4D000F98356AA02D3FCD863EE7DE7E36E80D17F382EA4AC756EAC894F392C673826B869BA7E932F72275D6658093F97E9D22C207B97C310A13894F3092F887B6B86A53DDD351E4C2D70D8123CF173C511BA180050D0C3BB1BF686CFACA0BFB6E9FB8DF4D8965FFD6DC19BCBB29671C8857AF65D560D31510FA46117CF0A22F6403679E53B8DDE023F5781BC1C6A7E9A4C5E98B8DE19BB8B45B4B24774B6435A8AE9B9DCCF6D3D444C73EE842796F210CDC071173B495D1377F3CFD03CF4CFCAA967554E52BC5F5C08CEACEDE66242BD9E994B2DF131D94082FD265093DF2BD9EC697A24EFC39390535DEAA5ABA70672B0F55107ECF8D73B32D022F7FE293949B4C132EFEBD1559E3BC37044C1A30389BA7A3D5502CB5909458FE8B49431ED3D4BC386BB8722130AADAE4FFFD3E5746A98ECD3C3748803636D6673032A8571A07796C55092AC0A758832B5D51FB203EAC0051FD73EE097567F01DDD1FC3DA571065796437B43C4C6FAFA784A11ABA3B04FCCD3A2D18BA5826638D9826AA834433DA400E596EA0E403CB3AE89B42A9E984A68FA05707FD149D026A6D9433AE6AC08280888C53F3E2BEC20AB8EDFCF36128F8A6FFDB27C8143E547278F513F739DBD519D9513AA3D6310BD13357FB525892BB1CB7DE8342DB577CC56FCD53290BF2B31F53F5AB5281495F6E1CB5488199FDE29100E2129F1D3CFB2214813F16E88B7F4C808CAD24A002BA472DE22B77873BB0C91E9B9AB91EDABAB571058DEF9F19693E093D54A03B93112E08A0D9E9491D2CDC57CBC856EB04C50D6F10537EBB583E8FE83914B2364530DE0730AB10745EC783F994F97A37B8E4457631845C7D97974EB76AF4DA906B6A65BC47051513C4400B0E60F4C1C87D9FE2E75C24DC049725B9B7021EB16C8399F3A2B5BA80D692DE01F4F8C5AFAF335EC0C1F06CA6BC041896F5591806D3E82E87B2950ADD434AE6CE8FEE81ECDF5735D04AB4071A9B9598639AF989FBAE77553A4943B350EAE10144556E78E239BF86B41A649EAC65561131CF4351CEEFB4BCB1D91E7E724D3B8BB7E2D4FE5425DDF42945AA07E696D4AF1C1D59852A59A9DFAD40E04A1F819904A726CF1D9978668A53AE9B4BB21F459581722469A108D45C465AB694720F884D8C4E9B2C59B8F8B31F69A012C1252CB7D871B40E7DB62F0FCF285C5A7615E52AB142C29FB369B503F8B1519EF715DC7D952AE23AD5671DE2BDB0D8F78D387C83AEE8AF2E8943C66BEFD5F3CC6D203BEC879B96E4454E01076976918790857A310A8516BFFC7173B3857B9F56CCBE75AF26DBA12CB2F77A7820C6BEB4E6FA97A488575FAC72324E199D462C05DC3C531D7ACC7B85A760745EA60344FA9A69D81F70DD245F25E5285E687ACCCB5473E32DA7FA2847B612889CDB144EBE3364A1F9EDD60E058FA920456ACEE4115DF45E8466140AC932B2387A5FC2675BE419383E64B87BBA4122044A76A5CA2B53F63D524BBB6471B9E9BBBFDA58127CEC99E458DC4AAA841823F070D92C5D1C56DDD778FD64D61F727458FEF75C2F7337BFB6B3F74EA1BA5B6C4FBDF349154A867F442C1342AB782715E80F7C354004263EAF827C7B512E595E38861ED5FE3C0E681FA7DFD68A8600783F5E3BF7875955C2488FFF1E2A", TestName = "TupleHash 128 MCT")]
        [TestCase(256, "acb91ac0a42bb1653fdd3b43ce7e8aa259f36dc13301be877363018fbbbddd779b7d8a33", "9752C132E5C9950A2CEAF8AC3FAE5F3C25F23A883E50D84032EB34E6545F0F5E6439EC58479AC3BE561BF6B68101B7A1C97420BA66B3C48F26102DBC0159BBEC143159D922F63E947C8AFDB2FCB5525F58F63E58AECA991D374147E9F6C8D5D77928EE9AB08C9E32DB56284DCD57B559022C811370B8D561D65FBDFEB9595E9EDA69425956927329EE442E1B6D0B598E35812D17A8D06F278F501B5A8582944A7AA3A187680BE684A3383D102DCF090DC4B8C41041D17513BB724C7F89CD7D98E7662B4E7D3CB6A1D5CA9D1911CE949F6F6050CB4B0027A3EB6C07316D4C43B8B255327D71F8E592636559A413C16BE6D177255CF26FD2451B57375960BD674FF20554454220993EECF9FCE1A76BCBFCF500938528333905B0DED551BCCF34C5B33B43D541C75590203FC96641E7EAFABDBCEC507056FED58454CD2A05B59486D7BCE0095FFBB8F0706D59E2D611871FCB9F41FB6CC7200F19F46EC79F3054E9E14A001A76CA72B94505AA0E7D4674A7D2655BA8A1974343C085E48375B4A8CE70CD7A8C0FC945774080E3F06129B8B7689DF98E2F9B40A7F6D2D91949875C19598C1F878AB359A76F12939B21E77315C053F32C3C6F95B1BBA534C16E536E60107F5F81746D59D0C6BCD5AE41E22D509C9F44D97653DB157F671CB1B75308AF02FD51A8A015A392C14C3A4B551501B103A444F26FBE48DCC175391CD7D9D469C652B5E5E22160448735D82263D9C203FB98A0B04991F9B422DD42BEC3D35B58CFD329B26725F63E00BBD0F65EB074E8EE6BB2107DA32F944EFA47E46E763F1A72E40A051D59AE2C67C9EA282A9027EAC497F7A4EEAF59FB0C98FACD7B1E8BA9FCC6B794074B9CD7DEC534B9EB8DBAC8474D081855BF0FC4640ACE92295E5CCF2E177460E56BEFD5B634DAD31FB1DC1EE79926EEE801286A7B9377AFDA412B9F92355575C5E88DBBA35402108C222CB9AB7C43A3740C084F3C9EB1CDC12F51E585A80448CC22111F04B925E18F3BF65EA788A05E2BD30DCD9071DC4C0E70A62E5E90B4C544B8BFAD4A2F360FC3495F0308C988998095C695C76DADDB18328FD46B21E7347F8EBA6B77D2B4B076B980EBE458EF723384AA9E4F6CE52D35A486B6039878E837F4C2BACB0991426B929061B0F0C04E7AA0CA908FC87C5D5C62CA3DE1C9025E1C65B8C651A2D879618F40C6C3F5C68F98C19EF24572F2DD8C7AA014591A0069AD89B44D6CCE3240EDD0D325B0DA5BF621989DE082BFF466BCB9B57FD16CC03D2B5E78D5CFF25ED87C794817BA18378A1CA189FB5C53F66EBADFE8CF67B7D449C5F2BBBCD2578DB914EF50508375D1B61D1EB034835BE3A458D433D65171BB3712A8436E596D2AA1A4D0F09AA7FCBC1DCCF3F242B0F77F2CCE636429A63F248787351861D8EA8FEE653803267F53E4E287CE069F5566C58EA085FBA5F8043B2979EB6E8E200CA4C6317DF66DE4E8888DA59177177F66C70B3B83E12918A0A2B4AED2C35F00AE3574AF8A920F4531A35201BEA542E14A27F02B4ABA9853B1DE0ED4AD83F0146D14C81D3FCB4407DDE97C3C735BB696EA2AB03FEB4B9A25D4CAA34FFC1AFCF8643F1C331F48EF7C4B9B528FA6D6B403935DA120143C98B9168E63FF358E7E7F3365D52D848102E1369E5F58801FBAA73BF877ED3693D5ABF511C25B172BDA7E736A881B1C0A2369E63708DC490909283405423DD59E160EE79790228129B04886A76B858D5D2443636000B5422CC8EE3C7201A99DC13AC03EDC50F9C2B662780821C0AA43E589C3D700FFCB67B8C84068086B7C7648764A92FC44D3DF151C5812D3E079EC32B3B6AF1BBC563EA954C7421AAEB1F311BF4A9D564172B69990B7703EC333523922E7F863A8425304E241FC51DF251C8AEC6F83E2FD1CAC2FBC90E929A901E5D3FE72FA4FAE3C0310C325BB11693C35026296371E050502ECEE79A6F57562039EDD4B5045D74A198E6FA29913E5E59FB274E40CD1C22BB5487CD0140A58BA6F4AFD497A2E76E803FAF851EC30D580C2669480EB19DE5F4C3F8131883BA5A50FAD40416657CE308B3B483D26D12C3E269597838B6FD65134600F8672D632A92B7670CBBBD8CA7971B1F6B448E8DA1B57697B7C2D358CBCBE6C79A16D29D710B4331E2F059927D9795ED45E62A1BE5DB720B664B2BB7E4C3231CED2028CC1C33023BFCB54C062C9A18A176C4C70407BF3F9F80A09841553E552A2FD0CDD0565061DFDB031F6D5067277CCE1C12B11369250BCC127E9BD476387FAA2AB824D4909F7BBC73011DE38FDB0708B3613211D7BC8F03E165D443D93B97CEC29B2DC8211B0C5953EFD537A36598A80401BC2987E8E017BB66E101D877F99960701003F9C5DCAF6D19A79B88695FA28E3177B4539006043D59142EFEE90B9BA011D30EEE6A88885718EB742621DC157FB3543E7E4F225A9886BDABED7F75A76EB5D8970D3DFB99A80477E6ABB36D421417F4F1FB870782F8FCFCE992CFA72BEF5A02B8018A11507E54EF9414ED3704CE4657746E9714FB5357647F6179C0FF232AD999A453F2B5B6679A5BD5BC5EFA48D86D8FD5B8E83201A3CE0C70E8FCAE6F3661F598E9BEBB4D070FC49D8C58EEA06FC61F4B7B57C579CD5B1B884D159FE8699977DCE81559E494C591DD9D82DBEE48FFA6673D670E0BE7EC46A511C9D1C02B881BE050CAC72504355364487F22D0624AFC6F87E10B1614406E946267E769024EEAD449E5D782F181CB80458ACEB506091FEF61F0B3ADAAD9C719996091B4BF52BEF487E2910AFB6C9B2BC87CC3D945632D4260BF080A1B0904599688290A860F81793BA2C9715AE12501C503C80E5666749452FDC032CFA827624F746272E2A41BE4888E3F4F82150818C8E085AB8DAE7ACFA634965628415D6CE6B9054420FA4F17F66D14E4A40AEC00C8F295F21523609EDE6AED2C087DEB088179F44589232A0720132BB89556A318FF106522A322D6A02FE33BF6D512C01B6831CAC8961C296B5DC3F4F2FA2F1C6411D29E3559BEC14D23EA7D0432A3CB52D657B6BEA935EA08295BD11E9AFE4697DE8A66FC7F90B5D44D5E3F8EADFB691D63239EC054E2B2BA0B1F4F7F384AC601C07BBDD4BE6474EFFC636198D3CEBDAD7A8665D6A7D1AFF5B3C59E4D76D240C15E7C88713C9667F05D0D87B102053ABC9331F404B8AC702783CF95ACC82CDD95C4C1E4E767BC97B13280DFE5AFF75D4FBDCDFA6AA1CB5F95B608B1064B4B437BBDA26BE0CBA045E57A3F1E9B881DBB4BDAA6A5C211C7F011D447E6351EDEE38F1238B87A1904180B3980326A0F70D2F7CD8E02859E581AC262A2A084A13F67954FAAD39136C1E27FBE2E7FCDA6B1687BE829E7C9D8E8C32E658532DD141E1A5105926A4003903E9047606B552CF85A91941FD603EA8854A1A4B068059FC3EEC411A5742BF609D8DF1A5C5250DF367DB78276DCE17747437537926B7713BD98A84A6178C1D6073491D80A086B443B2A7753B94D155CA4A89BE76412125CEFA228BB65C786E8012FEB8149D74DC8BDFE8C40B71695C80B251BCA26F41E5158FD50F2627F4508DEFAC81DC4E76E1C4DDEC6B8C74E9240341F91230A53258F89F4F6D7517A89B7FD1704CD5900F8088DFDE93B24418D77A5BB3EDC18D5B8F846336310C6AB15EE208AE0BDDFD7849DD00EB111D690FD0077ED339EDB21BDFD0F7E1E99B35037D20185E76B045CF058B6572EAEBA2A722C04C10EAA8DF1C34028B1C78BA0648B40F5B5E4AB9280F3913613A27769D0F1A0A5F849905591A877CB5F4BCF199F364DE7BE7DEE2F140D889A49CFB75A3CCEF57E11285EEA8471E706A474113767FF45F12E8EE1E2FA6FFC2CA015B1C27810B21C950F20318386C3E4FFBA5B138DA0E9811461CFA8BDA239CCC11CEF67E1C7B0AE8649646ED1BA5D3D50717DCD1B544F6AECC2838885CB853211793490F89A94EF3187BB6D5D0BBC4A46E01F789F2356F38256791A47329C6335ADE1AF41806ADE410C0C598D43C8385F6C4D01E1DF814BDE32FB293A2D3F76BFDE1A65ACF64B8A681E7091761798F003AA41F15ABE85839744708CC28169838E991372C59D861D160B6603DEC68FF2B7D98E82618602FF61BCD6299EE0017498785E03E17A432F50C078F6F3F489C29C11E93528C87835A8E11020F52D2FD1BF32506620100078E16097D0F6D3F053A29E5569739CEF75C9C08326B360425092E4943A7E719521C69EC754450EC3D88B49F2C73DF0FC310A5622255754689AA20BFEA8DA2CE7FE66B549A90AC508E1B933DDC22B64A3C0DE996FD25BD298B19E1A6FC2C0F2E56852FC13562B2472E67E7A799BFF62104340499ACA22A7643294E3C9391841E1DA5D7173D4891B569868DF28CD0EB8EE5F3C94501816D3A688C0D43397E91AA42BFF291B22B01EF6B587A3AB08C388C0E64334B586EFC433B34F4E016C6A03F137E01928340D1D196E76C3439ED676075C6C027776E418AF4ABED32181C8AEBF01589CB6B37BD0E6258C81991667D8A96BC9BE8712CC940D64B1F44ADAB3799D37E5B53767B20745BE1948F5E391B52A199551E0116E4876C0C4DD970DF21284D6B0AE9AAB36F8C64AD833011662F17596B0BA4271D07C024222B2408502F3B4FB7E494928F0EAD00B672A44AC1931C11FD61F837A1ECC697A10BFDDD9C495E69EB8253758C8A6CC3E04662C4230079EDF039D4BE1FF382076AA3B2166C1FAA3B5A4B8CE0150E5B91649B60C424C8E5F4F0965C63FD24BF8898496EEDAADDFA20B7B20D0212403C16158FCE952493F24D40B80BE20E9091473EADF4651B7BB3AD5F247978FF386BB2561A0F7F69B26782F3EC7FE0119B5D744DABFC66B134C365012CD56A21FEF82D59FE8ED3E221D73380AA4D74417976ECA3BE7324D5C04D6298B19A5CDA90A87C771E44625D92AC1F41607EF2DC6CC28E2B0CBE28089D79497A750F80CF61BDB815717F4B8B1920F924098FB8C99EACF7A8A8C8029B5A97F5F0BD50BBD762762E98D30FAF677A9F2A6827490BCBF8E37B04BB84439CBBCAE8BBB0FD6559C818B4176371FF75FF4856D40EE1CC80ACCDA5CA08DAF3E887AD88F88BFE0A2094A0D9C311710A76D9194E14E200FF80F840C99D22A6EA26E9786FCA1C0217C41E065B9764E71288C9BFFA3E26EF09C179C2CE9DDCBD08877CF972E59F75FB8592EEACCCEE8AAA6754329E8EAE65BB8A04134034F0FFEE7A28E5935A69F6886F1BAEC15B0293136B35E13E0F3257D2217E0CEF3FADC588DD5BC9904E097BE067275F4C816FDE16E9C0B8BAC8FF4C39872CE30AB20B41BBD789F251CA78CC264D662D84C9AE9AEDAB1B543560807099E8199DBB4405DC458CB02AE4B776E9C91F46EEEC469FB4CA45013C34A6461DAF9A4A15ECB009D544967CFCB7AEEA616EB0AC86B1BA7DEA79C21280F1AE7FCBD0E002F397A1509F16ED408C4C4D81947B69B6C280729F94D795E54E9F06A1A66A0D486941C69507A52210856926DDD17911E79F876A3569E189FC5B08C9080D16D814EC2AF27FB321CDACE285AD1EBCC94D302AFA6977B0B445FB2EFD64D9C5BFD084DAF6D495CBE4DA6F71EC16B565C485C9F9B13B2842D26B06EEBDEBE94C111BF85CF501ADE4F11C8DD8939A5D0683A8FD4A5F0C8FF4966B1F2E893752D1BDE9F5C5021DFEB959E3B36AEC54370C9AC3B26D08BD40028BBE3CC84D781201CC724A82B18DDEADB0D47FBE8BBE942C5F5DEC123DBCF6E1EAE817DF0E0CA8B3AB5C0F71F8139078E7535558BFA7AEACEC5DBCAB0FA1FBEC9A41690234E35E0F488AAE2D1E8EA4B6A1959DED0172C1C3289CB5E565AECB61F4D26AE5FB94F5B1DBBEDD523E67573D2ABC48ED19F8B5A7F1CD939779084645EAD57A908980F2054000283B110632749D9002362B494B7F9A1F297303C4BCEA1AF20379C7BDCDB32E9CA9AF632B16371D803C666F56CB6C9F80F653164AD75E2C5086BCB13D838016F01048685CDD15EFC806C74F903BB378A541C008D184BD9849DE0454AB569FEFACE941BCD3C35C139426072911590B05DA8C7F09274FEDFD7C0F2A847C040460CAC9E9039EF8CA30FC483713B15B250B103246415DB963997CDB76C679E11C9A72AF6EAAE856700B8426225BDDD60BEA793A23CB23C4A64F1EADE3F95C761E22D921B3F0951C1058C9A13727E2DEA6E9266D06CE0FC7432CB80DBB2532AD3A611B4D836627E03E7134FFC614767566CAECE88E1A62C07DDAB45207D08BAF8046A8F282178E51A48C27391393FD379E586502BA05B4E685A10696857E0AB66E41BBCA5512F1C4A2155840E3D3FA667CB701617F272E677E2F7FF57FA056EF032EEE65DF0A0EAEE133500298E6745D35F7F35795E541D64EE293A718C6F96A0D42E6D378EF06E6DABED36EBD9125F34546949C9DC5210D20B0215C449075B8F865609A5C7B356AB059EDFB9C95B36D14991A6D30409AC77D1D4C6CF19D0942E6AADDBCD4ABF5F50FAA630BC3ADE5E524B94A1BE61DF70069666496D1728A7315C04908D909A5D3EF79E57EE1DC1F2CE6B87F7448996955A84A34A79F928D7089169AC851F31D1363F6EECBD5330F651DAEF3D708B641CC1343C1CCE21A18931B27DDBE50A6D25E2272CC10CDEC81A73BD95F51F09071926D0DC82A8BFDA098E5848A07F03DD44178CC91A26F8F9F946E5BE6049AE57884260FABD3D4815F1DB795F9B4A6736417E9000E3FF2BBD8A5CB35215127F588A89ADE0E8FFCFF80366A36F05B99A43E687DA8DA7AFDCCE1B1B89FE7E45CF41A7B6018626223BC20B9573CCDEAC2CD0B864691F1B316256EB49227B7F7816761E3027EEE57FBE6622B1681FDBA87C55B68381E67A91D8E1231557ABB8CA563100F46C5EB1A21C6CB94275BBBCF167C5187E2A0877146E1B4136A19BE189C484F2DC4853FE1F5A1FA75C06049076EB0FD20DA09B483030B5CF0B4DD7CEBF61E9E63DC6116AA9437E894F341B899EB00FB72076FAE473CEDDAFF2F7C63B1AD2D519BC1E0BCF1580C308FCE8190FEF660EB2678D8A6D91B1E1A79B22DFEC8ECCCDA232C16BB51DCB5D607A6F68805323DACCCB4122701095A3F12334B77EF3E39C6ED002D681F65038F64969D85A3C3BBCFFCF9D620F6B25B445F84D4773E480CD100F0260FFC62C253553F092D6F0D802CC0539897904026AA77AB564AAB1CBF9EB181A175C3E630C2CECD7FEC592955ADF6E851EEF0584A9AA5D56F49000E5FEE1D74599B24D36FAA97448FDE62FD4F6B85ED6FE509C0800A16EB4130FD0D4D942BD349AED883274981D56AFDCED93C7C8AC6BAE6CA230B1F32C766711A975BF3ABCA8DC4FE4FB3F7E48780B149932BD602EFDE9AEBAE249C7C4926622623A1B7A6DA8722D2F69212F2100F91EE78AED8043FCD7BFB5702FC78989A1FD5A3F6F3B44309427656F8EE6CA3AE4A04500C0B41101730968463A8A8D4115C9F09516414279F1AAC84D86E615995A154753BB442BF4AF30C356F71FD3BE777F97546319BD964BA1029FBF11D1F87DDF5F22925198E1226BB088A668EFDCD2E7D17F69FD703A08D0CC1D630B19E3CA9EC913F6EE3AAE8037E564621EB5EAD9DDDC35087E29D8AA020999C988D1B70868EEBF6DBF45AE435977F9EA058C76FC0C98ED9A55AEFA8E152F089D9A11B798A196F7D0B997661B656323EF09CAE6DF32BA34303BD2D962F1FB25114A32EE048354931A5FD647389BDB8939DCC3F3E1B37E207BA9DAFAB496FBAF7D62853285D6C535F8A0EDDB191A25775547399F23A0E4A698ACD34DD081CCD3DCD88A7DC296F01075CD7AE38B48D7AC99382198DA536CFBB208418C44FE6A1AB5244FAFC5061C7110F55C228402C7EE0D21B87C9087CA7BE80AE775D426EDEF9B43F6EC5EE3A8F8382252F32F5F30FEAB95EDB23F4B8004E517F4F004AC3449E28C84BF13C2B344B6CC34A432DBADF29EE8F687BDE74514C5E5BAD15AA3D865C3B6B9048262ADA18B424CD292D2FDA2432D20BC351722F80D5D55AF5D139A2A281A95DF6592C93DA1F2071D09B17998FA7FA81408DDCC1CD705B210CAC1845BAC53846B75EA2085E60F492FC620C8CAAAABCF5914CED0F156916844F81CB592DCFE7E71EFE2A134BA4256255E9A66231EABABC872523D3D10A536077A428F3EACC77B7FE6D39B802C57817C53D125234B299DA2855FF8650EC7A76112AEB519E34D2C2110EF1FBFD0C51A871F62733DA1A900FCC10374E9816F91E4AD954B75F66390F02CFCEE0EB2F0C1B5797976BF9F987A59DEC03B2DCE0B4EE8BEE6EFC849191AF14D793ACD304283CA7BAF43447E7F7351A0BCBD73BD24779FA4CE47E8B728BC823D5DD83D5C77340D1AF4F24CA34381AF4CB386E388600A7B5D360438240DB94C2C2C5807A2CF4273D9A100266E88185D3D10FCCE534855E7E7B3419D97CEA0EDF9DEB81458827896F4CAA1CFA473026B3F1D8C1F5A59540CDC193369597722150FFB8E9DDCF57ED292F0A36421024E590F566B9B428073333E25FF372E59DCAAF84B2AC9EA9CF6AA8E5E22C2C35CF964E4AB79840C451F115CE91BAC0E224C7B343E5D0F66DCB924D35D1C4D0A43DBDD6DD3426981254DEB94B3ECC45D2B3EEEA345CA0F20E4B13D4EBEAE4B8620A0CE543B5E407FBD66BB074AE6ABCC37E2769366B9184AD27BFD68073EC29B56FA54320F97A884CDC02A9CB6582E8139C261EFDD281339D1F5F82D2A2419C06E81ADFA879AF325C6FCF57BDA65F2291A3E55294BA5C5180F9DB5D71DE8747EA17996418CF8749B956FF65FF43D571D7A6D98E12B09DB8C771DD493508D5885A", TestName = "TupleHash 256 MCT")]
        public void ShouldMonteCarloTestTupleHashForSampleSuppliedCase(int digestSize, string message, string digest)
        {
            var subject = new TupleHash_MCT(new Crypto.TupleHash.TupleHash());
            var messageBitStringTuple = new List<BitString>(new BitString[] { new BitString(message) });
            var digestBitString = new BitString(digest);
            var hashFunction = new HashFunction
            {
                Capacity = digestSize * 2,
                DigestLength = digestSize,
                XOF = false
            };

            var domain = new MathDomain();
            domain.AddSegment(new RangeDomainSegment(null, 16, 65536));
            var result = subject.MCTHash(hashFunction, messageBitStringTuple, domain, true, true);

            Assert.IsNotNull(result, "null check");
            Assert.IsTrue(result.Success, result.ErrorMessage);
            
            var resultDigest = result.Response[result.Response.Count - 1].Digest;
            Console.WriteLine(resultDigest.ToHex());
            Assert.AreEqual(digestBitString.BitLength, resultDigest.BitLength);
            Assert.AreEqual(digestBitString.ToHex(), resultDigest.ToHex());
        }
    }
}
