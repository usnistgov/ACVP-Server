using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.InteropServices.ComTypes;
using System.Threading.Tasks;
using NIST.CVP.Math;
using NUnit.Framework;

namespace NIST.CVP.Generation.SHA3.Tests
{
    [TestFixture]
    public class KeccakTests
    {
        private readonly int[] _rates = new int[] {1152, 1088, 832, 576};

        [Test]
        [TestCase(224, "00", 0, "6b4e03423667dbb73b6e15454f0eb1abd4597f9a1b078e3f5b5a6bc7")]
        [TestCase(224, "C8", 5, "FFBAD5DA96BAD71789330206DC6768ECAEB1B32DCA6B3301489674AB")]
        [TestCase(256, "00", 0, "a7ffc6f8bf1ed76651c14756a061d662f580ff4de43b49fa82d80a4b80f8434a")]
        [TestCase(256, "CA1ADE98", 30, "C8242FEF409E5AE9D1F1C857AE4DC624B92B19809F62AA8C07411C54A078B1D0")]
        [TestCase(384, "00", 0, "0c63a75b845e4f7d01107d852e4c2485c51a50aaaa94fc61995e71bbee983a2ac3713831264adb47fb6bd1e058d5f004")]
        [TestCase(384, "C8", 5, "737C9B491885E9BF7428E792741A7BF8DCA9653471C3E148473F2C236B6A0A6455EB1DCE9F779B4B6B237FEF171B1C64")]
        [TestCase(512, "00", 0, "a69f73cca23a9ac5c8b567dc185a756e97c982164fe25859e0d1dcc1475c80a615b2123af1f5f94c11e3e9402c3ac558f500199d95b6d3e301758586281dcd26")]
        [TestCase(512, "CA1ADE98", 30, "9834C05A11E1C5D3DA9C740E1C106D9E590A0E530B6F6AAA7830525D075CA5DB1BD8A6AA981A28613AC334934A01823CD45F45E49B6D7E6917F2F16778067BAB")]
        public void ShouldPerformSpongeFunctionOnShortMessages(int digestSize, string inputHex, int length, string outputHex)
        {
            var message = new BitString(inputHex, length);

            // Need this padding here because SHA3(M) is actually Sponge(M||01)
            // Input is gathered from SHA3
            message = BitString.ConcatenateBits(message, BitString.Zero());
            message = BitString.ConcatenateBits(message, BitString.One());

            var expectedResult = new BitString(outputHex);
            var subject = new Keccak();

            var result = subject.Sponge(message, digestSize);

            Assert.AreEqual(expectedResult.ToHex(), result.ToHex());
        }

        // Semantically this test is the same as the previous one,
        // But this distinction is important when diagnosing problems in the algorithm
        // Also the messages are 1605-bits of 'C5' repeating.
        [Test]
        [TestCase(224, "22D2F7BB0B173FD8C19686F9173166E3EE62738047D7EADD69EFB228")]
        [TestCase(256, "81EE769BED0950862B1DDDED2E84AAA6AB7BFDD3CEAA471BE31163D40336363C")]
        [TestCase(384, "A31FDBD8D576551C21FB1191B54BDA65B6C5FE97F0F4A69103424B43F7FDB835979FDBEAE8B3FE16CB82E587381EB624")]
        [TestCase(512, "FC4A167CCB31A937D698FDE82B04348C9539B28F0C9D3B4505709C03812350E4990E9622974F6E575C47861C0D2E638CCFC2023C365BB60A93F528550698786B")]
        public void ShouldPerformSpongeFunctionOnLongMessages(int digestSize, string outputHex)
        {
            var hexString = "";
            for (var i = 0; i < 1310; i++)
            {
                hexString += "C5";
            }

            var message = new BitString(hexString, 1605);

            // Need this padding here because SHA3(M) is actually Sponge(M||01)
            // Input is gathered from SHA3
            message = BitString.ConcatenateBits(message, BitString.Zero());
            message = BitString.ConcatenateBits(message, BitString.One());

            var expectedResult = new BitString(outputHex);
            var subject = new Keccak();

            var result = subject.Sponge(message, digestSize);

            Assert.AreEqual(expectedResult.ToHex(), result.ToHex());
        }

        [Test]
        [TestCase(0)]
        [TestCase(100)]
        [TestCase(1605)]
        public void ShouldPerformPadFunctionForAllRates(int messageLength)
        {
            var randy = new Random800_90();
            var message = randy.GetRandomBitString(messageLength);
            var subject = new Keccak();

            foreach (var rate in _rates)
            {
                var result = subject.PadMessage(message, rate);

                // Ensure the length of the resulting message is a positive multiple of the rate
                Assert.AreEqual(0, result.BitLength % rate);
            }
        }

        [Test]
        [TestCase(00, "A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", "0405050505050505F2F2F2F2F2F2F2F22727272727272727E8E8E8E8E8E8E8E8D2D2D2D2D2D2D2D24E4E4E4E4E4E4E4E747474747474747488888888888888887272727272727272E8E8E8E8E8E8E8E887878787878787871B1B1B1B1B1B1B1BC5C5C5C5C5C5C5C5E2E2E2E2E2E2E2E2B6B6B6B6B6B6B6B68E8E8E8E8E8E8E8E70707070707070708B8B8B8B8B8B8B8B7272727272727272474747474747474739393939393939397272727272727272000000000000000039393939393939394242424242424242")]
        [TestCase(01, "0405050505050505F2F2F2F2F2F2F2F22727272727272727E8E8E8E8E8E8E8E8D2D2D2D2D2D2D2D24E4E4E4E4E4E4E4E747474747474747488888888888888887272727272727272E8E8E8E8E8E8E8E887878787878787871B1B1B1B1B1B1B1BC5C5C5C5C5C5C5C5E2E2E2E2E2E2E2E2B6B6B6B6B6B6B6B68E8E8E8E8E8E8E8E70707070707070708B8B8B8B8B8B8B8B7272727272727272474747474747474739393939393939397272727272727272000000000000000039393939393939394242424242424242", "1112929292929292DCDCDCDCDCCCDCDC00800000000000000282020202020202AD2DADADADADADADA8A8A8A8A8A8A8A8C2C2E2C2C2E2C2C2AFAFAFAFAF8FAFAF9999999999B999996D6D6D6D6D6D6D6DB6B4B4B4B4B4B4B4DEDCDEDEDEDEDEDE1C1E1C1C1C1C1C1C02000202020202027676767676767676B8B8B8A8B8B8B8B8BEBEBEBEBEBEBEBE4C484C4C4C4C4C4C0909091909090909CCCCCCCCCCCCCCCC0E0E0E0E0E0F0E0E0000000000000000B6B2B2B2B2B3B2B2E0E4E4E4E4E4E4E46F6B6B6B6B6B6B6B")]
        [TestCase(02, "1112929292929292DCDCDCDCDCCCDCDC00800000000000000282020202020202AD2DADADADADADADA8A8A8A8A8A8A8A8C2C2E2C2C2E2C2C2AFAFAFAFAF8FAFAF9999999999B999996D6D6D6D6D6D6D6DB6B4B4B4B4B4B4B4DEDCDEDEDEDEDEDE1C1E1C1C1C1C1C1C02000202020202027676767676767676B8B8B8A8B8B8B8B8BEBEBEBEBEBEBEBE4C484C4C4C4C4C4C0909091909090909CCCCCCCCCCCCCCCC0E0E0E0E0E0F0E0E0000000000000000B6B2B2B2B2B3B2B2E0E4E4E4E4E4E4E46F6B6B6B6B6B6B6B", "23ABFF282F1F4FBF8C8F3E08AE5E44BE4646C7E55707654FE8EC6849D8C4EAC0DF5F1BBBDB57DBD3ACBCDE5EF68E9E9E9597D7A58FB78786BECECEC8EEC24DCE01D1B59D91E7406055A6A020AC9A85247EF72F5C6CCB7C6C0EC80E4F6E4E7A4E9EDB4ED4D7DFDFD9A8AE2B8988989A3C8E879F9D8F8A8D09FCCDC4DEF4A46CEC587C725C58185C55F15749F433737F723D292D98283929190D9A998BAA9B9B9326C4ADADA53925A532F93979F97B797F0529AC7939BEF1B98BEE4B8F8F9B860E3683DE98D0C4D1D2")]
        [TestCase(03, "23ABFF282F1F4FBF8C8F3E08AE5E44BE4646C7E55707654FE8EC6849D8C4EAC0DF5F1BBBDB57DBD3ACBCDE5EF68E9E9E9597D7A58FB78786BECECEC8EEC24DCE01D1B59D91E7406055A6A020AC9A85247EF72F5C6CCB7C6C0EC80E4F6E4E7A4E9EDB4ED4D7DFDFD9A8AE2B8988989A3C8E879F9D8F8A8D09FCCDC4DEF4A46CEC587C725C58185C55F15749F433737F723D292D98283929190D9A998BAA9B9B9326C4ADADA53925A532F93979F97B797F0529AC7939BEF1B98BEE4B8F8F9B860E3683DE98D0C4D1D2", "C66AC1D2E2CACF281631FA1F613359AA16FC2EE89374BF059D8E9EE869CF78C038C54F4C29A88F96E0826B62FC90B29730654441938125E9EBD7E1319CF0E290839DA47C194EFA38A2776468016647BED95B1B7B9DE384B8218790D44733CC77FBA023AA92444EF310DD2C9676250BD5360E0AA77ACEA1E02A6F84C6AF2F921AD266F0C39BC6570CB022A89FE107FF90ECDCBDC5E0F1904A99BFB0EE6DDDA72297FEDC68186E318190AE80E890654668C2388EC9C79FB8E18D94F9D1DDC701FEF92C48B4D74AFE03")]
        [TestCase(04, "C66AC1D2E2CACF281631FA1F613359AA16FC2EE89374BF059D8E9EE869CF78C038C54F4C29A88F96E0826B62FC90B29730654441938125E9EBD7E1319CF0E290839DA47C194EFA38A2776468016647BED95B1B7B9DE384B8218790D44733CC77FBA023AA92444EF310DD2C9676250BD5360E0AA77ACEA1E02A6F84C6AF2F921AD266F0C39BC6570CB022A89FE107FF90ECDCBDC5E0F1904A99BFB0EE6DDDA72297FEDC68186E318190AE80E890654668C2388EC9C79FB8E18D94F9D1DDC701FEF92C48B4D74AFE03", "0732B6CB75101F217332AC7C9DD519963AD996C9DE0E9ACFB0E71100A778D6F1E7EC8D0FFABF614CDFDB260303E47EB5A0D788E4DB49654DB594F64B66889197B167ABB1D27345ABCB810FBC69096450F8030C9B46DC56117F1FED063F83029EA8782275E36800C8F3317550330EFF0B0A39F79BCECF9E7E531FA393BC7D8EBDBC7685F46D32FD905CAF5C977B23C399366F2D9A27C11014D6A143DBF1B65A60776A77DFB6D4CB592B0E5DF81977F635FD9C569C6A4D766DBB36FF013194E7D3E3BC723B4390E4CC")]
        [TestCase(05, "0732B6CB75101F217332AC7C9DD519963AD996C9DE0E9ACFB0E71100A778D6F1E7EC8D0FFABF614CDFDB260303E47EB5A0D788E4DB49654DB594F64B66889197B167ABB1D27345ABCB810FBC69096450F8030C9B46DC56117F1FED063F83029EA8782275E36800C8F3317550330EFF0B0A39F79BCECF9E7E531FA393BC7D8EBDBC7685F46D32FD905CAF5C977B23C399366F2D9A27C11014D6A143DBF1B65A60776A77DFB6D4CB592B0E5DF81977F635FD9C569C6A4D766DBB36FF013194E7D3E3BC723B4390E4CC", "EA4FC1B7A99BD16E32CCEACEC3135692B85292946A62D261DEC5AD57BFFD1ED93226A312A9DB93B033108890B322CD6EAE43E03F398AC9B464ED5D12738DC9FC5B66E8561F865FBE43D80F94FC3E14A4D7422FB665E14D34423D203D5E261894634AEEB50A637195D2A1D7EDBAF5C02410C05DDDCADE987DEEFFE5C4D0095AF27EDDD8938053F8BC7AC9145684400A260CEA4C7EEF70BB8CB23F7D9F80712A1EF962EFBB0D5B60B569B5CEA0C49929886F955C0C0D2EB4CA8E92C502624AB4088EE5167E7A5AEE7F")]
        [TestCase(06, "EA4FC1B7A99BD16E32CCEACEC3135692B85292946A62D261DEC5AD57BFFD1ED93226A312A9DB93B033108890B322CD6EAE43E03F398AC9B464ED5D12738DC9FC5B66E8561F865FBE43D80F94FC3E14A4D7422FB665E14D34423D203D5E261894634AEEB50A637195D2A1D7EDBAF5C02410C05DDDCADE987DEEFFE5C4D0095AF27EDDD8938053F8BC7AC9145684400A260CEA4C7EEF70BB8CB23F7D9F80712A1EF962EFBB0D5B60B569B5CEA0C49929886F955C0C0D2EB4CA8E92C502624AB4088EE5167E7A5AEE7F", "E79586300C6C86E815E05B94F062CAADDE6FAED745000A8B3633AFB31922C817BCB78223550CE22FFE4BE7764948AFE5ED11CA6B1A8CEB92C89A089E1770E99952D507F3C35846A540C36252CA623FAABE7AA9642BA86AC6AD90B46F612FB4402FC439C5A1BBC4579F6F659F5852D8235F458EDD20BB23A251739EF8E62AF0F37D96A9AB5FDBB4C2E8B0AA7F06327F7BA0558CFFE9CC27EEDF193F3098C3F99A3E9BFC12A53E7ED0033BE53CE29EA5A5DC9C3E40AC637C0D62EEC6594D475E1D95D8C45448D92CEE")]
        [TestCase(07, "E79586300C6C86E815E05B94F062CAADDE6FAED745000A8B3633AFB31922C817BCB78223550CE22FFE4BE7764948AFE5ED11CA6B1A8CEB92C89A089E1770E99952D507F3C35846A540C36252CA623FAABE7AA9642BA86AC6AD90B46F612FB4402FC439C5A1BBC4579F6F659F5852D8235F458EDD20BB23A251739EF8E62AF0F37D96A9AB5FDBB4C2E8B0AA7F06327F7BA0558CFFE9CC27EEDF193F3098C3F99A3E9BFC12A53E7ED0033BE53CE29EA5A5DC9C3E40AC637C0D62EEC6594D475E1D95D8C45448D92CEE", "D9EC06FF17AFA49B466E29F643F0EB6AECCCCE2B58FE67E181C2EF0D9F35DB856157C7DCC53FDE7669B25389BFAC18D91DB80186942B6F871D967BC77D6D6320CBB0D80642E11DFD062E0BD03AF757B8227FEE75F89CCFF751855EF782FFAC0CFFDE69830599F11FA5537BDDCC69544D22490644E951BBEEE9BFE3A7E443578669F498F4FA34223238DBBA6005D78F473BC3D8A846C56C3A10A663935B1988B5EB5DE6018F1193FDF153A3068D9E98D69A1BB083587B77A2DC8A49252EED47E150B56D6BD2C38CAE")]
        [TestCase(08, "D9EC06FF17AFA49B466E29F643F0EB6AECCCCE2B58FE67E181C2EF0D9F35DB856157C7DCC53FDE7669B25389BFAC18D91DB80186942B6F871D967BC77D6D6320CBB0D80642E11DFD062E0BD03AF757B8227FEE75F89CCFF751855EF782FFAC0CFFDE69830599F11FA5537BDDCC69544D22490644E951BBEEE9BFE3A7E443578669F498F4FA34223238DBBA6005D78F473BC3D8A846C56C3A10A663935B1988B5EB5DE6018F1193FDF153A3068D9E98D69A1BB083587B77A2DC8A49252EED47E150B56D6BD2C38CAE", "7E8E1324CC54656B1102A5083C43253F4EBCFEC51BE8E4C414E1EF92D450088857363A4CC31D3FA74DA18A11030DA9E21EF9DE90FC2A5CC2FC0E8575B9D3E4161D4924A25335DD87F1FF5C0A4DD9162E1C017690A4E3CEB8F8B665A2407EA462906C221AC660213DDA701D4383D498DAA390233CA766613916012863E3345B5F6ABF7E5C8C54C508D8763E33E52FFD43B18FFDFF24C8A93DC1215FFCC0A6285AB94AC48C2C97628F08CF650840AE701EAE736BD4DC6943D3E1653298EC13CA3EA5E5F5EA76554888")]
        [TestCase(09, "7E8E1324CC54656B1102A5083C43253F4EBCFEC51BE8E4C414E1EF92D450088857363A4CC31D3FA74DA18A11030DA9E21EF9DE90FC2A5CC2FC0E8575B9D3E4161D4924A25335DD87F1FF5C0A4DD9162E1C017690A4E3CEB8F8B665A2407EA462906C221AC660213DDA701D4383D498DAA390233CA766613916012863E3345B5F6ABF7E5C8C54C508D8763E33E52FFD43B18FFDFF24C8A93DC1215FFCC0A6285AB94AC48C2C97628F08CF650840AE701EAE736BD4DC6943D3E1653298EC13CA3EA5E5F5EA76554888", "5CFAB6BECBCF9CB20268AED4C808EE02E0B1C9A9F28AB0AAFEC406D48C206DD00CE30187BEBA1F43FD64B02301814031E0E5536DF0A69880D5BE961438EDFD53042BC62FD042A9ED6705485611CE569223863DA167C4C54386DA8DAC109B6AC4F512C52BA02DAFC15C43E8403D44BF72E0E74FFF8EEB96C4923B0C75FE2760BF4E5228277DF27C1C72819FF5E07C70F14629B6B7D690F883CCA10C8FAC5511773DF976E4A1A45422F5337BD90C2154C4DEA11FBCB695241E90C07DC55FB8EEA34072F5793F3C5C44")]
        [TestCase(10, "5CFAB6BECBCF9CB20268AED4C808EE02E0B1C9A9F28AB0AAFEC406D48C206DD00CE30187BEBA1F43FD64B02301814031E0E5536DF0A69880D5BE961438EDFD53042BC62FD042A9ED6705485611CE569223863DA167C4C54386DA8DAC109B6AC4F512C52BA02DAFC15C43E8403D44BF72E0E74FFF8EEB96C4923B0C75FE2760BF4E5228277DF27C1C72819FF5E07C70F14629B6B7D690F883CCA10C8FAC5511773DF976E4A1A45422F5337BD90C2154C4DEA11FBCB695241E90C07DC55FB8EEA34072F5793F3C5C44", "F4852F30C8E541A9809A958E596DD8B499C2E96E8BC4720DDF6C86943C6FD8F158164A6E80B85C8C2F6E8EFCE9949D931C744AC74D5ECC07EECD203435F37FC8CA629E93DF6D71EEAC53CFD8C10F990BFDD1A7EE239D44E9261CC01C130CC5E20858D46F9511DF90E3F7F3E99EA514A7BEC8540A258B027EE50DF1743C42E1B305A0BDA552B43990C8C8E0E1BD575B1BEB9DB62EBC46364B5B28A18DB4C925B25143102456FC17FE982FA062458D3B5BB641FBD81CCFDA8784FD7AA20B518E498CDC9A681FBB79D9")]
        [TestCase(11, "F4852F30C8E541A9809A958E596DD8B499C2E96E8BC4720DDF6C86943C6FD8F158164A6E80B85C8C2F6E8EFCE9949D931C744AC74D5ECC07EECD203435F37FC8CA629E93DF6D71EEAC53CFD8C10F990BFDD1A7EE239D44E9261CC01C130CC5E20858D46F9511DF90E3F7F3E99EA514A7BEC8540A258B027EE50DF1743C42E1B305A0BDA552B43990C8C8E0E1BD575B1BEB9DB62EBC46364B5B28A18DB4C925B25143102456FC17FE982FA062458D3B5BB641FBD81CCFDA8784FD7AA20B518E498CDC9A681FBB79D9", "288761E566844CCEFA781757B6DCCA3E4C9CB8DAB8B071C26AEAF51EB4A82EB1300F1EF94C2B412AB8D599DB1248FFC0819C2D30F0F3A5316E91D89A6DBAEE73E8CD6C539293876FF5C1D63173E7207027A568E8EEC72A64B9FA28D35280B44187E393B044028C163567AA800A2EDFFC223E0D11EB4F2473E4B206813F3BCCF73940210AD59D1E9EA85F43B7F89D2C16E57F2EE3D3CB54D9C8E81455B22FA7BEE3BA60C69BA9367E370696F5266401D9E387E56CB8811E9E108701762A4E3C1F2198BD00C08ACBDF")]
        [TestCase(12, "288761E566844CCEFA781757B6DCCA3E4C9CB8DAB8B071C26AEAF51EB4A82EB1300F1EF94C2B412AB8D599DB1248FFC0819C2D30F0F3A5316E91D89A6DBAEE73E8CD6C539293876FF5C1D63173E7207027A568E8EEC72A64B9FA28D35280B44187E393B044028C163567AA800A2EDFFC223E0D11EB4F2473E4B206813F3BCCF73940210AD59D1E9EA85F43B7F89D2C16E57F2EE3D3CB54D9C8E81455B22FA7BEE3BA60C69BA9367E370696F5266401D9E387E56CB8811E9E108701762A4E3C1F2198BD00C08ACBDF", "3D36CFD53D29FDFBD54B724488D84E115C71A8BE297C5EFC48C4EBEA45151F5C05F6F03713CE188A1B5FF512CED99D22B237EC083822B45FD9A13288AF3EEEBDADF3A9E566A5493A7115EFDFEEDCDC162EC516AEF6DCD22FFCEA0630145A7AD7AF4CD786B32924ACBDAAACE56B929D7A9C9EFC7C1275EE0B1D8447D850421670A49FBC9FC7C4E6AAE353A6D541716356A4ABF0B32F964DF111BEED93BE4F48E981AC8FB075B1F6327D7E3006351F6A8CFCF1FCFE0892BDEE348321DB4DC4660111011ACCE8188B1D")]
        [TestCase(13, "3D36CFD53D29FDFBD54B724488D84E115C71A8BE297C5EFC48C4EBEA45151F5C05F6F03713CE188A1B5FF512CED99D22B237EC083822B45FD9A13288AF3EEEBDADF3A9E566A5493A7115EFDFEEDCDC162EC516AEF6DCD22FFCEA0630145A7AD7AF4CD786B32924ACBDAAACE56B929D7A9C9EFC7C1275EE0B1D8447D850421670A49FBC9FC7C4E6AAE353A6D541716356A4ABF0B32F964DF111BEED93BE4F48E981AC8FB075B1F6327D7E3006351F6A8CFCF1FCFE0892BDEE348321DB4DC4660111011ACCE8188B1D", "D69AF29569CD0FE4706BF63697DDE0686D87C5626EE423F3AF62AFD8C2B51BA6D12770056D9350BDCC3DBEBCFF41653F97BC29991AE1A664B862C73B34F61CA04ED76BBD5E009AC2B4FDF36221810EF1166EE146822A421EBFB26D5C0ABBA9CCE60660B1EE26D7192FB243FF32FC910FBDBCBE13D6872F1D05EA7A204B32F00FF0ED5171033DB73D0E0C0E7016D0C5F654F8B887341A01F9980A57940DFB94E1396FF9568BAFA567244AF43EBEA8145672AE3FD5E73DB68DD34818DF915850538A1AEEE79403E74A")]
        [TestCase(14, "D69AF29569CD0FE4706BF63697DDE0686D87C5626EE423F3AF62AFD8C2B51BA6D12770056D9350BDCC3DBEBCFF41653F97BC29991AE1A664B862C73B34F61CA04ED76BBD5E009AC2B4FDF36221810EF1166EE146822A421EBFB26D5C0ABBA9CCE60660B1EE26D7192FB243FF32FC910FBDBCBE13D6872F1D05EA7A204B32F00FF0ED5171033DB73D0E0C0E7016D0C5F654F8B887341A01F9980A57940DFB94E1396FF9568BAFA567244AF43EBEA8145672AE3FD5E73DB68DD34818DF915850538A1AEEE79403E74A", "CDF54BE31FC5C10828C245D6C4AE8B3D5D383E85058852D4C3DAD63370BCE86EFDB4EC4945DFEF08480F2894C75B6D1F0DBB4D1DD3E801F829AE7083A11E47067BB59BB4B9964B2D5A406A7431278F74A15FF962AE9916CEE209D2E3000839787B111EB837310A737AF37124F5A6876BBD8CA9F60AA35CAB7D1B3749414A29FB1823F87FF94548536B4465172F184B8D9FF32A592FB4359C64C35DE4E36EC2091C68A7965230739633D87D1A85A731CAF1BA7D6B43C881A36B32F3D656D5B0340B82AAFD03057829")]
        [TestCase(15, "CDF54BE31FC5C10828C245D6C4AE8B3D5D383E85058852D4C3DAD63370BCE86EFDB4EC4945DFEF08480F2894C75B6D1F0DBB4D1DD3E801F829AE7083A11E47067BB59BB4B9964B2D5A406A7431278F74A15FF962AE9916CEE209D2E3000839787B111EB837310A737AF37124F5A6876BBD8CA9F60AA35CAB7D1B3749414A29FB1823F87FF94548536B4465172F184B8D9FF32A592FB4359C64C35DE4E36EC2091C68A7965230739633D87D1A85A731CAF1BA7D6B43C881A36B32F3D656D5B0340B82AAFD03057829", "237B36A3D76FD336AD9DA5B37F3D467D6695FE9AB4D30759F4D63F3F5E76F7EF1BB46D887641870DAB1A61900BEB41A5EFB87514AB993C4B2199E251E58F2E90AD6CEECA0B37CC652ED5E54174177D1AEDDBAF316D7B872188AA475C297CE272619DD21AF101852EEC97098CE06DF9AE818184D2017B73B246751C278F828055DD7CA60D121FF7F55538B2A4B6027ACE2720F939D083EF7D80035284937526955780782698FF6E10DFA1ED5DCAE9E78252A7411D54D43A29001024500A8B7998FDC41E4A3DD46C87")]
        [TestCase(16, "237B36A3D76FD336AD9DA5B37F3D467D6695FE9AB4D30759F4D63F3F5E76F7EF1BB46D887641870DAB1A61900BEB41A5EFB87514AB993C4B2199E251E58F2E90AD6CEECA0B37CC652ED5E54174177D1AEDDBAF316D7B872188AA475C297CE272619DD21AF101852EEC97098CE06DF9AE818184D2017B73B246751C278F828055DD7CA60D121FF7F55538B2A4B6027ACE2720F939D083EF7D80035284937526955780782698FF6E10DFA1ED5DCAE9E78252A7411D54D43A29001024500A8B7998FDC41E4A3DD46C87", "F839EE2A1DDB00677B9C5AF0D193A626F9FE79EABDF3E4E38A01AC12BD403F3B72AEF1118897FAE5404EA1F22C3958F5AB5F1744A74D2D60B02D2AD8584AA778C81D6FB95A49250974F880F7D41226F3C09904F0B27ACCA608E93CCFA5D7FA46BB25B8BDAC6B37CAB86604AF29F05587FC2003050497C8FC0063DD87A3A1DAAE7DBB3B71A71E9F19437AE494372E7183AF1DD52810162E3E8005B04B1D1CF6B3422F63A45FC109AA9FEB840FD251EB8EC6192670EEBD90CE49E7E4625B37E6E131CB2B3122E591D6")]
        [TestCase(17, "F839EE2A1DDB00677B9C5AF0D193A626F9FE79EABDF3E4E38A01AC12BD403F3B72AEF1118897FAE5404EA1F22C3958F5AB5F1744A74D2D60B02D2AD8584AA778C81D6FB95A49250974F880F7D41226F3C09904F0B27ACCA608E93CCFA5D7FA46BB25B8BDAC6B37CAB86604AF29F05587FC2003050497C8FC0063DD87A3A1DAAE7DBB3B71A71E9F19437AE494372E7183AF1DD52810162E3E8005B04B1D1CF6B3422F63A45FC109AA9FEB840FD251EB8EC6192670EEBD90CE49E7E4625B37E6E131CB2B3122E591D6", "62751B5477B5F1840B0368022AF7753C0A75F06E4196ED88508BEE31CDA0C7AD3FFFB2808D18506A6EF094B14E6AA531E082FE8DC7EBAF2898078E028BAD2A2C95442BEE18045182F9AE4B1DD9C8C91B1E2BF2EA1A51171BBF4C940E007F7FB98C4B3AB14F652FECA5E8C9FF166733BC42E9F58D59F4B83DF794FDFE5AABF4C8F77035C2C4210CAD3C6F9D6DCAF8915F4061655333E5C9FE027E3A040590E3AC3C94993C14C109E3FDCA7005EB9F0944AA325F685BC872013B3099531F7D3DB0EEC7E94ADC801C0A")]
        [TestCase(18, "62751B5477B5F1840B0368022AF7753C0A75F06E4196ED88508BEE31CDA0C7AD3FFFB2808D18506A6EF094B14E6AA531E082FE8DC7EBAF2898078E028BAD2A2C95442BEE18045182F9AE4B1DD9C8C91B1E2BF2EA1A51171BBF4C940E007F7FB98C4B3AB14F652FECA5E8C9FF166733BC42E9F58D59F4B83DF794FDFE5AABF4C8F77035C2C4210CAD3C6F9D6DCAF8915F4061655333E5C9FE027E3A040590E3AC3C94993C14C109E3FDCA7005EB9F0944AA325F685BC872013B3099531F7D3DB0EEC7E94ADC801C0A", "1C9A0886A61AEBA7561D3DFE305B32AFB48D6A709B1C9FEA6EA76DE785C9E2B2049221C21ABCEA1C752AE51681EC4955D1CF3C570C787BBC6B26D1A919E64EB9831D309104AAE60238C1E7AC40047CD504C9624CC09CBF7E4E9E674B63F53300C0085DFE1C692565FE630DE96235ABCD2936A7ED20DA13B95C6CE2B9EE8EDF886E51AC59B0DF33BC55F9B985A89B0D7FC094EB669931EB40F4B03AA17BFB735692CD675263FBFA44D1890DC603F1B6261916A5EBDCED613D515F09CC5426CF11D2B49665BD9E8694")]
        [TestCase(19, "1C9A0886A61AEBA7561D3DFE305B32AFB48D6A709B1C9FEA6EA76DE785C9E2B2049221C21ABCEA1C752AE51681EC4955D1CF3C570C787BBC6B26D1A919E64EB9831D309104AAE60238C1E7AC40047CD504C9624CC09CBF7E4E9E674B63F53300C0085DFE1C692565FE630DE96235ABCD2936A7ED20DA13B95C6CE2B9EE8EDF886E51AC59B0DF33BC55F9B985A89B0D7FC094EB669931EB40F4B03AA17BFB735692CD675263FBFA44D1890DC603F1B6261916A5EBDCED613D515F09CC5426CF11D2B49665BD9E8694", "8B935EFA6A786453043FC9341641CD2843EBD861225BCCEDBB4380642131506723A2444599CEC850B1A4292AB4D310325F41A66F865683B99306841F6F4513C4BAFD6861B7A22D40ABCC669AEF361EF4039B9CB48CCE6F8C1AD6A5D44F2A6761BB229B95DFE345D4D81A9739F286E4808CD11259F5989F55BB8E98268E744D44087F634CBE327EBAA50671A5FEC186EDFC5193258F49407091496B8EFDBD33CF230AE26D0029DF8E49B88A4B704F889B0BCE5CFF2F64FE3E2A5CC1F0580D4AC01A87C689D5D0FC6F")]
        [TestCase(20, "8B935EFA6A786453043FC9341641CD2843EBD861225BCCEDBB4380642131506723A2444599CEC850B1A4292AB4D310325F41A66F865683B99306841F6F4513C4BAFD6861B7A22D40ABCC669AEF361EF4039B9CB48CCE6F8C1AD6A5D44F2A6761BB229B95DFE345D4D81A9739F286E4808CD11259F5989F55BB8E98268E744D44087F634CBE327EBAA50671A5FEC186EDFC5193258F49407091496B8EFDBD33CF230AE26D0029DF8E49B88A4B704F889B0BCE5CFF2F64FE3E2A5CC1F0580D4AC01A87C689D5D0FC6F", "C5B085EBA3D4C429BE6317E91E8C6575610605BBD52EF834C185FF8476983AD2E50FBDDBEE87146A29C3BA2E5612DDCDF5C92E1B95A6466709BA992AC898BAC205C1577D1272618EB296E4746A34029ADF2408F1369B17E05A2BAF1F51F6208883361E943A8F34CDD7DCB90520F49D979E30B398A7F48B88504B02F1D01A129758EA9C1E789E64AE6CD4C6C329D281CAFBC7DDAD1525D69733B1C74E62056DD9E416FC00136EDD4A04DC4BB198EAA4B0F60F509B06F4818F7A0D32EB7D098AC683B53FCE4C9D3537")]
        [TestCase(21, "C5B085EBA3D4C429BE6317E91E8C6575610605BBD52EF834C185FF8476983AD2E50FBDDBEE87146A29C3BA2E5612DDCDF5C92E1B95A6466709BA992AC898BAC205C1577D1272618EB296E4746A34029ADF2408F1369B17E05A2BAF1F51F6208883361E943A8F34CDD7DCB90520F49D979E30B398A7F48B88504B02F1D01A129758EA9C1E789E64AE6CD4C6C329D281CAFBC7DDAD1525D69733B1C74E62056DD9E416FC00136EDD4A04DC4BB198EAA4B0F60F509B06F4818F7A0D32EB7D098AC683B53FCE4C9D3537", "B67A16D81A00A03F2C56383E3F80C97696CF9D6AA2792F6654F5288F93DD5500C3838FDFF07B413FDC7B183C964AF4E1A135DB338C4933447B9A5F907AE420BD2B5C2D39899977B092A37EB705D7CEC314576D8F3527B9840C365C49966455C2A59081FF2E91E5E6702F1282777D7455375E191475C5ECD63A4B1CD0438B533AFAD3FBE8897690DAB0FCD436010015C7835902637EF26708C79339471C733538124166EA3DF952CDE42186A069AAEE4356C54AD3F3139DBF85572D209C6C5106E3E3283A63F08B54")]
        [TestCase(22, "B67A16D81A00A03F2C56383E3F80C97696CF9D6AA2792F6654F5288F93DD5500C3838FDFF07B413FDC7B183C964AF4E1A135DB338C4933447B9A5F907AE420BD2B5C2D39899977B092A37EB705D7CEC314576D8F3527B9840C365C49966455C2A59081FF2E91E5E6702F1282777D7455375E191475C5ECD63A4B1CD0438B533AFAD3FBE8897690DAB0FCD436010015C7835902637EF26708C79339471C733538124166EA3DF952CDE42186A069AAEE4356C54AD3F3139DBF85572D209C6C5106E3E3283A63F08B54", "03BB1149A141EEAA313D84A601B38A99E140BE2D87F0315B051512759005573039F95582D80D18CB764100645321F1986F7B0731FA2A88D010B39FBC04D230CE2F2E68E2E54F1EB85B185815ADA3172063E40559611003B1405D8BB95CAC1F09585B23B5F6BBC25AC0E5A76F111E2BAF3779B3A3746017CD9ACE378EFB6C4039301A264D17A22B4C20190DB8E3E397D50AF1A2BD2A4F7D9F97324326A20ACDE9262409604CD94C3FCE44EDE865D3BC4049A8BCAA336BBD9A96E10D7B1C5C51E4E1127659BD28AA93")]
        [TestCase(23, "03BB1149A141EEAA313D84A601B38A99E140BE2D87F0315B051512759005573039F95582D80D18CB764100645321F1986F7B0731FA2A88D010B39FBC04D230CE2F2E68E2E54F1EB85B185815ADA3172063E40559611003B1405D8BB95CAC1F09585B23B5F6BBC25AC0E5A76F111E2BAF3779B3A3746017CD9ACE378EFB6C4039301A264D17A22B4C20190DB8E3E397D50AF1A2BD2A4F7D9F97324326A20ACDE9262409604CD94C3FCE44EDE865D3BC4049A8BCAA336BBD9A96E10D7B1C5C51E4E1127659BD28AA93", "F83A1896268497EB0489D9BCC545A569112AECEF72B11A05F0E59801D3A0E7D075F5B1E594D529E9C184C438C86F499DCA640EF7EEA6C1B323F4766B80AA17078D278B18DD7AA94B2E2DB08C1BE4F5CF958CB5A2D6A8882A1E034B8E76A5C52BAF332C960847BC409FA095C4E2B3D7AA94EB5D1310E5E272121EA2D2DA566B69A35EB239D10F16003F07A11B3B893C75C60637B0F5B7CA98E9E9DE8C906E4890AF37F036B1C4E66103EE217CF3F510E1C7B5D294490E2FCACCBD32D669F9FB1F97CF87766ED4F885")]
        public void ShouldPerformKeccakRounds(int roundIdx, string inputHex, string outputHex)
        {
            var message = new BitString(inputHex);
            var state = new KeccakState(message, 1600);
            var subject = new Keccak();
            var expectedResult = new BitString(outputHex);

            var result = subject.Round(state, roundIdx);

            Assert.AreEqual(expectedResult.ToHex(), result.ToBitString().ToHex());
        }

        [Test]
        [TestCase("0600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", "6B4E03423667DBB73B6E15454F0EB1ABD4597F9A1B078E3F5B5A6BC76DB1CD4FA555EB6E33A211E040FC205BC618F503EA9135F2E7C6E45A5AADB357D5314CA8FDC823D216098AF3D2C09A55DFC19D2578C7C2A328C415700136BB3E28CCCC067C8B278FE95F4187D926B5087BFBCD512F5F75FDF7AEB3A082B76083207352E8CCA95DE8E8FE88379DFD89A3A312E6222018873BDE70067DFE47858F69F877587E7F5EED8A7A3F6ED24134C86BEBB1F926CF6879F41356EAE44D40BF1038E7FBE46256698C4682E1")]
        [TestCase("A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A3A30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", "F83A1896268497EB0489D9BCC545A569112AECEF72B11A05F0E59801D3A0E7D075F5B1E594D529E9C184C438C86F499DCA640EF7EEA6C1B323F4766B80AA17078D278B18DD7AA94B2E2DB08C1BE4F5CF958CB5A2D6A8882A1E034B8E76A5C52BAF332C960847BC409FA095C4E2B3D7AA94EB5D1310E5E272121EA2D2DA566B69A35EB239D10F16003F07A11B3B893C75C60637B0F5B7CA98E9E9DE8C906E4890AF37F036B1C4E66103EE217CF3F510E1C7B5D294490E2FCACCBD32D669F9FB1F97CF87766ED4F885")]
        public void ShouldPerformKeccak_pFunction(string inputHex, string outputHex)
        {
            var message = new BitString(inputHex);
            var expectedResult = new BitString(outputHex);
            var subject = new Keccak();

            var result = subject.Keccak_p(message);

            Assert.AreEqual(expectedResult.ToHex(), result.ToHex());
        }
    }
}
