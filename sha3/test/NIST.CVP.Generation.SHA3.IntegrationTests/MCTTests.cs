using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using NIST.CVP.Math;
using NUnit.Framework;

namespace NIST.CVP.Generation.SHA3.IntegrationTests
{
    [TestFixture]
    public class MCTTests
    {
        [Test]
        [TestCase(224, "c2187726e4bf9da4ddb93f4e708e568a787cb4317dbf3af185104cf0", "99391b12fc9bfec9833e78f11d75e690ea12bb1e879d1db9e3b740ea")]
        [TestCase(256, "a610b2d837d635137398cbffeeaa4aa2e6637f2726702dd62a6e534484b9aec7", "5f247d104ec34ae05e413d506b85939d7262fb07bc8a99cf19333df362a220ac")]
        [TestCase(384, "fa28fcdbdaf58a8cf1701e062535ee7481708af82dfe6cf29ecfd0800a8fc6411f85855ff4bb02cc405fc1cbca69ebb3", "fe867370f2d7277120a6aaf4ebb6ee35cd6ea3d021b76582fab416ffc95f14cff41ccaea83a6a33e3e0df372d2c4881d")]
        [TestCase(512, "a7db7572ceb445342de40a22f0396f0a35a9a133c136a756f215f6eaf50e40a439268e3f247c8e7904712e5e480b69c8f09c6127429eaf7ebfe2f7ae55eabff7", "217611d22ce0c8d15097cf4b73f14123d4552abbaf17c44125ab4bd070226497ab40fa720913649221ca1e44d51da2de37efe57de1219edcfbf1bd8838e29633")]
        public void ShouldMonteCarloTestSHA3HashForSampleSuppliedCase(int digestSize, string message, string digest)
        {
            var subject = new SHA3_MCT(new SHA3());
            var messageBitString = new BitString(message);
            var digestBitString = new BitString(digest);
            var hashFunction = new HashFunction
            {
                Capacity = digestSize * 2,
                DigestSize = digestSize,
                XOF = false
            };

            var result = subject.MCTHash(hashFunction, messageBitString, true);

            Assume.That(result != null);
            Assume.That(result.Success);

            var resultDigest = result.Response[result.Response.Count - 1].Digest;
            Assert.AreEqual(digestBitString.ToHex(), resultDigest.ToHex());
        }

        [Test]
        [TestCase(128, "a50237a6637fe1885feac6a9c886ad07", "f2d6db614a269729429e760157f2875ed38c49b9402dd548cc6b8e350c50c31041a2e8e48eaa99c9ac5069eb56d172960146d67d0cafba572a035112c413fcd0467aa2b3f07e7fd2bacdb6d81422ea9cf360ad5df4040455d553694469480e2403c518462e3cd8f916ced2c6c9a009b627a2a87926c0a50cd1f27807380471c08bd7681187547b705e276f0a8ba394858526131a9b1da7c7bd5f2ac3a4793b8258dee02e9a6384c42f52a704de214ce7e28c18fde4ed10673e193afe6394ef31aa1d2c083f99a4379909d4398767b051d9c0806ee19adb043a814220a638b5f7205b579cbdf6fa6b8f60ae3a721b6fc9743d46a1f5c9547a00777702a22da1324d30848da20cb8b6a1b7ac1631bde8ee065a5ff36d1e0056d4d9627556989a36d08f5d4708ceb29bdbb46dc14bcc3b4de371330f58739895f95333b5926523e414bd73a0067fccefb9a77654a76daa22a8cc00ecd60c7deef498b8e967377715f9c9494501d78eb0e43316d2dc7ea06fa949e9f4f1b8405a58a43d6b65efa28d69c2385a3a5bba270da5f80f2e057ca7a560d517bd12552381886dccbd71f54c418f99411f3e546fb246d42b8f07c56638527e1598d83d51d7b087899e05f6754265740b53c2138daf904ac67756766246e33ce846198293063007127dbfe6106ecd95f4db62764db5a54a5045383edd1e56417bf4f31ae2652f4c2e854c0d940089b55962029682591988d3e94bce07052aa9c267e205bf93213bf393c17e5dbc162a01bef29cf4e4dff77e2cffa7f2d0f924a5b73a1728298af09513a404f7751a0cc5e57846d685c736e072ffbce24108cb0eec1ac7c726ab9be4ea62287c79b49df424726ee8b87265c081d48eaf331c03b2be2fb230233024af188004f5856a40e60d5a695a29f0b7ad80247fd823ecca1efc27c60ff2596f3c1aed4e3b60e4aa4a4466d677a04cb9ee4e5153290ef1d99f949d5512d44ba48802791738f80d6d0320b5271fa85f8236d5470d5acad746d730a0e9563caec4768d4e7228431f0eabec43b29c2dea8ceb2a5e3cf900aed543a79ffe34267e0d616a1530a2fa3f209b6188f3386083960e0e391e9be45ee6c789107fd273443b3ec04a8bd377d1ea9126f3a941e74932eb8d7c25e95d37477a42c112e77ad7837f50ba746425d5dcac73deba4f066d996fdf49b9e2a05db6590b285a31ce2745b4b33ab1b4f80d2c6646d93e70fbd1cf43e1264df3b7bce45152d7cb2855180d51f58fe4f00e0abfccd06d57ef02d0395e29bee0a9fee48758288aecfb940ca7675d455547f41f9ef9824bfde293dafd23895f283f71aced47e55726eff068c0616150c18222921b28b60cc2b36b7aab1d5ce547121b28ae2d0bab6be51e58489bae4cd3249505da6e1704a1625df98e3aad1eae0a3fc4fb6d8d12f97971ec38a7052cecd9edc97d1e333d772c994dc00cc26dfe88f834c6640c7df4c14a1ca13db4237b950cbcbcb33e07a4ee7a0f553c450f99de70ec28ea71f4f909a7fe988d688558aa7804cad99d38564260df3da08ed5ab93bdb501f1d175a64daf7de3038c6edb9d80912205eedc423684a49aff954bda87b3647ee854751ab65ce0b7d61172990e7b11f817ed566c082aa16c9e6dcc18eaf2e11a64fa9cdc434895f1dc42ba39b3c2f290d420b0b3ab051aa2072fc63bbde62dac32a7c4f93b86b0a0cec306ad88ef3f1994802b3adc0ac4ca4a9274408fad28bb73bc5cd271f28bcc3786f198aeb0183c722ae4893ab71cb056b748ddf6ba48f31360412d6a446d620ce4ca2936f599197718762748dc67ccaa17862173b5ffe5031ef0c8d1d811763eeb649c54b3007bc5d50a34d1b58e1729a9c5866b0a14398e4a1c63cfa8370648305bec54a77b5aed34ad395c89579d40c3f52d9fb82afe6f420fba4fdea2acd9c0f802bb3588f5bee6df3173c98d4838fdde0cb75d923100ca3f7e0c1d24b7afc325edbb898576f7b50eb48575a3a00c286546c7a06260b84307557ab46a350f4f3df2c7341bc1f04bf8e94b3a876149217bbff049afbc7ac7bb2d57621204aa173c4367830b6021bdd3124285b8107eab2b14afcc51a52ae2306e26776b7a09ad237f5ac84f2530b3d3e9431ebd2616323fa451cc511dd231c54fb5a2d0af37747df769cdca5bcc31ec2a7e2bcbb6b8b26cdf7a012b0703cc61ab066074509ae3566ef95ed510064a954fda255001b101649000f7db6d02c2c3b92972285b7f30023e47a87b394193fc834aebbca13aa67abf4fc1e628c941a09683348c868db23659eda64f447caf9d41109a24c43f21f2d2d0553bce1250b304a26a14f9c4a291780702348aeac4bf6b9c90002034687c21ac5d414bbe005e943078516f9a54252e4ab3a9a35b5106b8b023c0bfe552f1854c4b10024e486d02d345803a767854c1cc8870165b70ea91722c62f9f211a2ef3f0ebbb3f833e7a5dfaa47e6b9f47aecaad475853098b3c6cc149939c8d007b1353f7362878a9fbd9765e6ac93d0fc96ef9bca362e67460c3376c71730bdd819c8319faa80c15917a604d2b5d7b5811043413a07585cf5c0438753dc6b38fd5994f5a75e45fdd9e89c76f3d49c41e58378a9306e327ae2bec572e66ace45c76873b68d5421920a99d9886e92f13ed3e115d983ae2db4628782730ca9427c5add0dd1af395ac059ffbad30c1ffcf577914f1869e1c650c3c96e93d32e360dbf3bdd20e2f192be57a92cace578542ea124df955e3ec2106ead365e93edd072a6e7eb7cd40a8c3e68f0754cc88096c8b83f288bfc27ae4518f71ea4f9f4c09fc57c9d2e98bd8497994e3ce710327341909172e8260fd00086fde35a540311c9b9b1e068429f3bc1b4f3e4ec16caef11f6b79952055f03941a978a9a1fe2a46112f03d9561771db37c9081e6f64e9039645c7ee6ef281442c57ec040aed639b4310c129296b44e7bffe04e5406f32d2311ea42c28bb849109c4144311dec4d2bcaa54a8de1207660d1a7266a7c32c84317282b7879a0c667d4a9f52f3fb830f815d39e108b3c81e15218a2cb06fab7ace60033b1cb85395e08aec9264a09090ea8e30c5e8718dab81c959bdd7ef8cc8e1f6e4ec774e420d653da0b9b6f846e9bfafa9d7a2e9a0999bcba3596537de4094209d3d81f9d127a382638bc9974d713780122c330e6bb71c2666d99e159b07b39eef0d793d9619b0ec8a0f8967453862e97cac9f5aa5a83c81079cfaed3a0e8d1ab8357f7d7b66853bc5e5c867e82a9dc1db43cbb3270b262ab0712d20ae89431063db92c1229ed3b4a4b95cd4f2a923df5fba4f41891928eedd864f1d20e1c3257a3345b7c294c1108d4d6c65bf323cab072062f87f088a028fed649f961e1b26c6cd0268e7948ea61680e1e8761942614cd6d6bdf197faa3e6ae91825503f4c177bfb57ae1f9ef38ab1965ff35db33933a946494a67c92269de2b338f30cf1819c84636e83f313bdde0a1b14f8de76648ec0c44869cc7dfbd36946d6fd5e9719038a3fa62135c1160c4d918439ae1c862ef9b684e5c9b0370de16b027b100766ac5ffd15ad93a0744415a83122d7263a20ac88abe93c08cee0a4dbeecd29ee58213533e4b82e59152d2964f9e94d0161e05b948b0366d152785c0926dd0607db6e83366cc195277b4703fd4b04af4bf455f1d3fb295a5116e9a59fb635aa78a8137bf4a60db0664ba167db51e75ee04a5cb5c867cc7620b028b78f6a330bf251ce359fd8919740e77c6f2e6dad37815181512cfca62fb0e50924287468f54bf63134bc771bccb2b6c4295bcd7d72f9f6f58f03e9e275372e639855a9f1f6be7cb53824759fb2de120d394a228f3056d0f4f0091a7a85c76869531fe4110d345757820afa87734d36d916eedde44de328481f6f59a9b94669d70288de5532bd734ddf6bb06af4e3e87fa9aba241bc4cc85e1f716f4defe174d8edb98a2b9f8cf9663a178b9e4511fd00d5a4dec48759fc2933bb8b0d5b839a746e4a05d32c45d7c5ad5912aa8cbfffbeb7d62f08a9a3086a04025d9f951ce15ac1a31fa6498307c9e6d24b67395f01d331a269fc66a6c50ceb1fbff6360ea1c3866ef1884f09a529a15eaa5b297c969163f7a5bab1734ac7cf7f870250dcebf7e6b24cccb8dbb15c8cca1045bee31dc3ac826ad57943b1d1524677f79948656e74479587853e79bcb71bbd517c1de3ded01ec14dcaadf2b2222bbed2a9c979939a7f5edaee7ef27aa55e0793083755592b85468b0faacefce867d83fb4a22eba63784dd3170ebfa8cf0a12b010142ea1127360807f6659defe19f6038886e1f785ba34183ab9cceddf0aed9d5ea43cfd2f1055e59d2913247b2c46a2cd488503df25e546e18ae81fb061d652687efa74338395486a7e090ce3dae751d5ffbf831e5c2729851a7665bc40d3f55d2c3a201070bcb08e71b8c758ef9ba3fbba1686ebe4456f7214c54bdbdc089ea569ac590ca4fc2e4020684fe33cae04aa2cafe65c4f24a3249d1e448e8179b7f6c6277bcf31cb64979875d9170a74db70e84b06a898f72976d34997e427233761a08bf014f3c4bd5c2c949b3939f0589d1d1daf86ef6fd479468e39676604faecccac7fbf9be37e9d8c918b9d07e1000bc6a731a5515fff0202004b2394b1d36e531ccb2a3bb877fff86c189db9c7974b5aada199c2c39676af34aadeee1317cb655242d0371f3f532ea15fedd617e29a4aa6040da4bc77281cbac0350c021d85254feac89caa3c38845443fac4afab6c055316694590fba7b29a476d2e988012ebf61560aad56b8960197b6baf47b91b4fd0b9ebd8316412b235cdd98ddf2f00701a3aa4ffde8f3dd10b9786c5c46ef127c1bcebb8fb1dcdb5fdb477177f27745e4870e9575e6f7bebcaf87c9ab39ad407089ee10bb22b04b0d8a6a71a8027e957906f7a2ef4c9529b731e93771c040227da745d33c8e3eaa4f5f7dbda71d8b042abf03f30c5205c3eaa655c2e18a33346e218fa7197928ee47ffb7f4d1684bbd89b7161b46f6f360e541656b0eee237df658b0ded9164ed640fc4b1f8565f6dce7576a4bc2bc56b2d340f2831bd71d1851f6f04932a8734d7728f03dbc84616b5ad58e2e79ea53bda2d78822b3c4a07bee5894921b14a712edf738fbac310129f80b742ddeb01875e111052a76c4346801ca4d321beef2ba3ed3245dcb520e05450e993f1076e8e8a3773c67137dd590923d40f4e6cbd00672876fa98972ac6cd826dc5822ea66a50870b4af5dec2cb90efb6f5c3ebb233b06ef5839bdd40e74ad0b6f67292fabe324444841b2779c28c4154815079125492e1ebc635c0c85e6d019360a8b2429e2c4edd0eceeefadf84ccc0a22cff5071431d21798ae20f2e4c87d92e1d0f71b4d3a58cdd1a9714b8fed19985f6593edb493e7c1a382b763ef8cdfef3830500cf573be3aea9e67591c0e2554baddd82137177d163187373ebd0b180837eebdf20a26a09b2be7071ce8f83ecd19c4c66e4286236083912a24d4ab31e66c66f714e5558c54642fcd635f39e1595c66ce5d38eb5def419b8d4d2d377d425cd0149cf71ed17ef8ec66a8476b2e3841d122ae408a9d836ebbb2e09d6d3a0008a52c19ff2d833b3f55d0d429a98bd82c6f5ce93c119e5250d7813db52f4ab387615928680432ece723bc2122341dc06cb0907bb7152beec73778a290f9e6779bf7f39e773a5c53abe4bc63da4d0d0f6584b4924f49da2280fa70e886e229345ad3befae93e8e751bf4d6973444fdc5ae2a5c0c44b239eb6cb9215dedd80857d58422e1ceba29020a42d624ba8abe36b4865e320ce07b84c414cf949fee2c7d737de9abcbdb744d5f29a927af551464a88845b19e12811b199cec8edca4dd88f1767ca3722f9c2484ea78df7265dd778e7840a08cb22d2db9f6ed425eeb38adb039ecb18d747a8e5ef6848818b954c97cc062f1f21b45248f0c314f9c935f72ebc68811ae3ba6915fcf077ad8940a52e6601438329016af3e38f5694b805ac0f98920ccfb71ed120f8955a1cc839d67d69c8610b81599625901c41d320e9b23ea7398d934def968bd69ec1d0a018f3807f3e4ae92c0ba39848a1b23ae4c4bddfe0d67c45b4f17a3d4662eb1be527c297632ff2e7ccb0ceffae74d8f42d008372500630bf725a793eb206b4fd08ef37da025bc9bd5b9ed442426ebae31d846d5ba336679eabaa2afb37a5f00bebf9227bd38fecfeada2267e9b150f665c9eba14f95e9b9e8baa3a88b46a8bd703e3e38eee735565f242a59b47abd7d818336ef30a2465af2d51991a44e5cd29e1224ed283a10a1f39b84a9e2f0f55b366fc14fef741b79eaa4a9052b5142be26eb63cc4c4a4e5ef4f05371b5f4cec61c7c0759631b6a92607f7839d4a64e56a5ceac6edea8613a56d36486512d2e24e8157e4326ebe7cefcce594f567e986940bee9b209427cce30203bddadcc3d691767ead3b2d3e4d2bab180f338aeee73282034ef1eadfa8dd97841336ec0a8b963ef6682f676adcd9094796f5d4ebe1a3c46b5d830a0df8cc7579b07ada6d22bb0c030ae4ce82d90cc405f5c34634004a021ff3bfe4bd3daa1e59d67a389c7c7452f57b5a11f3a92dc3ba08c36bc4f973d8a8fea658edafd41dea6e5fc8ffbed761f99c5505b33bd4b464e6fc741089b6e12821e0ee52d28c7a1e4ad898eb74eac6897c6131c2013a8decc7e49db98c3b21c108530c1729f700a83c151a3a24565a1b3482974bbd9c5bdda881188e5d862917aa2cfa1c3b24b9b8db9a8b88c2e04836211d6280475120adf4f99a8c7e098384740ded503efccda91def6d51a759f2eb314a9f06347c4673db4e8bbd4d5942a848872668cf90087a2e789efbcba0d4e428a2c45474224004574547936517b802e2f903652a93e54ff80bca205e8040d8894b06155ad3e6c75308d2605b41f48635971e3f489d0effafd9a1754cf01fe1afb21120b85af7ec3439ca1982f36fb572c5d503837b604e611ab9bbfc14de0bbea7f2ed2ba6f9b36d84a79988817b0f9671ae8bdd9d314e2cbb11a8d7ea5fa6fef909df9d20a228c608b9a0ff19249a8f4512d15b3c8cfb8b2a02bf2b4462beedd1a642bf33089de5d3d6e0654c8bb3c1fecf38492117e4b04b2baa97866e6ad33d0e2fdd4c2924cd050a5de7c5df50d0ab7685ea0ffa0a4d8ceb13b3b73c2cf6e7bba7fd0ec6d2ea09ebc8ba2edc481054100b74d7c4684eb69960d6266464c6c6b022e05fcc6a6be665b5a9a190d1067a8e94b448bc18737332805d91a8b83af635c6252e774324ebde5f8daf43466806a1eb879f30249f9f0ede848047b4616f21bfd1f08321f50afad3e196e2fc77badc5ca417b1758cc2d4976d4b9cb5cd6a620915682bfc5c6790053d2a9ed7f8d800768fc146c58359d04d9fed9bd4f1d7648fe442276da8ce9cc83027404e4e4802ef80b5ca0f89cf3977b497eed4a63d55db5767b9d844ae0a2622bc85385f2d3951e7af2b4138ac87d050b744c620bc7d1e642debd123633f950eeff9690096c850227f0c808877c3e34d3d097bdb09f102b3a51cb2ba459c52049e916097c848c111fd59b841d2ddf0d2732b10c64edeb6fefe1e8cefc66762929b49faec1042fd0e86e4b10beebb28cead66654d3c511ce8a9c98d1e7a22ec43657364461b2451dd0b727d9ed70353b8e9374d529e0c4e31ff7a643aaa9fdb9f77e5afd8caa83ae190262e5789eac52d5217bb8420fc907beaf6be86b5517aaa34b9012debfbcc0499475521ae9846123585a577da1890f07a2b045ec50fc99a06092df4209c7189373dfcaa6dfeebcdb031537c190894d82c1ee79a631ba3f95e4fddd8aedd4b1595d7a6257accacdb4487a984342bb47474bb2dc4fab4d5b3dd967838dc2acce3eb234089b5f155500946bc8ce2d6a3d01ca3ea63cc9c888b6b51f94379a83393ecda3d010df8d8b26cfdcca3a1c67e3d363c9a4168a4cd0ec6dd4c8cedadb03b2adb330d782d6762eb46879e3b63fadce1ac2ef3fcbd1ee5d69fcb63c025ad3ef7ea1f3f8b970e54f6722cf51a0584d228d153bef49bf3383fee28b764b90a0d418d930b6a5b3f806bdf7e5ac32023935e8d485042569a7982d46154d10ab9663c803804cdaece4127729e0ad8cb84f61f691b1ca55ecfc429d161f23168af37f99c37311563738d7cab818e9602ff8f61f67563403f94c532cd0cfd88c766ce417ce56dfbb9632740a2d470edcc16316c97eaad10fa5fdec6ce215725291acca81f427172ec031d9a4bbfc5875bc851acb6121f06701e86296a33f383ce9a8f3f3bf0151eee973221e2cfd184cd86cba2ad88cc670d844cd118b885a23c325746e24377e54791972f0d50dd7eef84a5a39b3c4456056b543285c6cbb52e1503392b52e915f395f9ee46f9a326338f0f615bc8b4e95c3412eb221b831fc9df37cb545b54275150720681eea26fe58cad49e0f03b9cc49c02b0511276726bac6bb43b97c3cbce6272fa294c72f2b5bb19ad93b705485f8ac43414c8ab6c4281909da77d32902341a4ceb956753054d26cf1428a93b3384c8d76f87648bae0a38743765757ec79bbaded8023d609424c72439bda59b4f96d8d0480854dcfa819f5368519738eadbafb06fd3dfb4001f6ab4adf75970d2a0ac67eaf2b1ef13e5dee0ac06ac9ba053173b6893650bbb8787858586444b08f3428c3f2da1108ed18b520d07989dd173b6872992f785377d36231da2d9b001d5d7ca68c7ddbe72381acd17c29cb60eef16aaf23d04388b33b546687bf0a68ae38ada1fabc054cf75a673b3739e850ee0587ffe97695af3e64f9642d77e662ebc3a35249d957fbde71d4925c91a755ba78ccf5f7fd0f2b264b30d9834e76b587c7a6ce3432241f09a6426815946721e689b47c368bc9e2712c3ba58792cd0e626d7bbb4f959ca86ed2e37e20a7bc373f215196880d1055ffc91a677646f0e807b77ccebeaae4469d1f18848d300915d276cb9fd0675938eea6bafff8d9ac4beccea1ca270b3323a811493fca57ceaae8a9b04373fa71925c3d64a3298a8ec7e27d8ba80d86d65cf2dcd7b03e7a671572132e6bcc57710acc90065198999249e018aa9cda9e6231a3dd71e5cddfd35debec7d20f0c0e50f495f4f8bf3f8f10436b92ab69fa0cc0c7a453e08616e1ee467908f8668ebd5b93e34a083d554b3348979cc3ea31ef3d98513aa84c21ded34f1d8e77893036da0cb20476ae46d6c809c61cb5a4f28c65b0b08308cf88bfd281381f212be5bd6be56a77796d24f4a7a0e07b4052c71c4110b5e165a869d435b6bb72b2b0beb96a6f69b25bb780d6337abe31a3d02aaa478546e7b78806c18a0601ca5003f34d6db079a7be8f8ba8b21f0dc8c6f3bd86b34e6b8ac8e6ed16de86ad0e8c0c70a013a2680b69b112184b47bfcefdf7b8810129037ee6ed866e9732e9316f38b14120b96415f970af109fc7fa9fbda1799729a3202b3068ef38facb4a01454d51959e355adcb590d5d4968533d6c23540bda15c1494c3f92326b59e5d7dbcbe2b0c595963656c878c00f654b5670aea50cad76b896c50707f1302efe0cf0e3b219354596d107aa1edec5b477a0c60d5e30cd6f1d59afb87fbe218ec3567a4fd75fcc142c838d181ce19591bec10ac8ddf01247a6423133479d9e06204f6b46ce05afe6eaee7be393eee9465ac9b92b988b3f5915664ab7663197da92ee3282859b2e9ec7253e9560c20be6a67f9f581ce56cbab7fbbe5111d89af577918377389bef4f7825e1be8853e05e8532d027dad48a7b7aebd53cfed24756611709a008bab753e951e3f298eb39c24ae0f35a732f0c4c2f1591f1221aa5b52fd911c14812cd1fe5913bce28133f44306a9b049a926b0bf42dc8fbd556a3c7a9fe31d63a488987fe7975a8aa883081b04f58a1a281350d50e6208aa1366166d3e6b908e03b7012b8e067e2a15e8a7c66903f246ae135a2358607ed20a04c17c01161ba914f131ecc6cb85e32417bc0660910806c0e56bb496ee3e543408bd638f2ec7c694c5df5e2587426ad676ce58a2384d1734481379ab04d473aded1e20b966d318556e278babbc5217d5aa6f25874d2c7d6d18a2c740931844025fd37ce78324222851857b17c111cba27a91eeee71b5b799290450870ccc0661afab98a5f670b0f5f076378ad3450542ceee0aa9604d5ebab2e5406107176cb61472f87ae93e36ab7787676743d42cdbf59c4c3223d04ff50c39e0ac415a1577120f3df6942e597eb2f3014fa3d30e2258b8166b595ff5dbe7c02efd5c5fb36595802f4dfee53aa79da9f22d585a345661bd6f292aeae3fc8fba9299cbec1b5b207353f670279f7653e36d8f49a730bed83b11a4f253b76e3c8e8f987b74ead2aa9911e171f3")]
        [TestCase(256, "5a08fc1affffa2c182563f4230f5ab6a", "49a4a6931893eff106b97a9a61d67e91096f0f3b360d831c6a1aa2729c5656529eec3b3ad3d7e229e8929b2ab97b122eda95db393f3bb06ad73a18d3a8b249ef7ea77833e82ae6afd8811ae7014125b74014dd13383e24f19956684e0bb401308561730a11ada9eb408da4d5da5ae789e3a97080c34f808ee750c259766ab44f318fdc6a8037d3d2e655e53116398b98880c290eaf97d6b16e5b689af49cb24d5d29783029f34728243cdf134131dc7265125cc0f886ec7abef5b542e40e9d3935c19b512615850cf7aa6f541e10d533ec08bfd60a4b244d93dd10c5dc19b3dd93f5327976219f63345e2dd99bae3bc0eb1db7a3c296d973ad0d1ca2279d5deefbf11aca87156d6050d235fbb3afcfda4d7f765e2adf1e2ccff62fbe69b806addfd00f7600c937b45766fbd2cc72938cf3fb3615b81a87c68caa71bbf21e7a04d8fbba627a6a5cef41159dff103843f2a52882f0252d3d5665e9340d46a2fb39faa3d8275cc3055b4811872eef3460fb270a2333f931e6d8c02a2fff19c511264786ec12ac5b7833685ece767f8f")]
        // for numOfCases = 1
        //[TestCase(128, "a50237a6637fe1885feac6a9c886ad07", "68e33abe352dbf0d01e49bc1daead7d5f20e3f6234b8b45bf8fd126f1bc485cfebcd2e809b351d272a77bec9e19bc162abdef80e484f57763c33cc780138e82163e011b85685cbc944db1fe6b5e08ae09d511f6f88b32a32798d09f4fa75d8160146ccb3a3c98cbb07c556ca5b92193fb8feb57f32e6651a06c4062e02b8541a62aa91e45aadfe250ff5d36ac71db552cb2c5d70a0d1abec61fe438e4c70717371c988419780402ef689f1b078eda08eccf339c614a9abbcbf8496a044f7321414709098b52f9233e5d0d588cfff61f8d28b3bad797b3469f7735847a541ba9564d2c1fc96b25b53979f62966b20a647b5cbb9679da3e6caf6d80a03c5364a612f05337df30dc885570dac8af731cd292c8728f64f4b26df39b396d369aa2a02f2721e9af4f4d797ae236a59e8b0f8ffb0600cf5fbd9701759c48bab96974d5fda0da12298f773000d9d90979eed6579698f6a767ec920fb1e606460741044171ac832a918ff71ad6a9b1215eabf237155c4132a8a90bef171a149fe7fceb085d077f4344efcabc84add57d5de36afd439c2f438ef44e73f677d8f60150bdd0e81456597c48804493f4e955da1a3cfdd6227b0516cfaddccb7b6a1b889f5ba55e6b36161f7d21b8db4bdf6a0e14258546e7e94b75c45646431755eb9ec36fc88dc1ea5abecd84b31307e5b7c9d95958307d0e75e83265a7d52c0217e8c94066b4803482605109ad6a3e600cc8e8f1ddfc0499c15e1623f9f628ee49df128ef71af05fd7e3ca9d1dc0e1cd48ebeb22f716d4527d0d0bb2fe3947bf637c2ac3f178227d174036c9dc8e6b616f049ca969ce87800f9d3e613ff667670304611b887f809e5e327af3a905478df15293d31f9e900c42a46d83c797ec9e8336772d2a74b1652ea3f7f7734fb8423e3309ad112593c13a748e5d4aaa3643fff73c4cabf9e00999a9b738641cab2a6f6e34db85e6172d99a6d47847b59a857d74afd38ae59b027ab9d74e92be7c040ecd8f9db090d40dbe9b001ae215912b5db13d927e502b23a79cdb9000cbde20e0bdc6d988fe973a3e5b66cdc521c61b60e34450bd88022e54d941673c5f72150fce5ed62b33e5d1ff0974f65a649b90785f7a9386b4105e9ded22a0e376434922a80c84e85b7be0ace985387849b0e0e737ad344df58be977ae04d309ad1f5edf2c06e54fc4c8bfb0effbaf87dd88b2cd8542a632ab09b4640257fd10c39135e2c687788e1c2131654894c676cb1b25a56b27ab4c9603484020bcab6cc7a06891ac6863076c7a4d4a27de39c062aa926a3d39cafd1a972455f4dcc4b058886f8688e0af87049d57438fe798e0d44483c3a28867335fd93dec6b1b6fb59b0cd927b97ccc94e76485cab3fbac82a155ce13955ff25c7973fba142bf729dcdc513b840cd7a2db788e60702e0f68f5e3762d85ce5312486d7d9b4af85bc6bd25210fb5f0adddb2c58ba205092de1233e22791237122d1d6a03bb419a86c31bf913110c451fa509f8a6bdbee071f48c6f1f3412eef27af2624ffc2b321570acb9058829b8298f6d71703186fe802af742394efa3123f6b5680f1039246804826dbd7ab58a716a4d0d99d0677f7fae25f06e846b95ac86550a4576eba37fe2753713d8f9595a8bcc31c627884ecfbceaea84a61d1faeaae78a0a9cbe813cb4894aab6c155a9706a24b2ce31f43f36937c1b3d0da93132f5f54e29f03e71e387e3f20f9dc5312c1bf85bde8c405ad0fe69d1d9f78bde18a165c4ce15c22ecec84795fe8fc17dc97eb3aa548e53339a060d83833e78c7b2ac04714d5fef2a831cd3ca572210dbb1ecaff6f37ce5cf9b76e239e233bc43a1582bf074d62d2b423c373ba970ffbff27288ddd8750863fa8fd3d997fd3d6759a7c3b9722ccbe9250cd889aaa73336b54a2930fa5e5028b2d4bb5a8e2b3c288658205b8dceda045ef14d77e536ae24db328cbd6818496fca9cace1d6de42e52a8dceb2e218e7418586283ce904f75ef0b4912dd71a4a26df8f8e9a37c3b83aa0733e19b3412a498c1efead179d93cbdf8fc0578c9fc6de15dcf7df1042cfa11ba6c7d120f7de2598d769a69ee455c981ccedb7620775cb509f6dd63c2a3f85764fa9a104fec536f638131df6eb6c281ec38cd58cf44ad395824fad23b659218e00544d100da046d176b650bd2a3f8fb1ad1c35375f3ce6c6f8cdff9eeeecfa6dc4b763f13f248248b04abe9494a46b1f6f2853429178a23ecd7d529334d9c0535adbe8d134b137054f9593c8e64a16a9adaba313254f0a429d7f1dd3453bbc4b4af4538ec7eecf941d72d3ff817cf60c596351ef6d910e211e323614ed18a7f8369e35d3b417a56ef52b5607b7049ac1ab1a8a7ffcff837399bb06597ed0df1d60bfcd84de430bb744f16522ab88439bfec0febcb4c0c33260b29ddf29e1a5f44af1eedb925138d65363cc137726ecef9f77b696bda77fd2ff4a2e34224377f93ef24170d7df5fc2251efb16282b1677d0749b18b233e05fc3bd489482b4031e1fd231c6447b2abbb5ce18828a531b0c9f43e3b368a1123a880a76a115486474738d330938f2a2627d610ac34a2f105e290e58a8ac9555b000a1b9ed622ae2683cfbb4e3c950ebb07837c4ed1d6261e37687213c5597cdd6c3afa984e30f417058d393a85a642f60ef6f09671ad3e99266ee85d6ed46ded3b6e15256d5d3a4bc1d5a216504a6fca23cdf0de6d32458f2ba3a528fe6d2a93407950656c77c2b8cfc68dca3216d7ca6499881ff0a5772762cd983329bc4d5e4e573e75b48b3f85114826b5ef0dcb3c4528ac8b13734409575f686cbc0bfdd46c116f0d213bd16c992716aea87b8c076254052e1112ec3ee4e44b6c1c299b4a16faf53aaec7c8358f743c4423c87a2052b815cbf7cc52be5d786d6d20d5f5670fb4972d9f346e5ce9af73ac2c0e784d2aeee6a2adb267a492b6b0e4ad408f76704bdefab0097226948c049f2840f11d754a67109a90b9df3319d8c89dac97bb04061a0ae4007e38afc49bab60e663cbd3fc6e74557c6ff398e93f1fceea86db296953b3a1350b682f0e82c10a719753bd2d8ed48dac46021f0893d2b5cb867deb6f40f3cc3230176db668356c1288a3fa04755fc46e4561948a2eb1ba49cc6c3144202d5692f6cf3c5df9340318a1071222b507c137c899f971b5efe05fe255d936fd6c7dc885c779864808fb08699eebfd321be82f3956e018d1cbb02f44ec28f939bf6a409f11fadf485e688d5b03b452f951d9c23f95241f231004868aafa603fe2302decc2a780a1e1a929b45ac17710e01b54ae68ca249d2e4d6d1887f59240bc3a87652b7faed4f072a946d4a445c31ff136478f588746d6d01ec198d3cba8f5d58f71fce773ee79847fee88a52b6496c687ecbf9fb7e61b47c4de622a0d35e83bd3d388295b025abc0a8cda501b453213954c1c89c2fb95fe0612c65bc9756e3f3e38c933feed7464a47a844599e7b9ed15a32badc08cc1d3686c6e27380cecc7f1502e3b6026ea5d9570f8349d72c2510f84c9ebf81876123e916322d82c1d00e2b4ba32b8ce0513323ad736e2fdcec51684114fa948d7a90db142f9ddbc8f53f4b5a8ec6ceb247ba4dfe06ab9ea1ee09dc20bebee52959d416740df44d7f12e7aecebfc05ac923dde07fc70b2a2b7eab6f8e2259098028843a7bbf4f03d7d11a320b77ba182af9350b24e1b9d86f490fbd64bf1c3f97db7bed78fc8fc6f82e1f1146a51dfa8353b3c8ad4e20dc4321dec7b84f00f440a5ef456eca7b2919c3c835b0a7bc0066cbf1c7f05572d1a42d5d371cbd3b400d3edce4e456059826e64f871f6d9b452735659bdedecb5d565245a462059ac05e08ec14b6f96b35afeecdd0e865f704235c973a658d658b8838237e3e6ab49f38433561cce128e4de30e28cd91665e1ab83c2cb868175b07f76cb12d4a55835062da783813f9fe32509ad02ae628a021c5ff5646ea60073ab3eb2c3d653d7129723")]
        //[TestCase(256, "5a08fc1affffa2c182563f4230f5ab6a", "4f8ce32bbc37a1a636ec964d61669b6dd7ba450eeb2759a67b52e6861d4e33e055b18818bba2d6913fd1375204fa52be585a15b918c5a3bfe7945848d1b5292b7777d289819136009efef0320e83328edee006baa91decd673989611323e65fb4b296eb5e276952c821d6823f8780261a36af2f834bbc4ca3b5a9298c2cb319d0a1f26cf42506c6ff6e020523d8a72dedc8f6340ce7dd5ab064e451aa8b913fb40e522280cac010f0725cafe90e1cd5f8317b98e92fff3cb867704e4e6bdaef74f93cff78d1162abe9ab7ffdfef261cf5928dfe96def10c952d7f00475f61f6893f56a090d476328f76d783367cfaa0e899b8ffbdc84af6bd74383a59dffb51dd1c64ef3c0bf764ecd07771b582b980b35e578000927b8a6b84b81e05db38b39c2d7bb42483407b0b6f0008f404285eb4423d68f5092e7a33d8ebb984236a561e8f4b25917cd3f228875ecb025d1be95504e56af208f68cf7d55d0a35e166ee798ac069c2462c8135a27ca46f99ace444bdab17ec77ac1437cbf2e5a7ab9feccb8083da5dceb00d170beb585bea330d913c2290a0189eab5fc136112c65432832e3b56d786d80221e194d194f8865645e852489cd365b48997b0fa2154bd7cd8e41ee941499f6fbc8a65b902c51cf3a117f5d30e10e681bbf63c1a3bde7ea615d4bd72596964925d962b484d17cd06ceab1413f4f4ca38e923115355a71e40410a753ba2726d3de5e55dd0bdccdb6a162b7e078ec4f224e596bdceef67602a703b30d55b7fc1f21a07d154ddaad39b8f0bc64e78c11c7d9ee65d7e14e069466b88296ca310beb0edd6e9d5c523a09477cace3db2f6c9c031402bef288f44fff08a7916b96a7bafb673844a9b6a2bc8063b2173bff936360946a024bcd9140e05a9714c72035ad2eeb6c93886e13d1e9a514ce9347cdd833c9b0274bd51883009a528488cb8319c1f4ebbc200fe353e2e114ecf13e882a149e0e399a63c374d0da530684002790f63f69ea3e8b338282492df3cb4974b71cabb751da39559085e446231924070a16d9fb1faf32938cf113b7ff75c7569db14c2b0368fad38db2b510b2e19a6f3125b177e764f39aa47e93b8a12cdf4034ccb343258a2a4405370a90a724927be482f7b2c017020634d7ebda686d26ab20b04a7d5ac5c85cd21e17797db3acead9d4faa7516fed59447e13b92cf8fab2a8142f2052a5c4e516b3fbee38118593981eeecb0c85d9f8aa01964293b01f81f83e6c5b51d2ca2f39a3eefd444692009f8ceb07b3c8d2145ac20945b9a5b18273ff17d93933f673108f23b35250384e99db12299ddfff109654f4d5bc78062ea8ae4a9a7857f4017193bc843f6609c40a09ffb716a451b69ebf51b4fd130bdf8e8bd52b70416d981d1f5e25b4dde866b863ce1286d0fd50735574669b83f6a62b31f1ab160224f6def7e05f2347de348c200cf274342582ad16c71a7bae82a291d20589eca4a97734cdc9367746f587e198dd0103f4c04452f5fe446d34e26d90b5326e87f06f6d0141139ee547a2afa6bfdd23f75055ed49d409a9d6a88acf81c7ee0b8845c18ead9bc964deaa513312693c32e91701c571e29a4c8eff813f13c98a4c2255b91e08b688fc47edcd409ae15b8b4f35621db55350ae66d7117fc2c37d119558d0ee68278f090fd01aa7981295048418ee319b4c55769fd95e703c2d00cd5cf894f6f261dec6cc73c21c06b92c223b433b83984a36423b760971791861dc3aff7c52a09d2b84a41d3e0f1df969fb00c1563f9874460c4b6ecb970f0b702cd3512b424c0f3014ffbf030a9cd1c60a66f33cd1d8a7f80ff00f4c0c4ec6b393a9f2ca3ebeb77d3213f3c5bd9312cfd2793772e8cfe1e9abd25cf9d4860befaf23f4efdb197e5c9b1e2945ed18df9d947519ce97d95b6940d423b1fbf59eaeac97d1aa270fcea67050d728b65bec636b45ca4ab3d83d3120f6e2e016985bbc83916b29daad734bf89a05f612edd208ac9a3a4bc0a0cd1fb53bef958fc8af82860b2d2f7dd088fe4a4f6c70c003a2c4c1bd3055c3fd7adfafffe7d011ebffa6289fcc91e4fe112c4d7ef89d2173d2ad1b004f4f39521a26b785c762ba4c5d4b0de23f4eae60ce65df477253e46c98bb87f490808129980e48c1e932eaebc8accc6842cf572bf7d5ce26eddc7349865597ec930ddbc8b3043b715da3440559d30ace72017124b3dc1ffe67981e1732ea61a53f96026225f151d506f1908d857b3b37b45bbac1ab45f034732000623e29cc1a48fdeb65714c219b42c24158bd5bf48176498f108572154ad4512094d9ced82298becaba9539c2bd5d3615c9062f5035a642504b84b8599319d08a1f6c2c4272a7462f98e529c4730c2f9090d035cddf312a023bf4addf354468784af004f67e8f5f8e153b6658a9d31eb5acf7f7fade0949357cb3541adf21c510a5a6ecf45a6f85377e589099add53745e58ae2d349b3e9c148cdd68e0f5d7d801ee46222b16a7315b62a7da2dbad81e2beeaa3f66406908c6f314c0748a4eb8d89cf6742fb2068bda57bc3bcbe87838dcefdd12b384977a1e4f597e0d3322f0b0d3df2a8f7b1b14119fd9d72bd1a3704d3aaa38a8497e9214c919abf58ec097b608b8a4b0d10c469055e9afc136a705abb98d7a53a21c1cd5343fed6fbde0001b18086c0ad851baef22306c836be0fc8b10270e225921e6481be49479da3b968fb4a26221809d7fccc8107997bef7fb8abf6a9af15ff40f7b4c2b9eea5b6c43e605b54aeeb1fac37425df8f8cbbef673c3a94be56d3f0864f306b646e07b32f477ce72e9f9b23050dda2da291da22d591a3d3ed82f822c72856ad01feeae42276862516de86b0d0ea476a89ff1edc20086ada639255401f597efc7fd89055cb97675f5d1e5a99437dd893a417a3c04ad6da4fc888fdf3835dee386bba389cd3356c0077a651e8643a0c6d8a6f9b386bc5244dae918277b39c2eeef3d0d8d5b179144dfe85c7188fc54740053ac8f48f2c485e130d0f5190d8b08859a77a65e9b5e58e092b32a46daeb287bba854d98b79b0cca096fcc151db7e5e7f4fdcaac57147ccf11b8ed7ec5cc6a454c9943470c1ca4b87ac4ecf0a3dc5fd5d3a122114d3e2de7b66b5c36e5620d3e6e2bcf11ae8361cc8132bbc147f04817cd6f8df10ef4831847235b2a778246c1611dc7d872192ac4e995f96cc5f81449057bf16fee8a260980f6785d091a6e3bc49c5392ec656787fd8d33d6503bb42cec90ee6ab8f6b3d1dffdd821c1af4db1f7c91839ea3e790be16db88048ec4d1be5d5793006a8881969dbb58394f60e620a028cadc1fac65041a7a30cc6d13586ad1666200778a57efc1a78b12977b66d8b7fe87823150378d063c76d1c1c6e397562e000dd4b4761ca870a69e9c0fe0dafed2a3669a1be6b411e68c5871e409ef9fdfbb97cc8284c281e4c50aced05fab680e4cb7865c23aa5676263e7757c10e32a2a61e3bbfaef387309eab682d332ecaf9cc7854af6c1484c1774dd493ee389cbc8239a4ef8a3c228b1b731e4a25954be395b2f78cea8b8025be3a94c2a6aa25864559bcf3be7d5ba2bf9a948e38d9dee2262276add53546b94b6088ae42451f772232d9075df03d19c0801b31a06264947a26317d11ee1fc6d2c4ae789d0214b28d82647327bf93ac55d1c3e9e9ddbdb307e5b8dc4135328306d20d5d0dc120b62ddf774344b6a94186c0bfffb31c1ecf64d4bd346bf66c13bc2f66ee87d757327a336521d847b147da98cc1982d678010d1f9211a79ea22b4fa0da3b9f941dad41712c88617b91fef3ea817691632dcf742ecddf7d84a2db1dc30ac36d77d5c51c3ffa3ddbf329b06a3df8a5c6411e149fa3ebbb2e96411325faa53f1230709ef3b3e4b50ebbd47185fe9efbb8f0e05a5b08062cee439266e825fa369f7b781b8fea7636d1099c10c3b299872e7c49a3617a75d2e41a86fd56add6f27ab04eb047f0bcd74e1036674d09db6a561093b8f8f618e6fee81690ef8a30c0794272d86f3af9e03fdf08ea32205b2720dd248ac6e0f7f8cd2f28f2c39c19bd20a3d20d4c5ff615c1c22d3a36f4b640a5c9e906933274ef2dea593fb0541b56bf0d6856ba37275e00ef14af98717bbf246c5dfa9c454b4acf2d5b6671b91faefde190b559982e076bf973f9496c666bb6debce92ccdcd4af29a6600e1aad2fd39509ee08b52ec8e7f1f41b8f83d04421f7e5796bccf96c96ca57ae034c56b9899496797a1b2c2a21e4c1e2da1842d7bfc0a02982c7d5747e5bef067de02a0b087b935f54929f20dbb6dc7cf7709d129dee32b3105467ebf4f4851aa66c7c9757521ccf7d58f10d3f12dff6e0a5fe521e481462dd073d02ee04f6ac0ba83bc7a3fb65c0fe34b957eb8e378c6fc98a72a664d132b21071c80642785500529fb7be38d72b68df90c6300a90ab245883e40a0175bf1b7cd53f591e791ad566cbc3fdb267c5cffaa01782c20243191db50879b0622dda75ab78b982958265195d64892b71ab56a835f3eafc7236b395f1c3284882e70ac7ea40ff4f1d04893b4a80bb2c5975d1b7de864df2939a997cf88204d011079d2d69cf8eeccec48c61968755bedd94cc8b4ba4ac6599291f83f7f53362ee5cd9bd2d5610d94a0dfac9fa3d3074177995567ec74498618b879bcef6f55260bc4c5b878869aac32b54791cf025816884d2e7bf1398790425839c93d6692d854832fa0d1eea6c3415ef5f030a234eb0461eff9c417b3075ba17115453387873562cc087c722643ef0ef9b2c94893a9752e16f17f9b533a2c7b1418c9c57392a450ff819c0381d8fef00cab221150a06ba6dde422d13c5fbdbdb3fda7eb36a9b783f1f73ef6903aa6230893b9d2847f693155bd439abe35f5c05aa7320daaf0fbc4c6957cc6e1d5ec10aeab58f970cd54d1947ee346923cf19f9df5c0ab36012c5b4829375576f5919c0c52e97fb42309831651d74bc2be755a9518aa239476466cc0466b93e6b23701229303e1bf0d8c92f269094c1bf4804fad8773e206a6ecc181fa79046c15077f6ccbf23cda77077fde9aa67a9b281b3b585253c34f830979ba60e3fa16941afc1cf159a92efc6d60202437e033812c30bc22cb2e9cd8146e2c12f27d75b4a12873b6a53c862093540b557619d9a4c5d05d5b8d0977b501999cd4a8a73e508705ca0ad16b7f3f2fdb50ffb1f70d16ac15a529c3ee7d59d1ec7bed200547f9293a4a2ad14ecd626f31d6f95bb959c1b9bed56baa5ad3a670a930dd3b0cac9abf0e6e7c9457a070193e1e074beab4ac20094eedbf8cf42f0c69db2e2160e382af0ad7d3defd81195f02adc00338ecbcc4d7306f7d58b2013d712077be7715478fb0f179edf4fa014b89fd738c1f9723a83939e461c65ee45b92452ba3c24b771f9e29ea2014624fc2a4e23bf6b8ccf64364061f9341f1d46051493b9e2bce812026cdcdfbd3ad6ef6cdbf94ccc920984616b93db87a3c6f0ae8e6750f9f268a559e3230ea10450e48b58cacfca891704c1cda27051f6a7289e064e25bcff10567bf78720b3ca09c4db3ed1ae930531a1162d052619333baf63f3b0f12bffccbbdc35c23d7f3bec0adde05cd7be20110cb81aa6ca3c816b0b22e07a9a0ce25c366ec85ad0059acbaeb92a7d2e641a0a63abea3a99d4f0b4894aa41e35f7fa20ea7e00b71008f69bb3fa68bd684568951aa4a66bc098929efe277a9d22a92a91c9e521860d258894d1c1c304c1e39e6507cd18bed8e34b3bf911700f5d3f55e8f7e303547d636ea5411d1b6519fae4e6ce850b308179dfcc5dbf0d9db79e28914d0d00932cad499823d97ca5ead244b3b72bd7584b1e9f16906529457076f7c18f8869390e8dd402414717ba6f44c4001f0f0595583d35c4abce50fc21a099daa43e904eebbb3ecdb5f32c57694da82bd280762feaeb2b9d345c12e1077feb6b865f68b840b0631139dc146e9971f984c073ce4db4691b819f8991b6099c80a9b7e38012990e8a742e64b099d5910e5f80294b1fd2bab035f3d773051e978dea58029e8159426395e2da8f859742a3acde5b067a13eef8e40223908115050638bf6e31ba57b1f176ca9d260d797b432564fde0615b2c8e61a4670813173aeea0ef9fe1e25ef17901f89adc0ef6af9b40bf43df85042f10013551799086d7cc5912c7962955f4d5977d4e8c3721db79e7a9fa485b1f4f8f2d4e96729d9307a55da096b7fd0e1575cc758637d195c8ce68bd1caa57136a44a3e363f8d7361fef4f60a03faca65e42e41bbcb8bcddddb6bf76acec9aefd26a84867ebe8231c7272dc7380493b359eed5366683d7619fb3a0a7b345ea8ada8df8455647aeb41676a5d1ba006e22a099be5fc4f7e58c25751859b7b3c6a06b0ed62e18d9d3291a9c0152dbfd21cc61bfd6ffabc1bb67ad399b568bdf3ac6d350ca3f7563773913e7429628621366ec12d274422ea9e81b3b831d3cf4d0e63d39d030c292720d513027aaa7b2bebf90ad37d83b2d337a3a53ec4624992f1fa24fca8645601032356a9e7c2069db5f589255728b277d2ef8b1a6a1e72a40e35b512b5b95fddd44252f2ee6e6ba668f19692c47c222e18ea39974354c8dd08af522eb229714724f4789c19b927bce87bfec9396648fb0e4971a226322f15a0e4612871979957461873e1853536b861d2d7d8c04eb1a0544370e1af70b835c8afcfdf7c3069d3fcd07c8d130e410a3fd6ac4b262d4a559d6efeacb6790ee87f847ed68cd57ff28e18bfd29258323a75fb132a3e7807ff00699922b7ff263c0e241b371943348ce21fec4ed8966b0208cccdf85e6dc6e1d019e798dbf013c151e4937eaacf8603e3a0bb619e4be3f1c21e9c148858cfd3f1cb46b7218506c618a03e6872604e920f395efdcc55a45ac988ad9d3ae95a26926e7546dd1180ab27586fb8f9c4e8b851864242d12c79d930301230a65c44b3431499a61fd6da824ae2b84ba9def84a1797d12d8519867f865a43d4cd03d39759423e4f32269435a92fc4a024c8d1cdb22d849e34886b5d59e9c3fe177b86566094b40d9254c7b381476ba9075b125da8d567fc6117eb95f5bc57a633b1543a00e5c4b9031815e9a0c094843dc3af07e0e6e1fd00a5dfe85e075fdb042523c423b1a4d4db5f67a74e1fbc9161ebe2f3faca07a836ded6ed5be02394dc951bae47c73f3a117afe385d050f97f6bc41073a7e6da26e3b2de6b35afa5adb62140c82775b0fcd70efcf5e7a6ca5103dca3d65c721c7a718eae438122ffac6116d03218660449a7d782452be313e7a9bad50fabb0173c738b54c8eadaa497aab98bb87ba355626dcd3b52ceac0e9b59a84c8fb4757c167df6dd13002e70b1306153a00dd33796cd514d4c01462daa3f5d82e61f73d0699e15e91f4544ad72ac6434d98763bea3b5d424f736328107c0e051ba063022beb9178f974b2432fd721d246b89364ba806af3b59e6990ebd530ec192f0404c46d03b1bc520b2e79adbf03f2234f5a1dbbc419fc5910b631b1c2642797106fc334ebc80f187eb4eefc2c4a7af883e43f200fc967ad4165951b681faf49d0e28a46954771e93513e1f882eb563e8f0da40973e398068c98fb461dadbcedfdd74ef8e8a35b10e00c9cb30195bf59d803476f1bdb437beef8dfed54fece3d91493a4e83990647fc872083e6cf1c255b8b8c5532f34541fb35456f615e2b5289c9930c1c746a1a8ce51dfc190ceebeeef5ba616994bdecf71a16782fc32b12a928028273e5e4c4fb35c737ba049cf1c51856cd372220ee583cb5637a5bafb2ff0007cdb66684b92b72f22f79924f41c89d2f5cecf5bf15f45c823073c943ee66734ae5cd53c30e414cd718a736d60278dd07636c89103a290bd68ec5c2de7175315429170b8de0aaf8dd25f09c1bd9054c171a3e34e270eca1a393df1962f07f71a51a11ba8038a17c28f83e71cb069616178b5bacebd84334dacd805e1acbef8c492df9903fbfbbfb17ab487cb946d2e4e9f0bb0941c101959853f0ebe790796f4a47516345a109c35d92adc4c83d916dadc6ceec2e2b9a64273c72a422d67a178d59a2de08eb23fb3efc4c59f3e7645d9133812810dfbf721384b3bad7e7be3bad2a17bbce46b4b1c2dc1e6a27bf0e5128b16a3abb04f0257d6f9209288908f6138770b704e84ec3c4396bdbed65f98db03b5a6c785bff956d9dcddb8bbca7050152a9357b3885b6698f99b9124abb3f775714745efd50fc68bc1f355bbf03903a475cd803ff710497b4f183665338e55b7a68ba06615416fc30899d43202cdb85ef464251c0d2f800824aa89e6f09cd8efe82eb0253c06fc510f716aefe4a56307c54045fdb621c99e58e9aef1e0eccaf45645db1d9bec56c867fd65ba30a7fbe3bd067d5c4b3dcfe631ea5f81cca968a460c150f258a7c96dde8272654a02e82406deb1bef8cf63955db9cc0253dd04d8eb47372d163cdfdc4c1159a94f31224f9a5c3c1b2c3a0eb8ba95afeb59eef9d947620bad926ac95fa288281b2a0ce2d5c713df325bbc82834dc26a98cf4ab2e9711dc4de08dddef68fe3139ace95ddb5637a6d3dfbdb80b20daea2fc4aa20d676a221ae8afe0e384538e2cf341e3e9ac04aed11b603e5f5e9961f06823f70699f65b88d7e6a4529920c2f00621835312107bcdefa5adb90ad31de7daa30c94493b82905f4e3cb2f77a6831f8731a78de56afe818da5edb1332215bfd4971578410687a8997d8d0dc7746289c3131b527cf1fb7d4f3bd4fba4bd264bfc54addc9ded8dfce223df9365e54c41aeb38e50afaa340f4f5e2e63255d0c34f8e08bd69e065157cbd943c911d7a50c59958dc4be256758a89b43ff6bae4a1dc639df058389cd1716274734fa14102b6fd74cbb506802b542ba190be62b4721d0786beedf453330f7372f8951e0a05b7f11b47d0a6f00b1eac53f2f66432a040c98db53dd940e3f57369cd389d2ef2bd3afed061b093c4417d69120a7646be71fb4cf323fe666e49c94a00698991b98f124c48173ea56f7a06f12e91149f015854e8a188d155abd56fe0fa235c91a5f3f4793ee8db27e69e376d6e9f48c550ce71f5e51301db5dd4c04efbe137f2aa33cb1f294deacc802ef3b2b57abc7f0422b33422e9e22e9ba519efb99301222fa6750c26a8018cb7e1b0b41c5f2682c2f3bd1e0007400560dbf4f81e60c8f4091afd2fa7291502b2e52aad20f9cd338fa5c6893f9b187eb86201975cfea4bb0eb7c1408fe8aaaa55f2b395e2a8a656869537c4e3cb36baee44fea73c7960df7df3d60eb92f42b4cf1482fff23df3f26f8bb53db41ea90be4a2371cda104446daab38539e6b2a03f5e7fd0e8d2260ddf89e7dbedb3cb9706d7c4db75e4ec1b0f2f48835972ad64db766fcae95fe4c33e61b1369454cfbf4b8db69c17544253c4d530d4379d1e80c01d357c41253c252ebac1711849040ac6ac5d3db901485a211e13828d3f6d4ee3d9239fb4b43090215cca81bf0bba5b67dfdcf0f190af2e691b1e87f85cd19e6274e1861e670eb8a23f19db5510b82083b80f6d42b3c3b106614a540e5fd97e7fcd7770203c04304810e8b11a2f1b1a843462d51626c9f29551447f4e23e3ac23532b10967b4042abe07b0e8e14d2ceac0aac96e9426f2224a5f1788d526a5c8575857856571feb614105299da4a47a7868e4d4934e66a1b4a8616b413e45deca6d6b840d51e69c35f29468ee2f559e87357f413e8c2987469f77fc7a6de6fbb0a1ecfae9ed0133fc9a3ce6b3921061a99bd9dadb8d5bc6b7639b0af74353e2cff4e28204bfbac50ccf9e10a03168b33d3e189ff0c7d28e38f66183a0e4bb0fc9d0584351109ca1dec43f8c39c0763746109dcb1f6556e04014734fa46d7130a62e70e6853e608c41c0c793a71ad6eb2361b2680f77203f81b2ba0ba62aec1a923f5bb97733f9c6e0fadf51c59422c6f83fa67fe63b02c39389e4652e9e60e632753fc5ee7437a066bacbef476733d9a4c6e29222de5bb75da5a55c86267a336b6e8462b219f2f535e1a00dc12535a1d686ab6d76aa6a8bda5ae2521d2056d82cda61ec2e15561c593af0282fb2cc417056a9618634533afc257abdd99ebac2aea85e4caa30b3ccaa7dd04ee88366265da5b1b2d621e547c230fb0c5e8dbd21bccc22e5807a0983f2633058674593c15aaf18e7060910753982f46ef9d36d2e464a14e318ed3bd38cd050ab37d120f0ce175819591eb758307d11af1c180dafd6c90ce25ef2d3edc3491191a0a4d553822459f1fd1d7a03f7e27a3a930c20cfb8e24d53aa56c063d6733553ed67d4315d7538608e381be63e93bb69ba09fb1c4ccb4336f1c1e4d505e386cdff96ea622e12b2e2287d61121441ff71f6ba23146598a2687a1722c87277d70b41ea1195e28a4c9c0b9dd7fa8ae571fadbd197c78e881f9defec83afc9354ac7528dd847e464c9eb8c7a7e641e6561008d8653969cbce1885d4fc5fb8479928675ec7dd1f36b2cea51631dbbd8a80059af7cefde1c40138519dca3af688b1fdd6925cf3a4401d29bf78b115d0ec1f3e2063e74f675afc13acc42cdfbbe29e9d5124187bb66992622a66a99772aa0864d86b0cff436ece7fdf9cd4d8b05045d8326713f8c9b8c2d8918e70cdd8f53c1cea4877da58877818fd1ced00edb6b33dbcf6878a239a9769f2d1dd19fba48aac500add4af01f5434717a5bf648eb7b9ac737870957adeff3513d378b240ccb0886d0f9944f6da1a3d162acf447c089751afe0a886d4e958873b82cc10b08f8d033131a09b5bb17638ec3830046b0790e89020ca96686cbb0ac5524bb9f8242d9f1f8f0f78880e3cd7af9a59bde7b096a31cef2d0fc8819f2467f7eeded50984e488a1fa9de004309d940731e8260dcfc69f4de286043345becf50977a66e2926d372199f60b0a24c2ded4c0b86ce0aaa6e7897e92a13c9bb8aa8d3e0a63d8062c8b47c135e28b9a06ac60d12c562ca099124aa3")]
        public void ShouldMonteCarloTestSHAKEForSampleSuppliedCase(int digestSize, string message, string digest)
        {
            var subject = new SHAKE_MCT(new SHA3());
            var messageBitString = new BitString(message);
            var digestBitString = new BitString(digest);
            var hashFunction = new HashFunction
            {
                Capacity = digestSize * 2,
                DigestSize = digestSize,
                XOF = true
            };

            var result = subject.MCTHash(hashFunction, messageBitString, true);

            Assert.IsNotNull(result, "null check");
            Assert.IsTrue(result.Success, result.ErrorMessage);

            var resultDigest = result.Response[result.Response.Count - 1].Digest;
            Assert.AreEqual(digestBitString.BitLength, resultDigest.BitLength);
            Assert.AreEqual(digestBitString.ToHex(), resultDigest.ToHex());
        }


        [Test]
        [TestCase("c2187726e4bf9da4ddb93f4e708e568a787cb4317dbf3af185104cf0", "4754e77ba100ef4ea103d97f4d4d7e5d9015a9ce1911936667ea9f32")]
        [TestCase("10d2a97bf1fff9506af052fc7eab78c99fed027cd0bea6880749b682", "c8c1afd48fbbb8e8e1b2cc37abee34a974282c602816f389b608c640")]
        public void ShouldMonteCarloTestSHA3HashForFullCase(string message, string digest)
        {
            var subject = new SHA3_MCT(new SHA3());
            var messageBitString = new BitString(message);
            var hashFunction = new HashFunction
            {
                Capacity = 448,
                DigestSize = 224,
                XOF = false
            };

            var result = subject.MCTHash(hashFunction, messageBitString, false);

            Assume.That(result != null);
            Assume.That(result.Success);

            var resultDigest = result.Response[result.Response.Count - 1].Digest.ToHex();
            Assert.AreEqual(new BitString(digest).ToHex(), resultDigest);
        }
    }
}
