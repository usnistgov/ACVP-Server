using System;
using System.Collections.Generic;
using System.Text;
using NIST.CVP.Crypto.Common.Asymmetric.RSA2.Keys;
using NIST.CVP.Crypto.Common.Hash.ShaWrapper;
using NIST.CVP.Crypto.RSA2.Keys;
using NIST.CVP.Crypto.RSA2.Signatures;
using NIST.CVP.Crypto.RSA2.Signatures.Pss;
using NIST.CVP.Crypto.SHAWrapper;
using NIST.CVP.Math;
using NIST.CVP.Math.Entropy;
using NIST.CVP.Tests.Core.TestCategoryAttributes;
using NUnit.Framework;

namespace NIST.CVP.Crypto.RSA2.Tests
{
    [TestFixture, FastCryptoTest]
    public class PssSignatureTests
    {
        [Test]
        #region SignTests
        [TestCase(ModeValues.SHA1, DigestSizes.d160, 1024, 20,
    /*sal*/ "f360c1d564071c0e190602f4e0844d060b1d76ed",
    /* d */ "1b0856159842d4b6357a0d65687a126c789f5a975ea3a9a3282770607d98cb649f2d76fa72e495cdb1d0c29341e05a05f525e10a4635b3d237284a928a1bae3a67dddd2b697a5b99475161324ac04c7504eeab794dd15d292fcf32f8d34ab95b0c2270ef42f21caefb0453713b9e1631c3e680ef915f2525bcdfb7fb4d9c27ab",
    /* n */ "9159a115197f9731d661f65392b0a31eee887b10a96a577124f6a97f67a8733f044c7f034b32766831165e8380d0716b0d9af0fdfc6f7199e3be164d16de9d980630651bcd71574a7ac6178eb3758b8e0913a093b08607a0a2d2865a4f0ac22fc2934ed2a8514cfddea9f93c30aa58067e065ab7902bca33f62a3a63e7326f4b",
    /*msg*/ "8af8840be345cce291e43afd51a721efc0cc9ff37b89db2285e88ce9e9d5bbb9a075c900b4bab359a63595ff0e2b6d8881ea22d0b75dc533eddf16ff894d4a28fd5f0b3eed38c19d943b10e46421a1a8ec482669ff4e98c413dfc3ebe7cb0553695c53acd6e67c16239fb2929cb146b6cb8eb3a69b84de3fbd919c954b7875a0",
    /*sig*/ "6751349f6d03a9d85df4d46ed0a35451af42f385f71e1d37b2a38b483d6132775ec2bbd0b1500b068147ff5a2ddb08247cf33c1bb7be8adf2fe116268f6901d720ac5c7d1fed6d8488ee1f8f8f7b655506c973a65adc5ae778b76e8ea603b2354be59d1448607a3894660ffe72ec184f7844d4e0be305d44a5e4b789c37d4dea",
            TestName = "PSS Sign - 1024 - SHA-1"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d224, 1024, 28,
    /*sal*/ "44596de74bd5853bb5a6265b8cbd4edb636fcfd63dc852dfaa239b3a",
    /* d */ "2be8015c906e7f958703f563e51ae91ddf4f075366a543e6a39c37dd128edc98cdb6ed8904aa526157b90c39c08f070b28439e4b6b8c9b985b4f8953e23c29d1df671031343bc15a7e293e5db7a450ed6a63f88ed2dbf9d1e21addcfa8d05af23505790175b655e0be40b13ca7e4feb41d280ad17dd6170891845b827380bf71",
    /* n */ "bf8b2c61a99432c07bfd0d49d9c22be4e39033ea7b79c774cdba64b1d68d87914e99eee67a61985a93482c1c8b135ed187d2057dc7b77984d46a9dc6c0306ad11540790882d9912c03198806f918c6640c5c886be33b9df53456a000d4f4ccdac99186ec348e23b772a8f9b36a3370f2dc3312090565cd33caf489d465be3ef7",
    /*msg*/ "e19c876037fa8a430b4a7a100d47b8f3cc1765db86cdd2233e32387210c5aae0c200475a9bddb4477899ca6b1cb88b0cc8495b540b6b6df7dc107b16e601ba6223230d84acf878bdd068d8c963c2d20a58fe0ae293459561f8b3b020c85bb26c2d8b3fa71352bfec3a400ef2896d7533a6bcda4dc36133a8bba141595dd97a46",
    /*sig*/ "55358136e65aa6759bbd6105cb3a1993e6e7c6d29fb5b9f05b102fe01761cc3ee55c30c5b4176cb130b68898f36f81c4bc93821774f58d0d6f74c1d7b959112dc7f708a16f8e158b37b02e9c5b2d09295129d96b7d188bedb62f622182a74ea2ed6685b36056bba4b72b158a08ddd6d2ff3a23a68e9ad1ac7d6bb7fe6f7ea9a4",
            TestName = "PSS Sign - 1024 - SHA-224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 1024, 32,
    /*sal*/ "2fc2e1efb311a9bb23844832fe6c5ec60264a98cfbd779e5dac2645d06bb3ad3",
    /* d */ "160dcb156794f026e3f564adb2441c14c05ba251384b88e16af870755f47a93d11fce69d832b31fc243a65f1980c628a09084c2fad14f14bbc1b09bd3b72101c290ec595cb81ab44a3f145308b86d3f6eecddf46e3a963f87a6a03d996b009c1a9b3a28f15873ed5fa078325fbe2ea4f81ea4d822f63bfa5105f63547a1ff8c1",
    /* n */ "a2fc2a7eec2fc9e713174ba20073470f3c8ab9cb7ae40af049f1e72de320c50b9122ade17245afea4dd51aa617643b079b08cb76ad763b78270cd59297578a3d0a183f82af86888fa7128a47be573f1edb5efa034181f593fb6a751b6c55e5b4b2416e9caba7d9b256bee384085c6f3021fdf280779387ca4e104ef55be5cf6d",
    /*msg*/ "9ae479cd428218c7121a7484ae10751869ba2637b80ac4f8e66d15d909f2fa0334af48d0ee61d48be352cd77da804f12e7fb349ae28f2ed117a313fe3f617734b01780d6d0ddf65bcf799a4f967fb99afabd000536d592fa982c588b7a0398b774e4cae8d040a7bf3e568214c956db390ac7327f9c2619fcd0d08d8ba1228613",
    /*sig*/ "314c3bc6dfcb711f6b42c9390fcae2612b87d8eab6e440e5d1952db1ac639b647c3e8030b0a71e7537860602d8d1c64ae793aa2bb241ae28bb05c79775f14ae50f717f34f5f0de8293623da42159d185e9f05fb6ea3215cdce23a9ca484aa10b50505b9069cf9216fe4da761444da70ccfc704dff8cf911e1960c3b94bf0575b",
            TestName = "PSS Sign - 1024 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 1024, 48,
    /*sal*/ "11b67425828bc2136de88d4e31863af08afc94efaa8679fc8c04d3ab8546cbd51c86393b1b365e6be6fdd5e80cfcc785",
    /* d */ "491f99fba755bc564110bf40566fc202bd2e3a29be2557aa50f57f4a2c4a5e9f38fead23f352b0e836e91f68257ec4ae9fc790a8b71b277908ad0902c3984970bb77dc7bd66ab92af4735f06f62fdf649b9957f26f102df2a91a26bc94506acb65945c66de0ed28b75e061a441da245ccf024b9e445e06241a59851877f54d31",
    /* n */ "ac6279a7baeff09b4e08fd4e241d862523d97b49d95a737166ea7590d03540f5dadbef2e2c96c58cd67c9660c141f94874dfb3cb542561e3db501781c23a5687e9244b97221a9c1e409a5e22033ee341b5fece1f45e6b50afa920c59e70ff5e8d19288568c73c57e7c3857d641b8111070dcbf4df5c14f2c63220724cc0f4235",
    /*msg*/ "65a260334173fc767df511a3eefc35cdecc9b5dd4e2d29d896f24c6068760b7e4199dc9e65d951db19bced7d136f36c02fac0bd863e03831f58e48fbebee9be6c4dbb82a65ece3cb56e0f31b2e3f5e804c3e9677c8e398d9a96bc15e59e9e45f562f9be029f1dacd9c28ca8428b5d494ad47fbc4667e70581b51608f98ad1170",
    /*sig*/ "030acd57fa429f49d59797ebce7dc55b84280f27672a2ab96c2817a5d3b76b7a9d92cfdb0dc4f955209398778b7346137881aaf83bc482beff583bd96beda78a03b7911ccc5028201ff82e339a47948d7651d211153e478daf40356382ba34b581cff6588adc6a3ae8d3f2cdc1c71ab3702dce5fd3e7832153d855794236c65a",
            TestName = "PSS Sign - 1024 - SHA-384"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 1024, 62,
    /*sal*/ "91cc46091eefbe3fe0c04305d26044998b17bba264e96b67dd6a653f3dd3d1487954eb5c57ac4c41d3f86b20c2c86339b578f7d420bed37bbc7f146629e7",
    /* d */ "1442faa2e38bb4bb5e420e04e3a1f0ad174c8b9093aca87bf11c5ffb4104e199d19f3645c5e074a390e555bb94b7f94ed252d6a87bfe26a588f87d5dc0b1affadc9dbd3b2518f41f83ddb755e7b42f7b9b340d87fd35f944aafc4e6a68e3ea7a1178c9c0ae8c69cda587f990274db040d2b50dbde2c1cb08a4a9ebd54eb118c1",
    /* n */ "b5707f841ed852407f9db3c280b5b2f39e562777adfc16d8409bc5a8063c0b652551e5146603a505cce9792b3061c71778e0c7531b273b932f6ae16852fea93539659901607990c925b7835b2b6e3dbb8332bea023fdfcc4ff3815b5875bc57079156f201cb8fabf5b1e39c73661741bdb43362f5afea3b1a054a1367578c96d",
    /*msg*/ "58a4b83e58378495670c3ef3e511f4c4d942800992be50088e2168419a0ea9a53b0b53034d92c9c3ea6494d68d21abed7716f1e952560093150c258e270fab8ac7b75db9abf04687e78cbb8611de9ca7a384d6b0a0842cea7b9b381a34d1acb3c451de4abb78844a282cbbe9b96f4f5b23333645c4705d748775a8cf097c348a",
    /*sig*/ "1686959403bffdde62deb8734fe1bfa50cd6d67e082d79bef7d8b87816047bfbe7ac881d89b3273b40ec134bc1ac14063818895259bd19a6cacbe94900a2784e7b21cbc96964d9508e67ff229a912fc87a96ec4822d4641a99695eea21c8fa972ed16e5f29dcef48673715dcd47c70e1d5bae6dd65c4ed108231e70f8ce8d1c1",
            TestName = "PSS Sign - 1024 - SHA-512"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t224, 1024, 20,
    /*sal*/ "ee802d2b8efed7fbf58c266bd2acdc40a76a2bf9",
    /* d */ "47f99b01d14a8220127e25f6f47108cd8b865988a7f9bf259fbc51d46ed6a90b916ef87b9a283157c493d4e10220aa7d27a65dd600f194360578adbd76b7fe33dd554ca8f712c63b6f1c6c0c3eed04540d3e5618bd2dc13266cbf10f54d9540b11ad2c3d23d35889bb644aef91991a8f89959bc59de933bd1d07a6f649e82c91",
    /* n */ "a638dd44e669029c4477151ca42fe3d4b1a102cd085271c30e64fdeb150f2a66a3db4432f020946e7b8e2bbc8e739e153ed42eb9f7bfc5f88d60324110eacad229c79ac5c4accf83bf508d63c6600d69d97cc57f711dac6e774154264f42acdfe3db3ee01fec12185617aa4147bc5cc968a46ab33bf3eb9cda5b0e2b30644b97",
    /*msg*/ "615b4ccd812f73ae1af2c13c481f586060865415839501cb73d54b08a6b7755599910e5867e4213e9ae0ad5c412a541543dc57fef2cec240e314e43efec70278d1094daf2943104be4b12ef90121cc98f9f74b565275791671390816b0073fceb0c9ef1bf1d4a99c9f6d2e5caf8c27b22be01666ca128d15c44e9ed7e400921e",
    /*sig*/ "8c9ba76f0501ec44cbb26dae18cb311f486f5890c8e6da5d438a9dac076b21f0f39b3771dd76ab35de3e0f694040cbd26fb72302e85782dce0346a3ce7d0509ef0e95a014a9ebdf1dda98f87f6d12f3bde3a401acfd3118f2520072d5c7fab54e94c3781d147b16af33c56ee83b2d833d9b57eb291f2ecbe440ccb5bdaea0859",
            TestName = "PSS Sign - 1024 - SHA-512/224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t256, 1024, 20,
    /*sal*/ "8d75c917fdce04d6b11a21b7a5ba12b675257cb1",
    /* d */ "10950aade6db806bdebfcd5f8c6192afdaba85a891ed269694cb0b22a3068df530314be652ad7da73b960b6527315cc835369d534e43d109c2f0a9ce33a89bf3a80f134a65139247552fb1c54f52770794056e282a3b6048b1ab936bc867e27f022a937bfaaec38cd765be2d76aa4376017100859d61f3dad026b6bce6e84585",
    /* n */ "abfe6aabebf91083422eb38e8f528714472a5e13e484481ce02c9ef45d6f2dbc2f91686ad12728c16a0991b79f542481d81b3a071b2bdd56df9a489f79da7bb2c362722f891fe8ccb513bb5d93a614cc42f552b08a1cadaac9fef51332720481d5cba83dc82e22d0b5deacfdc5a320280b12ddbcbd3334709a001abfa321dddd",
    /*msg*/ "227020b6b36e5ba92b56f42df33fb5b34db315a38a0e0be97e2724b03132d46dd7e5092002da06d717356f73fe86a0ae1ef1435d898c22f373083947e9941097c0fe48cccb1b73ff516a293dbdf458879876db1db5c24efdab6321a68880ec21c403024274f9492cc03c491397508246a28c036c767a380d0d80045577bf0f15",
    /*sig*/ "5b19d0d4552f937cff2ab9bbc3e28f701d3c2b810486d48d5e0f2ad50c157cc213e34b523e5f1421d7a3cf62ad77c855f55ac14134317d9f0f6e10e35d5e1ee04bdc8883b8558e45596c92ff47953ceb576c7798dcf4629d6470b0aa77b38927c62117d9f160a80c5649c8e4390b032f3748d4303923db7946fc509b28254045",
            TestName = "PSS Sign - 1024 - SHA-512/256"
        )]

        [TestCase(ModeValues.SHA2, DigestSizes.d224, 2048, 15,
    /*sal*/ "463729b3eaf43502d9cff129925681",
    /* d */ "49e5786bb4d332f94586327bde088875379b75d128488f08e574ab4715302a87eea52d4c4a23d8b97af7944804337c5f55e16ba9ffafc0c9fd9b88eca443f39b7967170ddb8ce7ddb93c6087c8066c4a95538a441b9dc80dc9f7810054fd1e5c9d0250c978bb2d748abe1e9465d71a8165d3126dce5db2adacc003e9062ba37a54b63e5f49a4eafebd7e4bf5b0a796c2b3a950fa09c798d3fa3e86c4b62c33ba9365eda054e5fe74a41f21b595026acf1093c90a8c71722f91af1ed29a41a2449a320fc7ba3120e3e8c3e4240c04925cc698ecd66c7c906bdf240adad972b4dff4869d400b5d13e33eeba38e075e872b0ed3e91cc9c283867a4ffc3901d2069f",
    /* n */ "c5062b58d8539c765e1e5dbaf14cf75dd56c2e13105fecfd1a930bbb5948ff328f126abe779359ca59bca752c308d281573bc6178b6c0fef7dc445e4f826430437b9f9d790581de5749c2cb9cb26d42b2fee15b6b26f09c99670336423b86bc5bec71113157be2d944d7ff3eebffb28413143ea36755db0ae62ff5b724eecb3d316b6bac67e89cacd8171937e2ab19bd353a89acea8c36f81c89a620d5fd2effea896601c7f9daca7f033f635a3a943331d1b1b4f5288790b53af352f1121ca1bef205f40dc012c412b40bdd27585b946466d75f7ee0a7f9d549b4bece6f43ac3ee65fe7fd37123359d9f1a850ad450aaf5c94eb11dea3fc0fc6e9856b1805ef",
    /*msg*/ "37ddd9901478ae5c16878702cea4a19e786d35582de44ae65a16cd5370fbe3ffdd9e7ee83c7d2f27c8333bbe1754f090059939b1ee3d71e020a675528f48fdb2cbc72c65305b65125c796162e7b07e044ed15af52f52a1febcf4237e6aa42a69e99f0a9159daf924bba12176a57ef4013a5cc0ab5aec83471648005d67d7122e",
    /*sig*/ "7e628bcbe6ff83a937b8961197d8bdbb322818aa8bdf30cdfb67ca6bf025ef6f09a99dba4c3ee2807d0b7c77776cfeff33b68d7e3fa859c4688626b2441897d26e5d6b559dd72a596e7dad7def9278419db375f7c67cee0740394502212ebdd4a6c8d3af6ee2fd696d8523de6908492b7cbf2254f15a348956c19840dc15a3d732ef862b62ede022290de3af11ca5e79a3392fff06f75aca8c88a2de1858b35a216d8f73fd70e9d67958ed39a6f8976fb94ec6e61f238a52f9d42241e8354f89e3ece94d6fa5bfbba1eeb70e1698bff31a685fbe799fb44efe21338ed6eea2129155aabc0943bc9f69a8e58897db6a8abcc2879d5d0c5d3e6dc5eb48cf16dac8",
            TestName = "PSS Sign - 2048 - SHA-224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 2048, 20,
    /*sal*/ "e1256fc1eeef81773fdd54657e4007fde6bcb9b1",
    /* d */ "49e5786bb4d332f94586327bde088875379b75d128488f08e574ab4715302a87eea52d4c4a23d8b97af7944804337c5f55e16ba9ffafc0c9fd9b88eca443f39b7967170ddb8ce7ddb93c6087c8066c4a95538a441b9dc80dc9f7810054fd1e5c9d0250c978bb2d748abe1e9465d71a8165d3126dce5db2adacc003e9062ba37a54b63e5f49a4eafebd7e4bf5b0a796c2b3a950fa09c798d3fa3e86c4b62c33ba9365eda054e5fe74a41f21b595026acf1093c90a8c71722f91af1ed29a41a2449a320fc7ba3120e3e8c3e4240c04925cc698ecd66c7c906bdf240adad972b4dff4869d400b5d13e33eeba38e075e872b0ed3e91cc9c283867a4ffc3901d2069f",
    /* n */ "c5062b58d8539c765e1e5dbaf14cf75dd56c2e13105fecfd1a930bbb5948ff328f126abe779359ca59bca752c308d281573bc6178b6c0fef7dc445e4f826430437b9f9d790581de5749c2cb9cb26d42b2fee15b6b26f09c99670336423b86bc5bec71113157be2d944d7ff3eebffb28413143ea36755db0ae62ff5b724eecb3d316b6bac67e89cacd8171937e2ab19bd353a89acea8c36f81c89a620d5fd2effea896601c7f9daca7f033f635a3a943331d1b1b4f5288790b53af352f1121ca1bef205f40dc012c412b40bdd27585b946466d75f7ee0a7f9d549b4bece6f43ac3ee65fe7fd37123359d9f1a850ad450aaf5c94eb11dea3fc0fc6e9856b1805ef",
    /*msg*/ "dfc22604b95d15328059745c6c98eb9dfb347cf9f170aff19deeec555f22285a6706c4ecbf0fb1458c60d9bf913fbae6f4c554d245d946b4bc5f34aec2ac6be8b33dc8e0e3a9d601dfd53678f5674443f67df78a3a9e0933e5f158b169ac8d1c4cd0fb872c14ca8e001e542ea0f9cfda88c42dcad8a74097a00c22055b0bd41f",
    /*sig*/ "8b46f2c889d819f860af0a6c4c889e4d1436c6ca174464d22ae11b9ccc265d743c67e569accbc5a80d4dd5f1bf4039e23de52aece40291c75f8936c58c9a2f77a780bbe7ad31eb76742f7b2b8b14ca1a7196af7e673a3cfc237d50f615b75cf4a7ea78a948bedaf9242494b41e1db51f437f15fd2551bb5d24eefb1c3e60f03694d0033a1e0a9b9f5e4ab97d457dff9b9da516dc226d6d6529500308ed74a2e6d9f3c10595788a52a1bc0664aedf33efc8badd037eb7b880772bdb04a6046e9edeee4197c25507fb0f11ab1c9f63f53c8820ea8405cfd7721692475b4d72355fa9a3804f29e6b6a7b059c4441d54b28e4eed2529c6103b5432c71332ce742bcc",
            TestName = "PSS Sign - 2048 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 2048, 25,
    /*sal*/ "b750587671afd76886e8ffb7865e78f706641b2e4251b48706",
    /* d */ "49e5786bb4d332f94586327bde088875379b75d128488f08e574ab4715302a87eea52d4c4a23d8b97af7944804337c5f55e16ba9ffafc0c9fd9b88eca443f39b7967170ddb8ce7ddb93c6087c8066c4a95538a441b9dc80dc9f7810054fd1e5c9d0250c978bb2d748abe1e9465d71a8165d3126dce5db2adacc003e9062ba37a54b63e5f49a4eafebd7e4bf5b0a796c2b3a950fa09c798d3fa3e86c4b62c33ba9365eda054e5fe74a41f21b595026acf1093c90a8c71722f91af1ed29a41a2449a320fc7ba3120e3e8c3e4240c04925cc698ecd66c7c906bdf240adad972b4dff4869d400b5d13e33eeba38e075e872b0ed3e91cc9c283867a4ffc3901d2069f",
    /* n */ "c5062b58d8539c765e1e5dbaf14cf75dd56c2e13105fecfd1a930bbb5948ff328f126abe779359ca59bca752c308d281573bc6178b6c0fef7dc445e4f826430437b9f9d790581de5749c2cb9cb26d42b2fee15b6b26f09c99670336423b86bc5bec71113157be2d944d7ff3eebffb28413143ea36755db0ae62ff5b724eecb3d316b6bac67e89cacd8171937e2ab19bd353a89acea8c36f81c89a620d5fd2effea896601c7f9daca7f033f635a3a943331d1b1b4f5288790b53af352f1121ca1bef205f40dc012c412b40bdd27585b946466d75f7ee0a7f9d549b4bece6f43ac3ee65fe7fd37123359d9f1a850ad450aaf5c94eb11dea3fc0fc6e9856b1805ef",
    /*msg*/ "833aa2b1dcc77607a44e804ee77d45408586c536861f6648adcd2fb65063368767c55c6fe2f237f6404250d75dec8fa68bcaf3b6e561863ae01c91aa23d80c6999a558a4c4cb317d540cde69f829aad674a89812f4d353689f04648c7020a73941620018295a4ae4083590cc603e801867a51c105a7fb319130f1022de44f13e",
    /*sig*/ "2ca37a3d6abd28c1eaf9bde5e7ac17f1fa799ce1b4b899d19985c2ff7c8ba959fe54e5afb8bc4021a1f1c687eebb8cba800d1c51636b1f68dc3e48f63e2da6bc6d09c6668f68e508c5d8c19bef154759e2f89ade152717370a8944f537578296380d1fe6be809e8b113d2b9d89e6a46f5c333d4fd48770fc1ea1c548104575b84cf071042bfe5acf496392be8351a41c46a2cab0864c4c1c5b5e0c7b27e7b88c69f37ffa7e1a8cd98f343ac84a4ad67025a40ed8f664e9d630337de6e48bb2125e2552123609491f183afd92634487f0b2cf971f2626e88858879d45a29b0fefb66cd41b2e4e968385bd9fc8c7211976bc6bd3e1ad6df60856985a825f4726d2",
            TestName = "PSS Sign - 2048 - SHA-384"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 2048, 30,
    /*sal*/ "aa10fec3f83b7a97e092877a5bf9081283f502a0a46b50e395ab983a49ac",
    /* d */ "49e5786bb4d332f94586327bde088875379b75d128488f08e574ab4715302a87eea52d4c4a23d8b97af7944804337c5f55e16ba9ffafc0c9fd9b88eca443f39b7967170ddb8ce7ddb93c6087c8066c4a95538a441b9dc80dc9f7810054fd1e5c9d0250c978bb2d748abe1e9465d71a8165d3126dce5db2adacc003e9062ba37a54b63e5f49a4eafebd7e4bf5b0a796c2b3a950fa09c798d3fa3e86c4b62c33ba9365eda054e5fe74a41f21b595026acf1093c90a8c71722f91af1ed29a41a2449a320fc7ba3120e3e8c3e4240c04925cc698ecd66c7c906bdf240adad972b4dff4869d400b5d13e33eeba38e075e872b0ed3e91cc9c283867a4ffc3901d2069f",
    /* n */ "c5062b58d8539c765e1e5dbaf14cf75dd56c2e13105fecfd1a930bbb5948ff328f126abe779359ca59bca752c308d281573bc6178b6c0fef7dc445e4f826430437b9f9d790581de5749c2cb9cb26d42b2fee15b6b26f09c99670336423b86bc5bec71113157be2d944d7ff3eebffb28413143ea36755db0ae62ff5b724eecb3d316b6bac67e89cacd8171937e2ab19bd353a89acea8c36f81c89a620d5fd2effea896601c7f9daca7f033f635a3a943331d1b1b4f5288790b53af352f1121ca1bef205f40dc012c412b40bdd27585b946466d75f7ee0a7f9d549b4bece6f43ac3ee65fe7fd37123359d9f1a850ad450aaf5c94eb11dea3fc0fc6e9856b1805ef",
    /*msg*/ "5f0fe2afa61b628c43ea3b6ba60567b1ae95f682076f01dfb64de011f25e9c4b3602a78b94cecbc14cd761339d2dc320dba504a3c2dcdedb0a78eb493bb11879c31158e5467795163562ec0ca26c19e0531530a815c28f9b52061076e61f831e2fc45b86631ea7d3271444be5dcb513a3d6de457a72afb67b77db65f9bb1c380",
    /*sig*/ "5e0712bb363e5034ef6b23c119e3b498644445faab5a4c0b4e217e4c832ab34c142d7f81dbf8affdb2dacefabb2f83524c5aa883fc5f06e528b232d90fbea9ca08ae5ac180d477eaed27d137e2b51bd613b69c543d555bfc7cd81a4f795753c8c64c6b5d2acd9e26d6225f5b26e4e66a945fd6477a277b580dbeaa46d0be498df9a093392926c905641945ec5b9597525e449af3743f80554788fc358bc0401a968ff98aaf34e50b352751f32274750ff5c1fba503050204cec9c77deede7f8fa20845d95f5177030bc91d51f26f29d2a65b870dc72b81e5ef9eeef990d7c7145bbf1a3bc7aedd19fa7cbb020756525f1802216c13296fd6aac11bf2d2d90494",
            TestName = "PSS Sign - 2048 - SHA-512"
        )]

        [TestCase(ModeValues.SHA2, DigestSizes.d224, 3072, 28,
    /*sal*/ "3f805057471aab0a28cfc8430dabcf990612e8a908b158ae36b4ed53",
    /* d */ "073a5fc4cd642f6113dffc4f84035cee3a2b8acc549703751a1d6a5eaa13487229a58ef7d7a522bb9f4f25510f1aa0f74c6a8fc8a5c5be8b91a674ede50e92f7e34a90a3c9da999fffb1d695e4588f451256c163484c151350cb9c7825a7d910845ee5cf826fecf9a7c0fbbbba22bb4a531c131d2e7761ba898f002ebef8ab87218511f81d3266e1ec07a7ca8622514c6dfdc86c67679a2c8f5f031de9a0c22b5a88060b46ee0c64d3b9af3c0a379bcd9c6a1b51cf6480456d3fd6def94cd2a6c171dd3f010e3c9d662bc857208248c94ebcb9fd997b9ff4a7e5fd95558569906525e741d78344f6f6cfdbd59d4faa52ee3fa964fb7cccb2d6be1935d211fe1498217716273939a946081fd8509913fd47747c5c2f03efd4d6fc9c6fcfd8402e9f40a0a5b3de3ca2b3c0fac9456938faa6cf2c20e3912e5981c9876d8ca1ff29b87a15eeae0ccce3f8a8f1e405091c083b98bcc5fe0d0deaae33c67c0394437f0eccb385b7efb17aeebba8afaecca30a2f63eac8f0ac8f1eacad85bbcaf3960b",
    /* n */ "a7a1882a7fb896786034d07fb1b9f6327c27bdd7ce6fe39c285ae3b6c34259adc0dc4f7b9c7dec3ca4a20d3407339eedd7a12a421da18f5954673cac2ff059156ecc73c6861ec761e6a0f2a5a033a6768c6a42d8b459e1b4932349e84efd92df59b45935f3d0e30817c66201aa99d07ae36c5d74f408d69cc08f044151ff4960e531360cb19077833adf7bce77ecfaa133c0ccc63c93b856814569e0b9884ee554061b9a20ab46c38263c094dae791aa61a17f8d16f0e85b7e5ce3b067ece89e20bc4e8f1ae814b276d234e04f4e766f501da74ea7e3817c24ea35d016676cece652b823b051625573ca92757fc720d254ecf1dcbbfd21d98307561ecaab545480c7c52ad7e9fa6b597f5fe550559c2fe923205ac1761a99737ca02d7b19822e008a8969349c87fb874c81620e38f613c8521f0381fe5ba55b74827dad3e1cf2aa29c6933629f2b286ad11be88fa6436e7e3f64a75e3595290dc0d1cd5eee7aaac54959cc53bd5a934a365e72dd81a2bd4fb9a67821bffedf2ef2bd94913de8b",
    /*msg*/ "c8ed14895c80a91fda8367cf4aee386b8a378645f06afee72f7c94047fddc7aef84c26c83fef13bf65a3c7750c91967ecc02748fd574b933d5ec21c01c8f178afe6c3356789d0112178e04c3169cfabec6e2621b334f3c6705fc1099a4bd3147a0f7431a4fb1fb80b8ed26a0af38ed93428057d154260fe98854687661919e4e",
    /*sig*/ "27b4f0aa139565fbd7860760610f6866d5b5f0d777921f06f5053291123e3b259d67294ccb8c0d068b8dae360aad2cf7d07296b539e4d2e9b08c343286d522f7dd63c6620e8672be492f3b039f73d88ab9d22a5463cd1f07d688e8ba3fbad531b0c3870ccbfebb596ce4ec643d309744bdbd675d5841284cbac902cfb70ade6d33946d8dc6109bbbc42412db25b8c62222c5ff94f8eb868982265392a44e807474910b4b39558bbef33197907178ce146fdd7e94092ad58bf41a474e626136789fc2fe6374a1b5fefddd5fecb7f8ca5893220d1ab9e822c3ae8adda1ebaddb18a6a12bfc165d12071441a991377cee6dc8e50839497346fee13f12c5b7b6d024b8ecfdad80d5ef6e9e4996ac21c4eb6036bb51f5be5e38f265181154000824e3c1f231d18589ccdaee90fe307ba56324318b5358468e9f3913b83ab8b34d949629ed7839f8da85bdcda52f3da5a419f777b3860dbf2ffe28d96244312549528a20cc7399fc010844365806167fe43235521c909587c2c7b8db4e296dad2aefa2",
            TestName = "PSS Sign - 3072 - SHA-224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 3072, 32,
    /*sal*/ "3e07ade72a3f52530f53135a5d7d93217435ba001ea55a8f5d5d1304684874bc",
    /* d */ "073a5fc4cd642f6113dffc4f84035cee3a2b8acc549703751a1d6a5eaa13487229a58ef7d7a522bb9f4f25510f1aa0f74c6a8fc8a5c5be8b91a674ede50e92f7e34a90a3c9da999fffb1d695e4588f451256c163484c151350cb9c7825a7d910845ee5cf826fecf9a7c0fbbbba22bb4a531c131d2e7761ba898f002ebef8ab87218511f81d3266e1ec07a7ca8622514c6dfdc86c67679a2c8f5f031de9a0c22b5a88060b46ee0c64d3b9af3c0a379bcd9c6a1b51cf6480456d3fd6def94cd2a6c171dd3f010e3c9d662bc857208248c94ebcb9fd997b9ff4a7e5fd95558569906525e741d78344f6f6cfdbd59d4faa52ee3fa964fb7cccb2d6be1935d211fe1498217716273939a946081fd8509913fd47747c5c2f03efd4d6fc9c6fcfd8402e9f40a0a5b3de3ca2b3c0fac9456938faa6cf2c20e3912e5981c9876d8ca1ff29b87a15eeae0ccce3f8a8f1e405091c083b98bcc5fe0d0deaae33c67c0394437f0eccb385b7efb17aeebba8afaecca30a2f63eac8f0ac8f1eacad85bbcaf3960b",
    /* n */ "a7a1882a7fb896786034d07fb1b9f6327c27bdd7ce6fe39c285ae3b6c34259adc0dc4f7b9c7dec3ca4a20d3407339eedd7a12a421da18f5954673cac2ff059156ecc73c6861ec761e6a0f2a5a033a6768c6a42d8b459e1b4932349e84efd92df59b45935f3d0e30817c66201aa99d07ae36c5d74f408d69cc08f044151ff4960e531360cb19077833adf7bce77ecfaa133c0ccc63c93b856814569e0b9884ee554061b9a20ab46c38263c094dae791aa61a17f8d16f0e85b7e5ce3b067ece89e20bc4e8f1ae814b276d234e04f4e766f501da74ea7e3817c24ea35d016676cece652b823b051625573ca92757fc720d254ecf1dcbbfd21d98307561ecaab545480c7c52ad7e9fa6b597f5fe550559c2fe923205ac1761a99737ca02d7b19822e008a8969349c87fb874c81620e38f613c8521f0381fe5ba55b74827dad3e1cf2aa29c6933629f2b286ad11be88fa6436e7e3f64a75e3595290dc0d1cd5eee7aaac54959cc53bd5a934a365e72dd81a2bd4fb9a67821bffedf2ef2bd94913de8b",
    /*msg*/ "c16499110ed577202aed2d3e4d51ded6c66373faef6533a860e1934c63484f87a8d9b92f3ac45197b2909710abba1daf759fe0510e9bd8dd4d73cec961f06ee07acd9d42c6d40dac9f430ef90374a7e944bde5220096737454f96b614d0f6cdd9f08ed529a4ad0e759cf3a023dc8a30b9a872974af9b2af6dc3d111d0feb7006",
    /*sig*/ "4335707da735cfd10411c9c048ca9b60bb46e2fe361e51fbe336f9508dc945afe075503d24f836610f2178996b52c411693052d5d7aed97654a40074ed20ed6689c0501b7fbac21dc46b665ac079760086414406cd66f8537d1ebf0dce4cf0c98d4c30c71da359e9cd401ff49718fdd4d0f99efe70ad8dd8ba1304cefb88f24b0eedf70116da15932c76f0069551a245b5fc3b91ec101f1d63b9853b598c6fa1c1acdbacf9626356c760119be0955644301896d9d0d3ea5e6443cb72ca29f4d45246d16d74d00568c219182feb191179e4593dc152c608fd80536329a533b3a631566814cd654f587c2d8ce696085e6ed1b0b0278e60a049ec7a399f94fccae6462371a69695ef525e00936fa7d9781f9ee289d4105ee827a27996583033cedb2f297e7b4926d906ce0d09d84128406ab33d7da0f8a1d4d2f666568686c394d139b0e5e99337758de85910a5fa25ca2aa6d8fb1c777244e7d98de4c79bbd426a5e6f657e37477e01247432f83797fbf31b50d02b83f69ded26d4945b2bc3f86e",
            TestName = "PSS Sign - 3072 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 3072, 48,
    /*sal*/ "61a762f8968d5f367e2dbcacb4021653dc75437d9000e3169d943729703837a5cbf4de62bdedc95fd0d1004e84751452",
    /* d */ "073a5fc4cd642f6113dffc4f84035cee3a2b8acc549703751a1d6a5eaa13487229a58ef7d7a522bb9f4f25510f1aa0f74c6a8fc8a5c5be8b91a674ede50e92f7e34a90a3c9da999fffb1d695e4588f451256c163484c151350cb9c7825a7d910845ee5cf826fecf9a7c0fbbbba22bb4a531c131d2e7761ba898f002ebef8ab87218511f81d3266e1ec07a7ca8622514c6dfdc86c67679a2c8f5f031de9a0c22b5a88060b46ee0c64d3b9af3c0a379bcd9c6a1b51cf6480456d3fd6def94cd2a6c171dd3f010e3c9d662bc857208248c94ebcb9fd997b9ff4a7e5fd95558569906525e741d78344f6f6cfdbd59d4faa52ee3fa964fb7cccb2d6be1935d211fe1498217716273939a946081fd8509913fd47747c5c2f03efd4d6fc9c6fcfd8402e9f40a0a5b3de3ca2b3c0fac9456938faa6cf2c20e3912e5981c9876d8ca1ff29b87a15eeae0ccce3f8a8f1e405091c083b98bcc5fe0d0deaae33c67c0394437f0eccb385b7efb17aeebba8afaecca30a2f63eac8f0ac8f1eacad85bbcaf3960b",
    /* n */ "a7a1882a7fb896786034d07fb1b9f6327c27bdd7ce6fe39c285ae3b6c34259adc0dc4f7b9c7dec3ca4a20d3407339eedd7a12a421da18f5954673cac2ff059156ecc73c6861ec761e6a0f2a5a033a6768c6a42d8b459e1b4932349e84efd92df59b45935f3d0e30817c66201aa99d07ae36c5d74f408d69cc08f044151ff4960e531360cb19077833adf7bce77ecfaa133c0ccc63c93b856814569e0b9884ee554061b9a20ab46c38263c094dae791aa61a17f8d16f0e85b7e5ce3b067ece89e20bc4e8f1ae814b276d234e04f4e766f501da74ea7e3817c24ea35d016676cece652b823b051625573ca92757fc720d254ecf1dcbbfd21d98307561ecaab545480c7c52ad7e9fa6b597f5fe550559c2fe923205ac1761a99737ca02d7b19822e008a8969349c87fb874c81620e38f613c8521f0381fe5ba55b74827dad3e1cf2aa29c6933629f2b286ad11be88fa6436e7e3f64a75e3595290dc0d1cd5eee7aaac54959cc53bd5a934a365e72dd81a2bd4fb9a67821bffedf2ef2bd94913de8b",
    /*msg*/ "9221f0fe9115843554d5685d9fe69dc49e95ceb5793986e428b8a10b894c01d6af8782fd7d952faf74c2b637ca3b19dabc19a7fe259b2b924eb363a908c5b368f8ab1b2333fc67c30b8ea56b2839dc5bdadefb14ada810bc3e92bac54e2ae1ca1594a4b9d8d19337be421f40e0674e0e9fedb43d3ae89e2ca05d90a68203f2c2",
    /*sig*/ "9687115be478e4b642cd369392b9dd0f3576e704af7218b1f94d7f8fe7f07073e3e8e1186fa768977d6b514e513459f2373df6ec52e3de9bd83fcc5cc3e6b97f8b3fb534163c64f5267620700e9d8c52b3df61a7c3748ef159d6b390895afa3af59109a5478d016d96c49f68dfc735ba2aafd5012c13515ed6644f0d4109c45556e14a3821e1aa24beb8a81a48da27f131de84f7ba51581d81b8ff31ba92b8a1fde867f07e32e6c2709253448174dd31324dbc32b05f07587f76a9997decb80f38d8c13d0f6eb3c10e3d96a2293f7464f1e04602ef6e84c2d0245d7db256a67d132a47cae9abe06b61a8968f50a1749995dc15ef0dcb1d5f5959e4d454c8547bbb4d195698f484617bfd122acaae2d0e8c76d28b24005ab03caa781ea97b1c4d9396a16f7998eee7ddd9de4cabe57032d9438a5d99c6b34a956122350263c7e998bc61dec91381012e686d079e39e96b1ea4bfdb7cdf630ddb422c6b580e5506c9cc3d6c100f2041d17ceaaaa54589249f04a1370ffa3bf3ff1adeb890688698",
            TestName = "PSS Sign - 3072 - SHA-384"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 3072, 62,
    /*sal*/ "2d0c49b20789f39502eefd092a2b6a9b2757c1456147569a685fca4492a8d5b0e6234308385d3d629644ca37e3399616c266f199b6521a9987b2be9ee783",
    /* d */ "073a5fc4cd642f6113dffc4f84035cee3a2b8acc549703751a1d6a5eaa13487229a58ef7d7a522bb9f4f25510f1aa0f74c6a8fc8a5c5be8b91a674ede50e92f7e34a90a3c9da999fffb1d695e4588f451256c163484c151350cb9c7825a7d910845ee5cf826fecf9a7c0fbbbba22bb4a531c131d2e7761ba898f002ebef8ab87218511f81d3266e1ec07a7ca8622514c6dfdc86c67679a2c8f5f031de9a0c22b5a88060b46ee0c64d3b9af3c0a379bcd9c6a1b51cf6480456d3fd6def94cd2a6c171dd3f010e3c9d662bc857208248c94ebcb9fd997b9ff4a7e5fd95558569906525e741d78344f6f6cfdbd59d4faa52ee3fa964fb7cccb2d6be1935d211fe1498217716273939a946081fd8509913fd47747c5c2f03efd4d6fc9c6fcfd8402e9f40a0a5b3de3ca2b3c0fac9456938faa6cf2c20e3912e5981c9876d8ca1ff29b87a15eeae0ccce3f8a8f1e405091c083b98bcc5fe0d0deaae33c67c0394437f0eccb385b7efb17aeebba8afaecca30a2f63eac8f0ac8f1eacad85bbcaf3960b",
    /* n */ "a7a1882a7fb896786034d07fb1b9f6327c27bdd7ce6fe39c285ae3b6c34259adc0dc4f7b9c7dec3ca4a20d3407339eedd7a12a421da18f5954673cac2ff059156ecc73c6861ec761e6a0f2a5a033a6768c6a42d8b459e1b4932349e84efd92df59b45935f3d0e30817c66201aa99d07ae36c5d74f408d69cc08f044151ff4960e531360cb19077833adf7bce77ecfaa133c0ccc63c93b856814569e0b9884ee554061b9a20ab46c38263c094dae791aa61a17f8d16f0e85b7e5ce3b067ece89e20bc4e8f1ae814b276d234e04f4e766f501da74ea7e3817c24ea35d016676cece652b823b051625573ca92757fc720d254ecf1dcbbfd21d98307561ecaab545480c7c52ad7e9fa6b597f5fe550559c2fe923205ac1761a99737ca02d7b19822e008a8969349c87fb874c81620e38f613c8521f0381fe5ba55b74827dad3e1cf2aa29c6933629f2b286ad11be88fa6436e7e3f64a75e3595290dc0d1cd5eee7aaac54959cc53bd5a934a365e72dd81a2bd4fb9a67821bffedf2ef2bd94913de8b",
    /*msg*/ "44240ce519f00239bd66ba03c84d3160b1ce39e3932866e531a62b1c37cf4170c3dc4809236fb1ade181db49fc9c7ccd794b433d1ad0bc056e14738e0ae45c0e155972a40a989fa4b9bcdc308f11990818835fa2c256b47ee4173fb4fed22ccf4385d2dd54d593c74f0004df08134eb8965dd53a122317f59b95d6b69d017958",
    /*sig*/ "8f47abc2326e22cf62404508b442e81ad45afff7274096b9a13e478cdd0a72f99a76bf517f1bb0f872a523d8c588d4402569e948fd6a108ae1a45c65830828a10e94d432765314ba82ead310fc87ac99a5b39f30ab8820bf69e6934a9c1c915c19f36ea7717eaff7af67b4991315b1873ba929bedf18a975be808e7aa14a6726126c79cc93f69541c5cefdeb5b67ec279d8f5a446583e4b4faed1685140ee4b3b757c8ff4a1ef9cd76a88e05319ee62003d2d77290c94c579b0ca2ab0deb3176ef10a3fdb85c80ffbc9e2a665a23744fc836f9a9a103cd9fb756952356a2f1acdd68a645e20179006558b5d4d0b9b0bd3adf5e290f49dae60b9d19920953ea8bb237d5b3dcfe149a60f12a4ee3a889b33bcd3a3b753d610757cbcd093dd5a734255333689695ab636963e3d215a8e77ff31973718a4944a1e9e44f45754d39f6fa431c53f9a2ef36e16a5f70636eb5fba54e15c20a714f2809a7cff4b8dc1165f836607eb5a5a3bb0c4567eee26941fef46fb41e73b565c0cf8c72e404221264",
            TestName = "PSS Sign - 3072 - SHA-512"
        )]
        #endregion SignTests
        public void ShouldSignCorrectly(ModeValues mode, DigestSizes dig, int nlen, int saltLen, string saltHex, string dHex, string nHex, string msgHex, string sigHex)
        {
            var shaFactory = new ShaFactory();
            var sha = shaFactory.GetShaInstance(new HashFunction(mode, dig));
            var signatureBuilder = new SignatureBuilder();
            
            var entropyProvider = new TestableEntropyProvider();
            var salt = new BitString(saltHex);
            entropyProvider.AddEntropy(salt);

            var pssPaddingScheme = new PssPadder(sha, entropyProvider, saltLen);

            var msg = new BitString(msgHex);
            var d = new BitString(dHex).ToPositiveBigInteger();
            var n = new BitString(nHex).ToPositiveBigInteger();
            var pubKey = new PublicKey {N = n};
            var privKey = new PrivateKey {D = d};
            var rsa = new Rsa(new RsaVisitor());

            var result = signatureBuilder
                .WithMessage(msg)
                .WithPublicKey(pubKey)
                .WithPrivateKey(privKey)
                .WithDecryptionScheme(rsa)
                .WithPaddingScheme(pssPaddingScheme)
                .BuildSign();

            Assert.IsTrue(result.Success, result.ErrorMessage);

            var expectedSig = new BitString(sigHex).ToPositiveBigInteger();
            Assert.AreEqual(expectedSig, result.Signature);
        }

        [Test]
        #region VerifyTests
        [TestCase(ModeValues.SHA1, DigestSizes.d160, 1024, 20,
    /*sal*/ "f360c1d564071c0e190602f4e0844d060b1d76ed",
    /* e */ "b413fb",
    /* n */ "9159a115197f9731d661f65392b0a31eee887b10a96a577124f6a97f67a8733f044c7f034b32766831165e8380d0716b0d9af0fdfc6f7199e3be164d16de9d980630651bcd71574a7ac6178eb3758b8e0913a093b08607a0a2d2865a4f0ac22fc2934ed2a8514cfddea9f93c30aa58067e065ab7902bca33f62a3a63e7326f4b",
    /*msg*/ "8af8840be345cce291e43afd51a721efc0cc9ff37b89db2285e88ce9e9d5bbb9a075c900b4bab359a63595ff0e2b6d8881ea22d0b75dc533eddf16ff894d4a28fd5f0b3eed38c19d943b10e46421a1a8ec482669ff4e98c413dfc3ebe7cb0553695c53acd6e67c16239fb2929cb146b6cb8eb3a69b84de3fbd919c954b7875a0",
    /*sig*/ "6751349f6d03a9d85df4d46ed0a35451af42f385f71e1d37b2a38b483d6132775ec2bbd0b1500b068147ff5a2ddb08247cf33c1bb7be8adf2fe116268f6901d720ac5c7d1fed6d8488ee1f8f8f7b655506c973a65adc5ae778b76e8ea603b2354be59d1448607a3894660ffe72ec184f7844d4e0be305d44a5e4b789c37d4dea",
            TestName = "PSS Verify - 1024 - SHA-1"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 1024, 32,
    /*sal*/ "2fc2e1efb311a9bb23844832fe6c5ec60264a98cfbd779e5dac2645d06bb3ad3",
    /* e */ "ba3441",
    /* n */ "a2fc2a7eec2fc9e713174ba20073470f3c8ab9cb7ae40af049f1e72de320c50b9122ade17245afea4dd51aa617643b079b08cb76ad763b78270cd59297578a3d0a183f82af86888fa7128a47be573f1edb5efa034181f593fb6a751b6c55e5b4b2416e9caba7d9b256bee384085c6f3021fdf280779387ca4e104ef55be5cf6d",
    /*msg*/ "9ae479cd428218c7121a7484ae10751869ba2637b80ac4f8e66d15d909f2fa0334af48d0ee61d48be352cd77da804f12e7fb349ae28f2ed117a313fe3f617734b01780d6d0ddf65bcf799a4f967fb99afabd000536d592fa982c588b7a0398b774e4cae8d040a7bf3e568214c956db390ac7327f9c2619fcd0d08d8ba1228613",
    /*sig*/ "314c3bc6dfcb711f6b42c9390fcae2612b87d8eab6e440e5d1952db1ac639b647c3e8030b0a71e7537860602d8d1c64ae793aa2bb241ae28bb05c79775f14ae50f717f34f5f0de8293623da42159d185e9f05fb6ea3215cdce23a9ca484aa10b50505b9069cf9216fe4da761444da70ccfc704dff8cf911e1960c3b94bf0575b",
            TestName = "PSS Verify - 1024 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 1024, 62,
    /*sal*/ "91cc46091eefbe3fe0c04305d26044998b17bba264e96b67dd6a653f3dd3d1487954eb5c57ac4c41d3f86b20c2c86339b578f7d420bed37bbc7f146629e7",
    /* e */ "b47a7b",
    /* n */ "b5707f841ed852407f9db3c280b5b2f39e562777adfc16d8409bc5a8063c0b652551e5146603a505cce9792b3061c71778e0c7531b273b932f6ae16852fea93539659901607990c925b7835b2b6e3dbb8332bea023fdfcc4ff3815b5875bc57079156f201cb8fabf5b1e39c73661741bdb43362f5afea3b1a054a1367578c96d",
    /*msg*/ "58a4b83e58378495670c3ef3e511f4c4d942800992be50088e2168419a0ea9a53b0b53034d92c9c3ea6494d68d21abed7716f1e952560093150c258e270fab8ac7b75db9abf04687e78cbb8611de9ca7a384d6b0a0842cea7b9b381a34d1acb3c451de4abb78844a282cbbe9b96f4f5b23333645c4705d748775a8cf097c348a",
    /*sig*/ "1686959403bffdde62deb8734fe1bfa50cd6d67e082d79bef7d8b87816047bfbe7ac881d89b3273b40ec134bc1ac14063818895259bd19a6cacbe94900a2784e7b21cbc96964d9508e67ff229a912fc87a96ec4822d4641a99695eea21c8fa972ed16e5f29dcef48673715dcd47c70e1d5bae6dd65c4ed108231e70f8ce8d1c1",
            TestName = "PSS Verify - 1024 - SHA-512"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d224, 2048, 15,
    /*sal*/ "463729b3eaf43502d9cff129925681",
    /* e */ "86c94f",
    /* n */ "c5062b58d8539c765e1e5dbaf14cf75dd56c2e13105fecfd1a930bbb5948ff328f126abe779359ca59bca752c308d281573bc6178b6c0fef7dc445e4f826430437b9f9d790581de5749c2cb9cb26d42b2fee15b6b26f09c99670336423b86bc5bec71113157be2d944d7ff3eebffb28413143ea36755db0ae62ff5b724eecb3d316b6bac67e89cacd8171937e2ab19bd353a89acea8c36f81c89a620d5fd2effea896601c7f9daca7f033f635a3a943331d1b1b4f5288790b53af352f1121ca1bef205f40dc012c412b40bdd27585b946466d75f7ee0a7f9d549b4bece6f43ac3ee65fe7fd37123359d9f1a850ad450aaf5c94eb11dea3fc0fc6e9856b1805ef",
    /*msg*/ "37ddd9901478ae5c16878702cea4a19e786d35582de44ae65a16cd5370fbe3ffdd9e7ee83c7d2f27c8333bbe1754f090059939b1ee3d71e020a675528f48fdb2cbc72c65305b65125c796162e7b07e044ed15af52f52a1febcf4237e6aa42a69e99f0a9159daf924bba12176a57ef4013a5cc0ab5aec83471648005d67d7122e",
    /*sig*/ "7e628bcbe6ff83a937b8961197d8bdbb322818aa8bdf30cdfb67ca6bf025ef6f09a99dba4c3ee2807d0b7c77776cfeff33b68d7e3fa859c4688626b2441897d26e5d6b559dd72a596e7dad7def9278419db375f7c67cee0740394502212ebdd4a6c8d3af6ee2fd696d8523de6908492b7cbf2254f15a348956c19840dc15a3d732ef862b62ede022290de3af11ca5e79a3392fff06f75aca8c88a2de1858b35a216d8f73fd70e9d67958ed39a6f8976fb94ec6e61f238a52f9d42241e8354f89e3ece94d6fa5bfbba1eeb70e1698bff31a685fbe799fb44efe21338ed6eea2129155aabc0943bc9f69a8e58897db6a8abcc2879d5d0c5d3e6dc5eb48cf16dac8",
            TestName = "PSS Verify - 2048 - SHA-224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 2048, 20,
    /*sal*/ "e1256fc1eeef81773fdd54657e4007fde6bcb9b1",
    /* e */ "86c94f",
    /* n */ "c5062b58d8539c765e1e5dbaf14cf75dd56c2e13105fecfd1a930bbb5948ff328f126abe779359ca59bca752c308d281573bc6178b6c0fef7dc445e4f826430437b9f9d790581de5749c2cb9cb26d42b2fee15b6b26f09c99670336423b86bc5bec71113157be2d944d7ff3eebffb28413143ea36755db0ae62ff5b724eecb3d316b6bac67e89cacd8171937e2ab19bd353a89acea8c36f81c89a620d5fd2effea896601c7f9daca7f033f635a3a943331d1b1b4f5288790b53af352f1121ca1bef205f40dc012c412b40bdd27585b946466d75f7ee0a7f9d549b4bece6f43ac3ee65fe7fd37123359d9f1a850ad450aaf5c94eb11dea3fc0fc6e9856b1805ef",
    /*msg*/ "dfc22604b95d15328059745c6c98eb9dfb347cf9f170aff19deeec555f22285a6706c4ecbf0fb1458c60d9bf913fbae6f4c554d245d946b4bc5f34aec2ac6be8b33dc8e0e3a9d601dfd53678f5674443f67df78a3a9e0933e5f158b169ac8d1c4cd0fb872c14ca8e001e542ea0f9cfda88c42dcad8a74097a00c22055b0bd41f",
    /*sig*/ "8b46f2c889d819f860af0a6c4c889e4d1436c6ca174464d22ae11b9ccc265d743c67e569accbc5a80d4dd5f1bf4039e23de52aece40291c75f8936c58c9a2f77a780bbe7ad31eb76742f7b2b8b14ca1a7196af7e673a3cfc237d50f615b75cf4a7ea78a948bedaf9242494b41e1db51f437f15fd2551bb5d24eefb1c3e60f03694d0033a1e0a9b9f5e4ab97d457dff9b9da516dc226d6d6529500308ed74a2e6d9f3c10595788a52a1bc0664aedf33efc8badd037eb7b880772bdb04a6046e9edeee4197c25507fb0f11ab1c9f63f53c8820ea8405cfd7721692475b4d72355fa9a3804f29e6b6a7b059c4441d54b28e4eed2529c6103b5432c71332ce742bcc",
            TestName = "PSS Verify - 2048 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 2048, 25,
    /*sal*/ "b750587671afd76886e8ffb7865e78f706641b2e4251b48706",
    /* e */ "86c94f",
    /* n */ "c5062b58d8539c765e1e5dbaf14cf75dd56c2e13105fecfd1a930bbb5948ff328f126abe779359ca59bca752c308d281573bc6178b6c0fef7dc445e4f826430437b9f9d790581de5749c2cb9cb26d42b2fee15b6b26f09c99670336423b86bc5bec71113157be2d944d7ff3eebffb28413143ea36755db0ae62ff5b724eecb3d316b6bac67e89cacd8171937e2ab19bd353a89acea8c36f81c89a620d5fd2effea896601c7f9daca7f033f635a3a943331d1b1b4f5288790b53af352f1121ca1bef205f40dc012c412b40bdd27585b946466d75f7ee0a7f9d549b4bece6f43ac3ee65fe7fd37123359d9f1a850ad450aaf5c94eb11dea3fc0fc6e9856b1805ef",
    /*msg*/ "833aa2b1dcc77607a44e804ee77d45408586c536861f6648adcd2fb65063368767c55c6fe2f237f6404250d75dec8fa68bcaf3b6e561863ae01c91aa23d80c6999a558a4c4cb317d540cde69f829aad674a89812f4d353689f04648c7020a73941620018295a4ae4083590cc603e801867a51c105a7fb319130f1022de44f13e",
    /*sig*/ "2ca37a3d6abd28c1eaf9bde5e7ac17f1fa799ce1b4b899d19985c2ff7c8ba959fe54e5afb8bc4021a1f1c687eebb8cba800d1c51636b1f68dc3e48f63e2da6bc6d09c6668f68e508c5d8c19bef154759e2f89ade152717370a8944f537578296380d1fe6be809e8b113d2b9d89e6a46f5c333d4fd48770fc1ea1c548104575b84cf071042bfe5acf496392be8351a41c46a2cab0864c4c1c5b5e0c7b27e7b88c69f37ffa7e1a8cd98f343ac84a4ad67025a40ed8f664e9d630337de6e48bb2125e2552123609491f183afd92634487f0b2cf971f2626e88858879d45a29b0fefb66cd41b2e4e968385bd9fc8c7211976bc6bd3e1ad6df60856985a825f4726d2",
            TestName = "PSS Verify - 2048 - SHA-384"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 2048, 30,
    /*sal*/ "aa10fec3f83b7a97e092877a5bf9081283f502a0a46b50e395ab983a49ac",
    /* e */ "86c94f",
    /* n */ "c5062b58d8539c765e1e5dbaf14cf75dd56c2e13105fecfd1a930bbb5948ff328f126abe779359ca59bca752c308d281573bc6178b6c0fef7dc445e4f826430437b9f9d790581de5749c2cb9cb26d42b2fee15b6b26f09c99670336423b86bc5bec71113157be2d944d7ff3eebffb28413143ea36755db0ae62ff5b724eecb3d316b6bac67e89cacd8171937e2ab19bd353a89acea8c36f81c89a620d5fd2effea896601c7f9daca7f033f635a3a943331d1b1b4f5288790b53af352f1121ca1bef205f40dc012c412b40bdd27585b946466d75f7ee0a7f9d549b4bece6f43ac3ee65fe7fd37123359d9f1a850ad450aaf5c94eb11dea3fc0fc6e9856b1805ef",
    /*msg*/ "5f0fe2afa61b628c43ea3b6ba60567b1ae95f682076f01dfb64de011f25e9c4b3602a78b94cecbc14cd761339d2dc320dba504a3c2dcdedb0a78eb493bb11879c31158e5467795163562ec0ca26c19e0531530a815c28f9b52061076e61f831e2fc45b86631ea7d3271444be5dcb513a3d6de457a72afb67b77db65f9bb1c380",
    /*sig*/ "5e0712bb363e5034ef6b23c119e3b498644445faab5a4c0b4e217e4c832ab34c142d7f81dbf8affdb2dacefabb2f83524c5aa883fc5f06e528b232d90fbea9ca08ae5ac180d477eaed27d137e2b51bd613b69c543d555bfc7cd81a4f795753c8c64c6b5d2acd9e26d6225f5b26e4e66a945fd6477a277b580dbeaa46d0be498df9a093392926c905641945ec5b9597525e449af3743f80554788fc358bc0401a968ff98aaf34e50b352751f32274750ff5c1fba503050204cec9c77deede7f8fa20845d95f5177030bc91d51f26f29d2a65b870dc72b81e5ef9eeef990d7c7145bbf1a3bc7aedd19fa7cbb020756525f1802216c13296fd6aac11bf2d2d90494",
            TestName = "PSS Verify - 2048 - SHA-512"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d224, 3072, 28,
    /*sal*/ "3f805057471aab0a28cfc8430dabcf990612e8a908b158ae36b4ed53",
    /* e */ "1415a7",
    /* n */ "a7a1882a7fb896786034d07fb1b9f6327c27bdd7ce6fe39c285ae3b6c34259adc0dc4f7b9c7dec3ca4a20d3407339eedd7a12a421da18f5954673cac2ff059156ecc73c6861ec761e6a0f2a5a033a6768c6a42d8b459e1b4932349e84efd92df59b45935f3d0e30817c66201aa99d07ae36c5d74f408d69cc08f044151ff4960e531360cb19077833adf7bce77ecfaa133c0ccc63c93b856814569e0b9884ee554061b9a20ab46c38263c094dae791aa61a17f8d16f0e85b7e5ce3b067ece89e20bc4e8f1ae814b276d234e04f4e766f501da74ea7e3817c24ea35d016676cece652b823b051625573ca92757fc720d254ecf1dcbbfd21d98307561ecaab545480c7c52ad7e9fa6b597f5fe550559c2fe923205ac1761a99737ca02d7b19822e008a8969349c87fb874c81620e38f613c8521f0381fe5ba55b74827dad3e1cf2aa29c6933629f2b286ad11be88fa6436e7e3f64a75e3595290dc0d1cd5eee7aaac54959cc53bd5a934a365e72dd81a2bd4fb9a67821bffedf2ef2bd94913de8b",
    /*msg*/ "c8ed14895c80a91fda8367cf4aee386b8a378645f06afee72f7c94047fddc7aef84c26c83fef13bf65a3c7750c91967ecc02748fd574b933d5ec21c01c8f178afe6c3356789d0112178e04c3169cfabec6e2621b334f3c6705fc1099a4bd3147a0f7431a4fb1fb80b8ed26a0af38ed93428057d154260fe98854687661919e4e",
    /*sig*/ "27b4f0aa139565fbd7860760610f6866d5b5f0d777921f06f5053291123e3b259d67294ccb8c0d068b8dae360aad2cf7d07296b539e4d2e9b08c343286d522f7dd63c6620e8672be492f3b039f73d88ab9d22a5463cd1f07d688e8ba3fbad531b0c3870ccbfebb596ce4ec643d309744bdbd675d5841284cbac902cfb70ade6d33946d8dc6109bbbc42412db25b8c62222c5ff94f8eb868982265392a44e807474910b4b39558bbef33197907178ce146fdd7e94092ad58bf41a474e626136789fc2fe6374a1b5fefddd5fecb7f8ca5893220d1ab9e822c3ae8adda1ebaddb18a6a12bfc165d12071441a991377cee6dc8e50839497346fee13f12c5b7b6d024b8ecfdad80d5ef6e9e4996ac21c4eb6036bb51f5be5e38f265181154000824e3c1f231d18589ccdaee90fe307ba56324318b5358468e9f3913b83ab8b34d949629ed7839f8da85bdcda52f3da5a419f777b3860dbf2ffe28d96244312549528a20cc7399fc010844365806167fe43235521c909587c2c7b8db4e296dad2aefa2",
            TestName = "PSS Verify - 3072 - SHA-224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 3072, 32,
    /*sal*/ "3e07ade72a3f52530f53135a5d7d93217435ba001ea55a8f5d5d1304684874bc",
    /* e */ "1415a7",
    /* n */ "a7a1882a7fb896786034d07fb1b9f6327c27bdd7ce6fe39c285ae3b6c34259adc0dc4f7b9c7dec3ca4a20d3407339eedd7a12a421da18f5954673cac2ff059156ecc73c6861ec761e6a0f2a5a033a6768c6a42d8b459e1b4932349e84efd92df59b45935f3d0e30817c66201aa99d07ae36c5d74f408d69cc08f044151ff4960e531360cb19077833adf7bce77ecfaa133c0ccc63c93b856814569e0b9884ee554061b9a20ab46c38263c094dae791aa61a17f8d16f0e85b7e5ce3b067ece89e20bc4e8f1ae814b276d234e04f4e766f501da74ea7e3817c24ea35d016676cece652b823b051625573ca92757fc720d254ecf1dcbbfd21d98307561ecaab545480c7c52ad7e9fa6b597f5fe550559c2fe923205ac1761a99737ca02d7b19822e008a8969349c87fb874c81620e38f613c8521f0381fe5ba55b74827dad3e1cf2aa29c6933629f2b286ad11be88fa6436e7e3f64a75e3595290dc0d1cd5eee7aaac54959cc53bd5a934a365e72dd81a2bd4fb9a67821bffedf2ef2bd94913de8b",
    /*msg*/ "c16499110ed577202aed2d3e4d51ded6c66373faef6533a860e1934c63484f87a8d9b92f3ac45197b2909710abba1daf759fe0510e9bd8dd4d73cec961f06ee07acd9d42c6d40dac9f430ef90374a7e944bde5220096737454f96b614d0f6cdd9f08ed529a4ad0e759cf3a023dc8a30b9a872974af9b2af6dc3d111d0feb7006",
    /*sig*/ "4335707da735cfd10411c9c048ca9b60bb46e2fe361e51fbe336f9508dc945afe075503d24f836610f2178996b52c411693052d5d7aed97654a40074ed20ed6689c0501b7fbac21dc46b665ac079760086414406cd66f8537d1ebf0dce4cf0c98d4c30c71da359e9cd401ff49718fdd4d0f99efe70ad8dd8ba1304cefb88f24b0eedf70116da15932c76f0069551a245b5fc3b91ec101f1d63b9853b598c6fa1c1acdbacf9626356c760119be0955644301896d9d0d3ea5e6443cb72ca29f4d45246d16d74d00568c219182feb191179e4593dc152c608fd80536329a533b3a631566814cd654f587c2d8ce696085e6ed1b0b0278e60a049ec7a399f94fccae6462371a69695ef525e00936fa7d9781f9ee289d4105ee827a27996583033cedb2f297e7b4926d906ce0d09d84128406ab33d7da0f8a1d4d2f666568686c394d139b0e5e99337758de85910a5fa25ca2aa6d8fb1c777244e7d98de4c79bbd426a5e6f657e37477e01247432f83797fbf31b50d02b83f69ded26d4945b2bc3f86e",
            TestName = "PSS Verify - 3072 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 3072, 48,
    /*sal*/ "61a762f8968d5f367e2dbcacb4021653dc75437d9000e3169d943729703837a5cbf4de62bdedc95fd0d1004e84751452",
    /* e */ "1415a7",
    /* n */ "a7a1882a7fb896786034d07fb1b9f6327c27bdd7ce6fe39c285ae3b6c34259adc0dc4f7b9c7dec3ca4a20d3407339eedd7a12a421da18f5954673cac2ff059156ecc73c6861ec761e6a0f2a5a033a6768c6a42d8b459e1b4932349e84efd92df59b45935f3d0e30817c66201aa99d07ae36c5d74f408d69cc08f044151ff4960e531360cb19077833adf7bce77ecfaa133c0ccc63c93b856814569e0b9884ee554061b9a20ab46c38263c094dae791aa61a17f8d16f0e85b7e5ce3b067ece89e20bc4e8f1ae814b276d234e04f4e766f501da74ea7e3817c24ea35d016676cece652b823b051625573ca92757fc720d254ecf1dcbbfd21d98307561ecaab545480c7c52ad7e9fa6b597f5fe550559c2fe923205ac1761a99737ca02d7b19822e008a8969349c87fb874c81620e38f613c8521f0381fe5ba55b74827dad3e1cf2aa29c6933629f2b286ad11be88fa6436e7e3f64a75e3595290dc0d1cd5eee7aaac54959cc53bd5a934a365e72dd81a2bd4fb9a67821bffedf2ef2bd94913de8b",
    /*msg*/ "9221f0fe9115843554d5685d9fe69dc49e95ceb5793986e428b8a10b894c01d6af8782fd7d952faf74c2b637ca3b19dabc19a7fe259b2b924eb363a908c5b368f8ab1b2333fc67c30b8ea56b2839dc5bdadefb14ada810bc3e92bac54e2ae1ca1594a4b9d8d19337be421f40e0674e0e9fedb43d3ae89e2ca05d90a68203f2c2",
    /*sig*/ "9687115be478e4b642cd369392b9dd0f3576e704af7218b1f94d7f8fe7f07073e3e8e1186fa768977d6b514e513459f2373df6ec52e3de9bd83fcc5cc3e6b97f8b3fb534163c64f5267620700e9d8c52b3df61a7c3748ef159d6b390895afa3af59109a5478d016d96c49f68dfc735ba2aafd5012c13515ed6644f0d4109c45556e14a3821e1aa24beb8a81a48da27f131de84f7ba51581d81b8ff31ba92b8a1fde867f07e32e6c2709253448174dd31324dbc32b05f07587f76a9997decb80f38d8c13d0f6eb3c10e3d96a2293f7464f1e04602ef6e84c2d0245d7db256a67d132a47cae9abe06b61a8968f50a1749995dc15ef0dcb1d5f5959e4d454c8547bbb4d195698f484617bfd122acaae2d0e8c76d28b24005ab03caa781ea97b1c4d9396a16f7998eee7ddd9de4cabe57032d9438a5d99c6b34a956122350263c7e998bc61dec91381012e686d079e39e96b1ea4bfdb7cdf630ddb422c6b580e5506c9cc3d6c100f2041d17ceaaaa54589249f04a1370ffa3bf3ff1adeb890688698",
            TestName = "PSS Verify - 3072 - SHA-384"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 3072, 62,
    /*sal*/ "2d0c49b20789f39502eefd092a2b6a9b2757c1456147569a685fca4492a8d5b0e6234308385d3d629644ca37e3399616c266f199b6521a9987b2be9ee783",
    /* e */ "1415a7",
    /* n */ "a7a1882a7fb896786034d07fb1b9f6327c27bdd7ce6fe39c285ae3b6c34259adc0dc4f7b9c7dec3ca4a20d3407339eedd7a12a421da18f5954673cac2ff059156ecc73c6861ec761e6a0f2a5a033a6768c6a42d8b459e1b4932349e84efd92df59b45935f3d0e30817c66201aa99d07ae36c5d74f408d69cc08f044151ff4960e531360cb19077833adf7bce77ecfaa133c0ccc63c93b856814569e0b9884ee554061b9a20ab46c38263c094dae791aa61a17f8d16f0e85b7e5ce3b067ece89e20bc4e8f1ae814b276d234e04f4e766f501da74ea7e3817c24ea35d016676cece652b823b051625573ca92757fc720d254ecf1dcbbfd21d98307561ecaab545480c7c52ad7e9fa6b597f5fe550559c2fe923205ac1761a99737ca02d7b19822e008a8969349c87fb874c81620e38f613c8521f0381fe5ba55b74827dad3e1cf2aa29c6933629f2b286ad11be88fa6436e7e3f64a75e3595290dc0d1cd5eee7aaac54959cc53bd5a934a365e72dd81a2bd4fb9a67821bffedf2ef2bd94913de8b",
    /*msg*/ "44240ce519f00239bd66ba03c84d3160b1ce39e3932866e531a62b1c37cf4170c3dc4809236fb1ade181db49fc9c7ccd794b433d1ad0bc056e14738e0ae45c0e155972a40a989fa4b9bcdc308f11990818835fa2c256b47ee4173fb4fed22ccf4385d2dd54d593c74f0004df08134eb8965dd53a122317f59b95d6b69d017958",
    /*sig*/ "8f47abc2326e22cf62404508b442e81ad45afff7274096b9a13e478cdd0a72f99a76bf517f1bb0f872a523d8c588d4402569e948fd6a108ae1a45c65830828a10e94d432765314ba82ead310fc87ac99a5b39f30ab8820bf69e6934a9c1c915c19f36ea7717eaff7af67b4991315b1873ba929bedf18a975be808e7aa14a6726126c79cc93f69541c5cefdeb5b67ec279d8f5a446583e4b4faed1685140ee4b3b757c8ff4a1ef9cd76a88e05319ee62003d2d77290c94c579b0ca2ab0deb3176ef10a3fdb85c80ffbc9e2a665a23744fc836f9a9a103cd9fb756952356a2f1acdd68a645e20179006558b5d4d0b9b0bd3adf5e290f49dae60b9d19920953ea8bb237d5b3dcfe149a60f12a4ee3a889b33bcd3a3b753d610757cbcd093dd5a734255333689695ab636963e3d215a8e77ff31973718a4944a1e9e44f45754d39f6fa431c53f9a2ef36e16a5f70636eb5fba54e15c20a714f2809a7cff4b8dc1165f836607eb5a5a3bb0c4567eee26941fef46fb41e73b565c0cf8c72e404221264",
            TestName = "PSS Verify - 3072 - SHA-512"
        )]
        #endregion VerifyTests
        public void ShouldVerifyCorrectly(ModeValues mode, DigestSizes dig, int nlen, int saltLen, string saltHex, string eHex, string nHex, string msgHex, string sigHex)
        {
            var shaFactory = new ShaFactory();
            var sha = shaFactory.GetShaInstance(new HashFunction(mode, dig));
            var signatureBuilder = new SignatureBuilder();
            
            var entropyProvider = new TestableEntropyProvider();
            var salt = new BitString(saltHex);
            entropyProvider.AddEntropy(salt);

            var pssPaddingScheme = new PssPadder(sha, entropyProvider, saltLen);

            var msg = new BitString(msgHex);
            var e = new BitString(eHex).ToPositiveBigInteger();
            var n = new BitString(nHex).ToPositiveBigInteger();
            var pubKey = new PublicKey {N = n, E = e};
            var sig = new BitString(sigHex);
            var rsa = new Rsa(new RsaVisitor());

            var result = signatureBuilder
                .WithMessage(msg)
                .WithSignature(sig)
                .WithPublicKey(pubKey)
                .WithDecryptionScheme(rsa)
                .WithPaddingScheme(pssPaddingScheme)
                .BuildVerify();

            Assert.IsTrue(result.Success, result.ErrorMessage);
        }
    }
}
