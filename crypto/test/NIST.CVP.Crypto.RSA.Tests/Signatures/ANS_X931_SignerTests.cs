using NUnit.Framework;
using System;
using System.Collections.Generic;
using System.Text;
using NIST.CVP.Tests.Core.TestCategoryAttributes;
using NIST.CVP.Crypto.RSA.Signatures;
using NIST.CVP.Crypto.SHA2;
using NIST.CVP.Math;

namespace NIST.CVP.Crypto.RSA.Tests.Signatures
{
    [TestFixture, FastIntegrationTest]
    public class ANS_X931_SignerTests
    {
        [Test]
        [TestCase(ModeValues.SHA2, DigestSizes.d224, 2048,
            "f3e7af",
            "19f9641ecc4e21405d238542fc633a35a33f3ddc84dfb8dc000c27bdfbb5128c0ae3b561ca615aabf7223824d6415a8a6285ca781683aa76ab9c8542dc02bc50ce60770246fa565a1975f6ce508d3cfc30b24b7eccc02183c5bf6a9b7900d621cb3e97fe57031574ab9e54b0eb2040415262cb7f354e032c39453ac38c51d9f9d98bccde0b866d5bbb4013b84054d55ecf8677a3af7308898ef03d30c796cb020aab69002ac00e820fd0bdb176c20589eee572f8699c27353dea73f7ea9b6c83a55d05f7eec7bb77244f11895ff0f462893ead61d8e51c55eea2ffc5b522c0b86fcde09c785f418570d071ddd39d8c3c3a05d80ef51a081ed3749180b973f24f",
            "a674f0f2a01fa0a987d0ef355f36cbd7eda5a931d5eca30b18fc237a481fcea435fe514166db877ca1e645204b0e1e2a8e5f7fcf28a98306c70424f0f4025c7d8c6d89063ac7847bf52eb1f2852bdd5cc03c1cbf63875b5062f4d22b290526a5fecfe343d39c3b46626b63e91670802b4d7a066973474a757d3e5957ddc020afddbeef963643b237651f7bd58d9af4ea67da7de5620539fb904c5a0243388498013470de777c8f11924add97fa1fb11b51cab46ea38adf995ad5efd0958a98cbf022dfb0d4b128917e4b513f120629051307b4d9d1014a28c55c93aaff59f47a7c0472a8b7a1ad5dbf07252c4b2602278fe18a77ec8acb8798f9f8b720dafe03",
            "d20fca706b61bc2ad3ac90c7e8e6bcfd5c871f39b8862c34a0854bc758497c00876c3e753b56afd82e69f4cc487cdbf7648bbf5957acaddc2e45c42cb87de2c845f07d5aaca7ce449347357bea88d998b9e98f2c1ca3fd548bdbff8e5f1b49cb92034ec6c73c61938aae1a7bd8f3fc07e20b545b0e5164c53fadc196560cfa31",
            "3b3312298cf3d8d027053d2dab5810d74794073b33d51b40963ae8dd46d8a3c338407f0476746069e72a316581a82d3b5647c3255a77fffa318c75995343548d5eb16e43941b54235d88b1050997ba841dff679a83fe2f85cd6f4807e923a3d1fdb5a8d80fe472d012b262360da3b9dfd43d42333f135227da6428eb3ee470427bd045cb2cf63b6b62f7f10a8dfe597628e2aa9df29d87bc7122078fc6cb5e4e4976fa96546bcfa6d7f5157f7801bc8eaff9a76e304e165fe11676e66981dc5ea2810e74a72382a91259ab36e0ac89adfa0cbce171b6179ec0bdfe07fd7f66ed70acab274ce572e3c2a8d5954f9c6885a2a7e46fe7b471e6c0672bf690257912"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 2048,
            "f3e7af",
            "19f9641ecc4e21405d238542fc633a35a33f3ddc84dfb8dc000c27bdfbb5128c0ae3b561ca615aabf7223824d6415a8a6285ca781683aa76ab9c8542dc02bc50ce60770246fa565a1975f6ce508d3cfc30b24b7eccc02183c5bf6a9b7900d621cb3e97fe57031574ab9e54b0eb2040415262cb7f354e032c39453ac38c51d9f9d98bccde0b866d5bbb4013b84054d55ecf8677a3af7308898ef03d30c796cb020aab69002ac00e820fd0bdb176c20589eee572f8699c27353dea73f7ea9b6c83a55d05f7eec7bb77244f11895ff0f462893ead61d8e51c55eea2ffc5b522c0b86fcde09c785f418570d071ddd39d8c3c3a05d80ef51a081ed3749180b973f24f",
            "a674f0f2a01fa0a987d0ef355f36cbd7eda5a931d5eca30b18fc237a481fcea435fe514166db877ca1e645204b0e1e2a8e5f7fcf28a98306c70424f0f4025c7d8c6d89063ac7847bf52eb1f2852bdd5cc03c1cbf63875b5062f4d22b290526a5fecfe343d39c3b46626b63e91670802b4d7a066973474a757d3e5957ddc020afddbeef963643b237651f7bd58d9af4ea67da7de5620539fb904c5a0243388498013470de777c8f11924add97fa1fb11b51cab46ea38adf995ad5efd0958a98cbf022dfb0d4b128917e4b513f120629051307b4d9d1014a28c55c93aaff59f47a7c0472a8b7a1ad5dbf07252c4b2602278fe18a77ec8acb8798f9f8b720dafe03",
            "f648ffc4ed74845803fec53ba865d3889b3892e402d96c5eba814698ec84b32ce1d7684917cff19d942ba2787a55cf2edce540bdd067dfafc55eb442178913c7e164144813f2446dc4ba9aa0c90fad708695233304016df04420b27cd31b08e29ff9ea080965e7903bb297fdbc1cd31741512590c7307ee7ded0278d48c4fa47",
            "4d4ea9c758775fa7e90977ac8ef2249be7a8c3f2288ef36b59f9efe8b0175f5a7405970cc1884820fc9adbadf7b17cb258293b0cfcea119bacd5f7e1de4aa99757d2cb65bd21f58adaef0754bf84e84dfc05ce1ea9fe40dcb5cf8221ce1a4a99acde9e84a2214b7a3e57d7b92d59a003b83af7b0108e9ee6c73580004244506ef3cab5bd1ddfc319a474492645b1815349f77a9f581b5f1b84e5ea03f48f2f12fffeb62e84535094277544dabe3e119b42e46f16f579b3c4d9dea86cbd616ba2e04706072293cd7eabcd667ee06bacb435004f3e8be90727e44416b6be1672ef465e01645ea38f4f899c6f6ac5f8c5c6cebdec629a00df53a923d3359821ea4d"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 2048,
            "f3e7af",
            "19f9641ecc4e21405d238542fc633a35a33f3ddc84dfb8dc000c27bdfbb5128c0ae3b561ca615aabf7223824d6415a8a6285ca781683aa76ab9c8542dc02bc50ce60770246fa565a1975f6ce508d3cfc30b24b7eccc02183c5bf6a9b7900d621cb3e97fe57031574ab9e54b0eb2040415262cb7f354e032c39453ac38c51d9f9d98bccde0b866d5bbb4013b84054d55ecf8677a3af7308898ef03d30c796cb020aab69002ac00e820fd0bdb176c20589eee572f8699c27353dea73f7ea9b6c83a55d05f7eec7bb77244f11895ff0f462893ead61d8e51c55eea2ffc5b522c0b86fcde09c785f418570d071ddd39d8c3c3a05d80ef51a081ed3749180b973f24f",
            "a674f0f2a01fa0a987d0ef355f36cbd7eda5a931d5eca30b18fc237a481fcea435fe514166db877ca1e645204b0e1e2a8e5f7fcf28a98306c70424f0f4025c7d8c6d89063ac7847bf52eb1f2852bdd5cc03c1cbf63875b5062f4d22b290526a5fecfe343d39c3b46626b63e91670802b4d7a066973474a757d3e5957ddc020afddbeef963643b237651f7bd58d9af4ea67da7de5620539fb904c5a0243388498013470de777c8f11924add97fa1fb11b51cab46ea38adf995ad5efd0958a98cbf022dfb0d4b128917e4b513f120629051307b4d9d1014a28c55c93aaff59f47a7c0472a8b7a1ad5dbf07252c4b2602278fe18a77ec8acb8798f9f8b720dafe03",
            "ccd28fa083c6a9af7d9d12e6c549c7ddd95ae4d35417675acace3751f46865130d40b1ee7b3650d7b2ffec5b56bfedd99fd9f7ef0205b3320ea4d3229451505d0ab9f61231ac23b9f674cc019665c00a06b531d5928e70f9c462f897877fae8f8ce367f4ed51abbe11a4b9bfcf64cad9d6979a6d4cd92516b5afae9817190613",
            "4f537f706692d2c45c9623a60c22d00278a027d8fc162fc52aa7f74051aa0028581f041040f5b7e6899e7c5b67a5b1ff605aedebaf70d7d965896cb20b1d01d810fc6c06baa33c38340aa65b29d0d0fb81eac9a92738cfcd714b3791e371ac4a05339d0dd9ff116ed6173b115889d80a34ce9a9ad9e8b67ff88d72fc8ca8847c4106b596e115e566188cdb69e6b199929043af1d5a29c28f377c67bf0a073ad5200bf5d2af8b9a6e2b0b7d3fbce42c1ece60f1bed3c997b17d6dba726e0e859568565b13385c92d1965543c6fbd2761fee2fbf8130b2a0e877affa4f30289d0d173c218d04accd987463dff81f00a812966d09fe843f5913cd6ba9b72e0d5080"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 2048,
            "f3e7af",
            "19f9641ecc4e21405d238542fc633a35a33f3ddc84dfb8dc000c27bdfbb5128c0ae3b561ca615aabf7223824d6415a8a6285ca781683aa76ab9c8542dc02bc50ce60770246fa565a1975f6ce508d3cfc30b24b7eccc02183c5bf6a9b7900d621cb3e97fe57031574ab9e54b0eb2040415262cb7f354e032c39453ac38c51d9f9d98bccde0b866d5bbb4013b84054d55ecf8677a3af7308898ef03d30c796cb020aab69002ac00e820fd0bdb176c20589eee572f8699c27353dea73f7ea9b6c83a55d05f7eec7bb77244f11895ff0f462893ead61d8e51c55eea2ffc5b522c0b86fcde09c785f418570d071ddd39d8c3c3a05d80ef51a081ed3749180b973f24f",
            "a674f0f2a01fa0a987d0ef355f36cbd7eda5a931d5eca30b18fc237a481fcea435fe514166db877ca1e645204b0e1e2a8e5f7fcf28a98306c70424f0f4025c7d8c6d89063ac7847bf52eb1f2852bdd5cc03c1cbf63875b5062f4d22b290526a5fecfe343d39c3b46626b63e91670802b4d7a066973474a757d3e5957ddc020afddbeef963643b237651f7bd58d9af4ea67da7de5620539fb904c5a0243388498013470de777c8f11924add97fa1fb11b51cab46ea38adf995ad5efd0958a98cbf022dfb0d4b128917e4b513f120629051307b4d9d1014a28c55c93aaff59f47a7c0472a8b7a1ad5dbf07252c4b2602278fe18a77ec8acb8798f9f8b720dafe03",
            "64a330d769d328a042e93c9dd8c12aac623f9be1733e471d37c960e2f98e2e65e98ff7e51d1b213cd5fd9ab403f3781b0b62dd1ac7471ec2ce712468f6ee12b317c327f312e0e7b41252759412bb4451a0ffee26e0416458d30e480cd9d7975b75a58ba85108c031825095e50c00d576a98097aec6126206cf079575ac330686",
            "29c0bcf7810f223c3fa5222a9649dfb1ba5ec3157c415994c77af183d9d09d2d831d43f8d81556af66e2f0591905abbd09ff402dc3005d650d809a7d1c4a12a8d5c561f09dcb8f3a4e7d516cd75fe9c05ee295748b7e8d5d04ca441daf8e8bf73df65b7240cf053fd3831f8d0a7e1652149f3da3f13b5df95f6abfa170f063b02cc263b0a5d8f4475bd86154702297774ad36624591dd71f98a49cfbad919e52834b43ea3cb7a6c91e05dccfcdcc48d6a74b0cf7963a99f95c0148df1ff9f79b96f30b9e279d629801cf8befb7e73e0efce8e61d4d2f5af203f2f892a7e0ea785928e219d15b1f71b3a3f574564618b3093d24313d9f6fc44e28dc754f6db8af"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t224, 2048,
            "1f6ad3",
            "02791b140546ec6c183829676d63a4ae126f863a314a733401be20e1f550f5ba172c5f77a5b17e0bc1cb7f6bbc77818e16a117e9fcd51a432b0f8994b6136dc2c3b9b815dd2f86586125762fc0c1054796c87e39fb5719aef93f9e4f3d4f2a812e5a608dbf3cebcf26eb1e89d9fd8b8baad5cef1c3b77252b365bdf0859baa1d06bc4629ff233b2c0cb8834ce395818a325e6fa35b485af1b2ddfe5376fba5d4896202d735dd14c0caccd8f54cdef07b4f83b2a1eda7371c922eb0435cee518cebf6cb54f91999407425968c628c4b6f6c75d9dd7ea8dd52a9ddcb72466e7a68241dd52a01cf20d103a9ad1e4746bb859114309a40705536c2ee95471553b983",
            "d01be600ad7f394c1641b5fbbb79062fc0cfc10d8ba489d5481fb59512695ad2ca9de4f39c9b74607e579583ce1bc43d900e70508bc2699f8f72a55bd91285ace6753ab45dacf7b4e23ed46f9ca3c88a23025b6c5ff5180088ef9a64ab9ab9c8846624deb986453c52e3247782fc828498d563ca2f5f0ea8613d9fd5c178a15fe1bf68fda5172f7c02115cf9d34996b6d15b9e14edf998d6fb93c8965dbf19d2871058444e537b6946c3a775f58f0ac27897924e2d9a264aa1d021b3858f66f5cac5a5498afe934cd5f3e1a7dbb32e95f7ecfea72c554efdc84c6db76631c76d1a5ffa12a54b81106137650e68e3399aead8eea83694ee10bbe335ca19d0fd65",
            "04af4ec1ea950c715a06bd9588efe4b3ae3721fd0bad56df2b3f08d46a6c087db4fc52f48eee355e5ab2b4bfd6982d13e789389a95f5d273560cbb6c8f311c1958ab6d23809e96e3d03a542f9433df745871ca05f0082ab3bb6afa9e28dcbe4b782667f6c68f77294508658dcaa843018a589ee924d0a6c8e2c28e123b54363b",
            "30ea6542b24abb9b03617ef3daa65ed3cd0f3035c7f1a741a0403129f809150ed65f23acbcc21d63e6c63669a6175d2791e7d005c1b9931ffa6cb86297cdcbf83d6f2bb674e0ead4e25e0f2118dd0d8406fd1db46947fb0ab9f1b3e41e8e6ba7c4e98b66d5ee618027816cf8f62e768be46dbd8851236e67e429811043a630d17dbf16b50107e83dc981f3743adb04130e1948547d6e10dd7e23701c9ee13c75924afe9b8ab41d420c69b61ada9895f7f557e33d471657aa8a2b37877b969776b4bcd944052cfc0f86271734cdbb8b96c29b806de77cf18fa5c096e99fe3ca546bc1e5a335bb05b38b3b42438fd8ce981828ae63be8653b23c4d087720366b3c"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t256, 2048,
            "1f6ad3",
            "02791b140546ec6c183829676d63a4ae126f863a314a733401be20e1f550f5ba172c5f77a5b17e0bc1cb7f6bbc77818e16a117e9fcd51a432b0f8994b6136dc2c3b9b815dd2f86586125762fc0c1054796c87e39fb5719aef93f9e4f3d4f2a812e5a608dbf3cebcf26eb1e89d9fd8b8baad5cef1c3b77252b365bdf0859baa1d06bc4629ff233b2c0cb8834ce395818a325e6fa35b485af1b2ddfe5376fba5d4896202d735dd14c0caccd8f54cdef07b4f83b2a1eda7371c922eb0435cee518cebf6cb54f91999407425968c628c4b6f6c75d9dd7ea8dd52a9ddcb72466e7a68241dd52a01cf20d103a9ad1e4746bb859114309a40705536c2ee95471553b983",
            "d01be600ad7f394c1641b5fbbb79062fc0cfc10d8ba489d5481fb59512695ad2ca9de4f39c9b74607e579583ce1bc43d900e70508bc2699f8f72a55bd91285ace6753ab45dacf7b4e23ed46f9ca3c88a23025b6c5ff5180088ef9a64ab9ab9c8846624deb986453c52e3247782fc828498d563ca2f5f0ea8613d9fd5c178a15fe1bf68fda5172f7c02115cf9d34996b6d15b9e14edf998d6fb93c8965dbf19d2871058444e537b6946c3a775f58f0ac27897924e2d9a264aa1d021b3858f66f5cac5a5498afe934cd5f3e1a7dbb32e95f7ecfea72c554efdc84c6db76631c76d1a5ffa12a54b81106137650e68e3399aead8eea83694ee10bbe335ca19d0fd65",
            "6373589c67f37b8ec290d625476667748a460cf9e7aca02bc6f167521ec2ac9b38d1a86cb6caa6f5d3896508ec8abe2a40a186eaf4ebb6715a04c95b727a66c5b1823fa702ea39650b4fcda0b190ae52de82ac1a81e6d8d4d798e96dea09def557eee5f6533a7c05f04ad6969d608015ec53443299854e7cc7148d318c555c54",
            "32bb5c850212d9e21d18f3f01b98a42439fc7287d353d9a9fc5bd31bcb9adaa963fbb944feb9b7cad6d34db4c816337e2575bc63109b5a068060e656475ad42836703e1f189e1970fc3c66b5466fc9461706206734629f613a0470bf3dfb2ef7284cd2e5b1a38984b5533c32ba6224511fff01cbf067d6375884eee7da7aa3ca6c26bc00c88bcfad91b23add29df139588eb0b62886fe295837bbba91831d6b50654d53294745bbfc378408cd8b14d07a9eae8a4b8a8ed22ad537e9b6dcad38b0bab28f21ae507d6dac2aa22dd5523d076056236f0a097a4046ab9b4dd00900646f3b90784ccbd4d4161930c096cc10a57aaad7ef4303b156428f7845ace9e49"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d224, 3072,
            "ebda09",
            "24ae1c4fc7a4bfe01109e903f3bd12fa8769be59a69022cc4fb6b4c59ff6a105cfaa39de08f7a1fec3bbf5d0afdebc87cf394e5eaffaeffcdaec5f2ced1a48f163681b5d6a38911e341e7a2ae708799de83e642c41210b449b14b877efadc46e56d97ea3da6a7c82d5373011cb9d5232c7ce6a38fd2d511dbe08a67bae18a03584ccd63fa08ccd59cf1f752b28e4e24b09736a05841a6347751ac54d8dbeff24519b2648e974d258b6702026fd04cad50f5dcf56efad53db3fcb912e778198df8bd2937eccdb88ea2c64a3732d0ef24ac7b7dc9b63f31efc68cf657cbd83f564fde28c92d2b1c7e5521e3dd4a660ba80d7accee31c65d8b37247097f1c23f8dcfa2cb49525edbacbf05ef669f748c60b8aac9a9723d2620bf97d3cc8c8ac3ab5a533714b8ac76fc3eaf6921ef5cd23b847d3bc68ec019be2fcc932b8209d5bbd08e5b96e97d448b6f4e19d91b325c943c43b65a42b593cfae7c35987d739765471a3e276cf9e670c3fa8bc49bd891744a9b96c0f801581cc28cb04e5a83733f9",
            "9ef147700655a568cfffaef293b86e35f562ce3e4326bba11a049fc4e4b766270608e12d5f09dcbf4f295131a8fb0bb5875a6394bdf129e307cabb5861710a956aa9411533d46994b678aee60b5927d065b6bc3130d0bd36135a46d5153dc530e619eae17b06a6db2d75a4b31e32539a89bf1b2b350c7eccc02a573af7d0d34d98e037698301c84d3e9ae66ee5e3429bd27c908140167d3c0ec4bf7b37a4eb60456d12752bee1e0aa705d184a11917bfbe8a73c07f42ee1957fdf30c5a331f7335bf113e215c0a4c9f89099b94ce74ed76e380ecc7cea221d8bcd961cd014762f9d12049d4288f585249c9536ca8abbc2b6ea63afd9bdee0aff6ee91a2f31ca82aaa778159fa8b9bd5e72268bf89afee45494653de7764948b9b877fab124b3b66cc4ff7fb56ba4140936514436aedd2cdc34c032c5b3c385db4f8b658ed5027001d9084064de2f11bd10ef2e290e421d3f8fdd2d217dc6f5aba8d709b6b25c17c0a4825a1e3633005380f16f51614aa3a7bab5169cf840f272919a28a765ba5",
            "bce699d74adc1b6b829ce240c1de586cdafdfac066fc54f15cc82df5e2bcffb0626aaad0df9968f68a8a041690804720377eb4e0295375230fd4941b62696e047ecb6508f90bd66032d74bbd2df9f1e69e204ca243e329d87703d4f505f08c8e3a8f34473e3b4bf3a40a1efc3f513c05376a2bcf5db45959bcdc554c705b3f95",
            "16f420e10b1a590bbf450fa4ae1bd0f52e684a0a32bda8f262ea53d02f54251addd1c6a74b881dec011daf7e5fc85f2200da225e1ee226a9951586bf3fca60ccd940a8d83ec0e4dc6855e333d35fcb2de42d99c82bd8b0b460bea678885885ce6ec6909fb06515fec743016d296787cdcfc53d8ff741f7c0609e6a0bffac1524d1a1d515b03197db26aac9580b5613085c9cb4c47352f30f720f24c5deece49fa0cfbd2f582b51cd763f27f4e667106fd90aa9039f4978c11fea4949844ed86e37f6cbb4ee7afb81d7a91278b69fee7ca59af2188a4c343e50653298f46dfdc4c0bb93c13f7e260da2e0c5d0eab47ba1d85f98b0c2f1810fb07a962707cd95c18e1029a0ff0f035b97283a72a2ca231729982900b4177809fa7884f3f5519666a5c838b86f3fa42bff92d3e69d1dc61c064d28c01704583ec44b5badc17ff82ba0c01f9948a2962189ae2bfa4aad5f5454ebd32fb654aeeccff53be5a9625ef5fb06e323ae29085824031bf6d97392c6b65ccf7d644770594882fe47120d6cf4"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 3072,
            "ebda09",
            "24ae1c4fc7a4bfe01109e903f3bd12fa8769be59a69022cc4fb6b4c59ff6a105cfaa39de08f7a1fec3bbf5d0afdebc87cf394e5eaffaeffcdaec5f2ced1a48f163681b5d6a38911e341e7a2ae708799de83e642c41210b449b14b877efadc46e56d97ea3da6a7c82d5373011cb9d5232c7ce6a38fd2d511dbe08a67bae18a03584ccd63fa08ccd59cf1f752b28e4e24b09736a05841a6347751ac54d8dbeff24519b2648e974d258b6702026fd04cad50f5dcf56efad53db3fcb912e778198df8bd2937eccdb88ea2c64a3732d0ef24ac7b7dc9b63f31efc68cf657cbd83f564fde28c92d2b1c7e5521e3dd4a660ba80d7accee31c65d8b37247097f1c23f8dcfa2cb49525edbacbf05ef669f748c60b8aac9a9723d2620bf97d3cc8c8ac3ab5a533714b8ac76fc3eaf6921ef5cd23b847d3bc68ec019be2fcc932b8209d5bbd08e5b96e97d448b6f4e19d91b325c943c43b65a42b593cfae7c35987d739765471a3e276cf9e670c3fa8bc49bd891744a9b96c0f801581cc28cb04e5a83733f9",
            "9ef147700655a568cfffaef293b86e35f562ce3e4326bba11a049fc4e4b766270608e12d5f09dcbf4f295131a8fb0bb5875a6394bdf129e307cabb5861710a956aa9411533d46994b678aee60b5927d065b6bc3130d0bd36135a46d5153dc530e619eae17b06a6db2d75a4b31e32539a89bf1b2b350c7eccc02a573af7d0d34d98e037698301c84d3e9ae66ee5e3429bd27c908140167d3c0ec4bf7b37a4eb60456d12752bee1e0aa705d184a11917bfbe8a73c07f42ee1957fdf30c5a331f7335bf113e215c0a4c9f89099b94ce74ed76e380ecc7cea221d8bcd961cd014762f9d12049d4288f585249c9536ca8abbc2b6ea63afd9bdee0aff6ee91a2f31ca82aaa778159fa8b9bd5e72268bf89afee45494653de7764948b9b877fab124b3b66cc4ff7fb56ba4140936514436aedd2cdc34c032c5b3c385db4f8b658ed5027001d9084064de2f11bd10ef2e290e421d3f8fdd2d217dc6f5aba8d709b6b25c17c0a4825a1e3633005380f16f51614aa3a7bab5169cf840f272919a28a765ba5",
            "9ae15d2391b6e99b14afbc2c8434e9ac2fefc823d1389bda5bd171b4f2d44bc13be97e11d6bc58c628af066d5eccb58faefdf882e07f6a850e94940da8781159ba97ef4c72fd597cdd0e7387f17786a6d0645d844bf4ef50a5e93e109aa57e39a0527a7d6d6034e5b934cb1f451ea2191c8cbfcf197e7161a93a3668d241db8a",
            "2c5a2714be3968b4b1beec37abe4ab9e00c7df05cc210166971ff2c8bf2c8c139099f90c3dfe446c6eb14ac81cf2a4f99d3e66943a31dfc0028e05f7fae3aee2a07b569e30e800cd84d0000482be5f1379dc4bf7b006c3773b695516cbc416ed384a6b22e43d40a445814d43ed8e25083dc25eb55bfb2ecd1ef1cadf5c7771195d764b063643d01c4744623635fa4eec3334a490635348bfbf7b765c98073a9f5d25485d7175d34d97b240b8705c8a4ebfbe9d47a59c8059cc672226b9b0d0bdde0b653bfec89d4eab91893bd552dc9527cb82dd7845e515bad6533770da51657977e8202a0efb38c888034dcfa3b2c432db146ac4ef111116679a00cf684ef4bfaa85eb1f1c99c304cd77cc57e86615a9e6472e423231324b3d63c0147718e85d2a8565f5c9cd2aba736d3867a001d27f02d6056b5d1d0dd06525576c58ad940817168deede22a6af77001391fbf059f15501c3ecd6d31d9fe6f1e3095b0a75eda0efb44fae79e57737d732d7990ea30f7205ca9e8d5f5f169748b616d4b793"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 3072,
            "ebda09",
            "24ae1c4fc7a4bfe01109e903f3bd12fa8769be59a69022cc4fb6b4c59ff6a105cfaa39de08f7a1fec3bbf5d0afdebc87cf394e5eaffaeffcdaec5f2ced1a48f163681b5d6a38911e341e7a2ae708799de83e642c41210b449b14b877efadc46e56d97ea3da6a7c82d5373011cb9d5232c7ce6a38fd2d511dbe08a67bae18a03584ccd63fa08ccd59cf1f752b28e4e24b09736a05841a6347751ac54d8dbeff24519b2648e974d258b6702026fd04cad50f5dcf56efad53db3fcb912e778198df8bd2937eccdb88ea2c64a3732d0ef24ac7b7dc9b63f31efc68cf657cbd83f564fde28c92d2b1c7e5521e3dd4a660ba80d7accee31c65d8b37247097f1c23f8dcfa2cb49525edbacbf05ef669f748c60b8aac9a9723d2620bf97d3cc8c8ac3ab5a533714b8ac76fc3eaf6921ef5cd23b847d3bc68ec019be2fcc932b8209d5bbd08e5b96e97d448b6f4e19d91b325c943c43b65a42b593cfae7c35987d739765471a3e276cf9e670c3fa8bc49bd891744a9b96c0f801581cc28cb04e5a83733f9",
            "9ef147700655a568cfffaef293b86e35f562ce3e4326bba11a049fc4e4b766270608e12d5f09dcbf4f295131a8fb0bb5875a6394bdf129e307cabb5861710a956aa9411533d46994b678aee60b5927d065b6bc3130d0bd36135a46d5153dc530e619eae17b06a6db2d75a4b31e32539a89bf1b2b350c7eccc02a573af7d0d34d98e037698301c84d3e9ae66ee5e3429bd27c908140167d3c0ec4bf7b37a4eb60456d12752bee1e0aa705d184a11917bfbe8a73c07f42ee1957fdf30c5a331f7335bf113e215c0a4c9f89099b94ce74ed76e380ecc7cea221d8bcd961cd014762f9d12049d4288f585249c9536ca8abbc2b6ea63afd9bdee0aff6ee91a2f31ca82aaa778159fa8b9bd5e72268bf89afee45494653de7764948b9b877fab124b3b66cc4ff7fb56ba4140936514436aedd2cdc34c032c5b3c385db4f8b658ed5027001d9084064de2f11bd10ef2e290e421d3f8fdd2d217dc6f5aba8d709b6b25c17c0a4825a1e3633005380f16f51614aa3a7bab5169cf840f272919a28a765ba5",
            "ebe884674ddaa754c4fde5e95692861cb4d2f680b48ed00c01133b1e115079bf583bbd29bc703d87481b89fb24191be5c55a2f63618ad514a6f04422ab96717f27aae06ee124ba4667a9217203afc0bdebe3a6cdb8c754ec19a0140fc98f8d10befe953fa43d4619896d5457da9e9d2b8e3402c6a18f761dc4eb54ed5384f6fc",
            "0bd290ae926659e52ba3938a9d73eb940c108998a17714298c9094b5bd67ae1dddf3d30f0e9f7434f64ec9f71f35c7174d8e72135f7c5273938b441572051a39de60f72a0150299a7069d8f323a5570cd2b26cfbac37f7d0b2951db851dddac8015deab440ee3a8b5764ac5c38070021677e29fbf820cd3c5e0b994d07f3eae15b5388306fc8b77b74094db89c9e8aaf70a90ef0fa821f26ec30821632805ab88f18ddbfa3e26821bf35cd9b323ea14fb90876e1fc2ad1c501b52e014d0bfa991c1e3bd8b0523a02f508ae3f788d6160d2e98481ce210a1167a3e6e52d1a7b87740e71a2d77d8f729d90a0ccb00f8e9c6d407f27b8e3fa45418035469884b6cc976505fee0758e8238d2b4bfd665e46dd3d5bf6694c7295b6bfe4afbe245d69fee3bec2cd6159cc826a3ce3df7634070b49400380b9b69f6a14e2b96006439754277b1f7c93b16cd7fd26b111452c04d9c864ad35191b5b9c4d401abbf5595a9392a1ac2bf0e952b2f74c0d3ed9578c80971fa2bc87b3ccf16fbb2bf3540d0d0"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 3072,
            "ebda09",
            "24ae1c4fc7a4bfe01109e903f3bd12fa8769be59a69022cc4fb6b4c59ff6a105cfaa39de08f7a1fec3bbf5d0afdebc87cf394e5eaffaeffcdaec5f2ced1a48f163681b5d6a38911e341e7a2ae708799de83e642c41210b449b14b877efadc46e56d97ea3da6a7c82d5373011cb9d5232c7ce6a38fd2d511dbe08a67bae18a03584ccd63fa08ccd59cf1f752b28e4e24b09736a05841a6347751ac54d8dbeff24519b2648e974d258b6702026fd04cad50f5dcf56efad53db3fcb912e778198df8bd2937eccdb88ea2c64a3732d0ef24ac7b7dc9b63f31efc68cf657cbd83f564fde28c92d2b1c7e5521e3dd4a660ba80d7accee31c65d8b37247097f1c23f8dcfa2cb49525edbacbf05ef669f748c60b8aac9a9723d2620bf97d3cc8c8ac3ab5a533714b8ac76fc3eaf6921ef5cd23b847d3bc68ec019be2fcc932b8209d5bbd08e5b96e97d448b6f4e19d91b325c943c43b65a42b593cfae7c35987d739765471a3e276cf9e670c3fa8bc49bd891744a9b96c0f801581cc28cb04e5a83733f9",
            "9ef147700655a568cfffaef293b86e35f562ce3e4326bba11a049fc4e4b766270608e12d5f09dcbf4f295131a8fb0bb5875a6394bdf129e307cabb5861710a956aa9411533d46994b678aee60b5927d065b6bc3130d0bd36135a46d5153dc530e619eae17b06a6db2d75a4b31e32539a89bf1b2b350c7eccc02a573af7d0d34d98e037698301c84d3e9ae66ee5e3429bd27c908140167d3c0ec4bf7b37a4eb60456d12752bee1e0aa705d184a11917bfbe8a73c07f42ee1957fdf30c5a331f7335bf113e215c0a4c9f89099b94ce74ed76e380ecc7cea221d8bcd961cd014762f9d12049d4288f585249c9536ca8abbc2b6ea63afd9bdee0aff6ee91a2f31ca82aaa778159fa8b9bd5e72268bf89afee45494653de7764948b9b877fab124b3b66cc4ff7fb56ba4140936514436aedd2cdc34c032c5b3c385db4f8b658ed5027001d9084064de2f11bd10ef2e290e421d3f8fdd2d217dc6f5aba8d709b6b25c17c0a4825a1e3633005380f16f51614aa3a7bab5169cf840f272919a28a765ba5",
            "b157c87db6afc7a601bb1c7e371c33ccd8e03033c3f9914efdee0effaed1c4036c7193cabcd0c586d6d8f083a9491db61ff62998a2316c35df84997fcaa2e5e9e29c6c31b658d07da84023aaf13707e1e5d1136b78c379c60298e6f83fa6aa239a41195aab2e31b3fe5a7d9d16cc3874b1d9b6534e97002aed94bf1016c75bda",
            "1c4ce7cd53e939f970f7fe14f9c5b2f4a11f004d06f98e536832a8c612475af2032f3254b0b05dac10533a2106b6395b91bd41ace1d9dbb362394eaabd827ec62739f3b1a2d497d0053b8929c7f8a25a6dd0c16c8fdb5d7a9ca9561d37899f8a1b0240075fb99e73be0556607795fd8df71d1ec3ecd758c339b1e1ff5658999e09698c6e31ca49d76bccd4412d7b6f74306b6e4c3a8a2df0d4b5f7bfd9f5fa430fa156102dc4b75b8d3a8b5a42f5489266d7ef21682f4cd51a60e756a1e5aceed3468c00a2369dcc45fef29948da54811cd4b30b6c9205d1fa2455fa6941a53e64157432feb6d7de4dec690e7a534770a482db4d9fcbfd52d7345a2e7a32812e6516116ff9f6d487e418c15581aaf765c91010f650cb19ebca57718cf5b5cd03cc027a875c3d65509da3e2069559290ace290e6b68353d8e67167fc0cb3830d9bb6b10d01712e31450e2bc066b5e269566ce4c8ec2b89c77883d29e6ab69a61af6ba1dc4be8e27755bb01ac9eeaef7755265ee1c997f13fc41b404d85022e439"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t224, 3072,
            "649bcf",
            "459f579635047ebd9997d80554312c25ab5697de4306b2647c95accf47d4dc57c2c6a42f5be9ff9d8b47eada866e76abf3a7988d905366f368f2c586c6ae8d47a47e7dc9d77fe8071b639e2d96b6dc78b76f46f745079eb79000d0bf8c86fff0ab9cea65e18a64132c31e225a5630ee07977878007d972fd5343ce67942bee0e85180379e8afae714c7499b519930f7c3912d39881e894ef45034abf026e54b0a7ee9bd6c1a0c519251c3891a45e853a82a20da93e9c48c681e7c3ec36f8697d840df55c640c91ae0e5c370e58bebfc8ca1a6e5d68f89552f9796e7aabf654a19021fac9def39a062994439041027b8a2a89557c7ab35cde2d4f1bdcdc21ab0f93bd522177179974f1ec1a48d8da0fff7801bb65548c781a8f98fbcef306a547616c91c18f2f8250386e44d91d7736b36a44f16bed3b8d4cf43e286f7cbb6a7fe823eccad53821e2bc37c221f81d06dc80d70914bb6d8f8ecfcb5eaffaa5ae706fc9d1f5c005003ff357e5ffd0c948a234e11ae3cce2674e7002e38f1cca86a9",
            "8ef6f9be7640b12683c3062a36fb034d9685be9b9baa2fdb296d3ea9117bd680e96cb656ed0c78b510941ea4f92e7536335ed8344f916cbc61fc785078ff95328fb084b1918d80f70d10eb8fa15c2d010edad2d846d408337a071b3fd1c1eb6f17d9ea38e9d52da07c9ace95da25789b8f79f7d2edfc69f15a17bd73997739b07ab8bf0fb087d82bd4fa43b61c41ffade40f89f656d8bc009730411da46f5abd2a0e7d6443339b98bd519479532298e63277bdc6648395c392b06b8f15ca9840970d6560520ef3ca1c21ccc4300faa9a8060fa2a0e4499eb2eee3721a31a9d5502fd1d2dfb58c07eb7d2c51540624c373cdb54b9ad8fb79bfe25b36bf02c702ea5c1cc6d29eddcceae549a88d4596e7a3871529e427a2b26a898b60b584f2b62a2ba6967c08a44556bf420d2b6c822f3422ea1c52dfc30ff309e6ba383f49a2b5a80eec5c09fef308b06ba8f84a11324aa6debcbd77889dd0368eeb0981790cfacea12bcba13f9dd41e58db11c1d8dea6df146ed5c277232e697175687de1d29",
            "eb94dc2cf1f69b7d9488af2050ab861a2233357ee26a6a92d357a22d79409c63aa6d0d64e82f95a2ee21f23289ae7475a9d3b0f7b82679972a180ce956778bd88437ad904771b39b0dac9e49f45c9f56dfa8cfc7ca7020155a8f938db85dacf7a0782476b5c5ddaf18b11b2d38bdf004ec39f8b5bf4f47528a44a0e349fbe707",
            "28c98b48fb6102e3ae7fcd78700a6b2b05af606a6911502bca653f3ac909e7a3b60d73e34fdaa2d77cd5a0a1eb1ce4012da6a480d8ff1c674b436842922fcf5bc662c14950a859bf9ba68af88e16bba9baad26fa8cc0af74335ce6281ed30e5b5021a975e5b831c1f8c77a224a5a7201380f4ce158bfe6ac7602570b08a9f197101414da5e15501656a05e273b6d32046febca5fe536e3b0680fa021b4ac423e624a806016ab7b30ec374fbbd55c912fba403eb4785c45136dd5bcb82241860dae75b37a2b241a44b62fac5dfd1f3210e824ff7dece28453020dc311bef6e8b849c1ebc6fe97a8f6a1daa61748de503766fc0b4ea8a7fc8569ee84e11243d4226077abc6f7cb198db9477752ed9eed9c9a43f8ce3d5c787718dbbe2b6a7772f8c1185f05cfd98bf74e224ef419114b77f6d4f87fcea8230df57cf2bbf64e6913872b795626ba77866eddae0aa345472c3004b9fab95539e9942bb523358d938008beb0a1d27580aea89c9c5ef3cd225e4695dfef8e442229fee088b9b757f7a4"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t256, 3072,
            "649bcf",
            "459f579635047ebd9997d80554312c25ab5697de4306b2647c95accf47d4dc57c2c6a42f5be9ff9d8b47eada866e76abf3a7988d905366f368f2c586c6ae8d47a47e7dc9d77fe8071b639e2d96b6dc78b76f46f745079eb79000d0bf8c86fff0ab9cea65e18a64132c31e225a5630ee07977878007d972fd5343ce67942bee0e85180379e8afae714c7499b519930f7c3912d39881e894ef45034abf026e54b0a7ee9bd6c1a0c519251c3891a45e853a82a20da93e9c48c681e7c3ec36f8697d840df55c640c91ae0e5c370e58bebfc8ca1a6e5d68f89552f9796e7aabf654a19021fac9def39a062994439041027b8a2a89557c7ab35cde2d4f1bdcdc21ab0f93bd522177179974f1ec1a48d8da0fff7801bb65548c781a8f98fbcef306a547616c91c18f2f8250386e44d91d7736b36a44f16bed3b8d4cf43e286f7cbb6a7fe823eccad53821e2bc37c221f81d06dc80d70914bb6d8f8ecfcb5eaffaa5ae706fc9d1f5c005003ff357e5ffd0c948a234e11ae3cce2674e7002e38f1cca86a9",
            "8ef6f9be7640b12683c3062a36fb034d9685be9b9baa2fdb296d3ea9117bd680e96cb656ed0c78b510941ea4f92e7536335ed8344f916cbc61fc785078ff95328fb084b1918d80f70d10eb8fa15c2d010edad2d846d408337a071b3fd1c1eb6f17d9ea38e9d52da07c9ace95da25789b8f79f7d2edfc69f15a17bd73997739b07ab8bf0fb087d82bd4fa43b61c41ffade40f89f656d8bc009730411da46f5abd2a0e7d6443339b98bd519479532298e63277bdc6648395c392b06b8f15ca9840970d6560520ef3ca1c21ccc4300faa9a8060fa2a0e4499eb2eee3721a31a9d5502fd1d2dfb58c07eb7d2c51540624c373cdb54b9ad8fb79bfe25b36bf02c702ea5c1cc6d29eddcceae549a88d4596e7a3871529e427a2b26a898b60b584f2b62a2ba6967c08a44556bf420d2b6c822f3422ea1c52dfc30ff309e6ba383f49a2b5a80eec5c09fef308b06ba8f84a11324aa6debcbd77889dd0368eeb0981790cfacea12bcba13f9dd41e58db11c1d8dea6df146ed5c277232e697175687de1d29",
            "17ddaa94d739028d28d0e1463d18b5058eb85ac57d9ae1e63a429024e45f29c6f1a07017cfc9e71acb06dc7a337fa5c0b72c2bc815eba576f6d0a6a512bc5a609b310c55d964ec8612941042ac9bb85495c3d67ae3dace19b8897a2e69e17188df3789353d329a3ac2228587f2937529f02365c22f90e336491513a82ff7f6a5",
            "08b3b00943e5312856d4361354fae8a4bfa725cd965cd2927842ca9972b5a3ada6f24210f86cb4164b29c3b9644ae5b14aec7846fdb87eb2d24413ac7d48088d0e560d7ed86c02289b07dada26846773ac96cf54f6cf9ceee0ca3314f4ba11e845e73cf32706e0d7f4a9fa20e350ce622d4cd55423c2939b34e9408ca786f546b08f1f163e92e28ca72113c3628931bee74504ec32a6dc20b514f812df8f88e6f727c538ab9f807dded866cc764f021fbe224956e396ec4a3899b63bd4c246ab9fd81691650ba92ae0d2040fc806d8a9402e9f2e55d99eae2d49433b0d7a22a32b64674c6cfe87e34c3ffd3964f3dfa3e81c47c51fdc0d402f81d290a60bf27632112b6c4589bef220fff10d28b379f0c560759449110f020a3372d30175ff2cfe5b56b0c5b4945a50dbd0c734dfc3ba923e78650e179a018640729ea4e0d6e9e127534a03f171dd8b401dca0e22fa9c0ae919576fb65d9d098c90af5866757ab69ea75361166e274c875bca90298ccaa44300229f29a9c6da0cfd123d06be57"
        )]
        public void ShouldSignCorrectly(ModeValues mode, DigestSizes dig, int nlen, string eHex, string dHex, string nHex, string msgHex, string sigHex)
        {
            var hf = new HashFunction { Mode = mode, DigestSize = dig };
            var msg = new BitString(msgHex);
            var e = new BitString(eHex).ToPositiveBigInteger();
            var d = new BitString(dHex).ToPositiveBigInteger();
            var n = new BitString(nHex).ToPositiveBigInteger();
            var key = new KeyPair { PrivKey = new PrivateKey { D = d }, PubKey = new PublicKey { N = n, E = e } };
            var signer = new ANS_X931_Signer(hf);

            var result = signer.Sign(nlen, msg, key);

            Assert.IsTrue(result.Success, result.ErrorMessage);

            var expectedSig = new BitString(sigHex);
            Assert.AreEqual(expectedSig, result.Signature);
        }
    }
}
