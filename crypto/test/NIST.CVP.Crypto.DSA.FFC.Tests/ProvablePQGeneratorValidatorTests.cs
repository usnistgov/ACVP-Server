using System;
using System.Collections.Generic;
using System.Text;
using NIST.CVP.Crypto.DSA.FFC.Helpers;
using NIST.CVP.Crypto.DSA.FFC.PQGeneratorValidators;
using NIST.CVP.Crypto.SHAWrapper;
using NIST.CVP.Math;
using NIST.CVP.Math.Entropy;
using NIST.CVP.Tests.Core.TestCategoryAttributes;
using NUnit.Framework;

namespace NIST.CVP.Crypto.DSA.FFC.Tests
{
    [TestFixture, LongRunningIntegrationTest]
    public class ProvablePQGeneratorValidatorTests
    {
        private IShaFactory _shaFactory = new ShaFactory();

        [Test]
        [TestCase("SHA-1", 1024, 160, 1776, 81,
            "f4f8a777b9cbf737f22e118613890abf74f2917359a0e758702ace4d", "f4f8a777b9cbf737f22e118613890abf74f2917359a0e758702af8d1", "f4f8a777b9cbf737f22e118613890abf74f2917359a0e758702aceab",
            "958986a6288d178d1eac317ee4838785bfec365a20718868855c0e92092ecc4c4afa326b7aac4cf8fe3d78e94599c1e71e909bdd77dab39565bace24328757e54d1ea2efe2d339ed4870f5f75ff180ec5257bb66de9bd655242ef00eb264fc852fc718f9c9dfdb95259ec9c1f7b781c5806788879492857197c35f3e0d72046b", "8e26b9a41f522074d8c771e1737355db3030a263")]
        [TestCase("SHA-1", 1024, 160, 638, 130,
            "29efb99908e5e08af2897b4866c0b82051f46a628ff8b28f4e9bb177ba1c61d6", "29efb99908e5e08af2897b4866c0b82051f46a628ff8b28f4e9bb177ba1c6f01", "29efb99908e5e08af2897b4866c0b82051f46a628ff8b28f4e9bb177ba1c6260",
            "f4598a1588c1bbb7627567f148c0640059a05509187b774f8486532462bfe33b004b29836e11dddc4f50be91efda351cf9ec4003ba4aff46982ec4a747b6a151ac1bde6771e9905773731c17e0ed640bdf6a22c7b31ff73e4058a369dd06b6f6675a2db4eca8dff851809ceaa323c6e1aea86654e48952d368e4be79e508e42f", "de6160c2fa187456ab3a829c3ff4d21894e48905")]

        [TestCase("SHA2-224", 1024, 160, 825, 57,
            "cd04d58fac06353675521b2d6a35d3d63eefea83bb5e4df2b1b506b2", "cd04d58fac06353675521b2d6a35d3d63eefea83bb5e4df2b1b5151b", "cd04d58fac06353675521b2d6a35d3d63eefea83bb5e4df2b1b506f2",
            "c06f8590519e5a60387497ae6bfeb93c687219eabeb0e9bfabbba5ff95977875d6a2443ab65fea5c6bba01393b5d8863510ec46d8c81622d5fa78df7c8c50513fb8a74f6ae283489d52d2aa6c14842863e8e687be0b0e34cfcd522eed02143d08b4ed89fd026c24d685ea10086a1aab32224662b388d65b98f718f14df5a731f", "8d3c615d9bd223baac6fbd3b94df4b0fb0716e1f")]
        [TestCase("SHA2-224", 1024, 160, 505, 29,
            "443a6b801c31d23270441c70e45345edbf2808e078dfecb0275848b75bb7a15ff8179bbb110541814009c9729398ed5f", "443a6b801c31d23270441c70e45345edbf2808e078dfecb0275848b75bb7a15ff8179bbb110541814009c9729398f522", "443a6b801c31d23270441c70e45345edbf2808e078dfecb0275848b75bb7a15ff8179bbb110541814009c9729398ed80",
            "c9ab9d40e0bfce5049e0db5a4c0f7fcad197c3b7d6580bc3548ee953a91404d1baa8fbe06405db6d3a028465c9195311f75df738a0e694b56d26506d31dfff32207761d6b41fc04ffeedc1607411f454a6ba242ecdbbf354ef3823ec4a300a3522bff97416b59815a501b3fa4b2c5dfbb18700c348d70781d66ab3c6783de957", "a2c698790ef7be53eda7dce3737d7914a852a447")]
        [TestCase("SHA2-224", 2048, 224, 486, 170,
            "dffff81df59c04f2f6b10877d7ab209344713a1d2535f2913c16f52c", "dffff81df59c04f2f6b10877d7ab209344713a1d2535f2913c16fcdd", "dffff81df59c04f2f6b10877d7ab209344713a1d2535f2913c16f5e5",
            "8f48c48b455f1588a92045db0809faac7b57d8d45993eb243d0b90be6a46c5d2f73c5dc5e965371afab1244c2efee8c0515a4df1999e47876e7c1bfd9d545ebcc7684e4df9bc7b78fcf9564f0666457bc8804f5da3b44f86b92cc0dfa5beed50f3d9ab118acc7686130f42b9c83eadf2f78b20a976add53180dc5c2b4fcd11ea09969e7ec1dad208d280345706d29df73454fcd6e468fd76f2dba127d793e4e584bc5c4f6d6d80091f4f58d2d4bb45c64210a80ca16bf0a471e36b31cb2f650a6abc1cc79da5052e141a452d87a7164f00ad416b95968ca616c2bb11b11eef3771b941e3a16dd9db45cb447e86b1c4381943b1566624b1afe49ff27c284aa57d", "b36625ef7210b15cf8301dd5d0a524517e47adadd9039833989f2495")]

        [TestCase("SHA2-256", 1024, 160, 1095, 160,
            "03ecde185bec801dfdb92fec706c6df8be27721dbdc2c58aef42f1b61aafa7d3", "03ecde185bec801dfdb92fec706c6df8be27721dbdc2c58aef42f1b61aafb740", "03ecde185bec801dfdb92fec706c6df8be27721dbdc2c58aef42f1b61aafa883",
            "d24fe33030bf9abae8a937d2913d01fd3f9e58b4f77417a94eaf06d15606f6ae343f321a5028f845941837062ccd7f4bb98ee6f3151dc523a02c0c3660b79abccfbc4041d67e2c62f6e91822cbad3a238e91276876da3dafe822e3a3a1914a3898db900546920f6aea33ef4e419a063175e45fc174ec29c12c43fd82bf63e67b", "fcc3ee0cca89da3931b3e014925cbec2029c6c8d")]
        [TestCase("SHA2-256", 1024, 160, 779, 63,
            "27589dd2e8ae047b3f9aae95dc6a8c884e71e2710fb1bf34d4ac8d45", "27589dd2e8ae047b3f9aae95dc6a8c884e71e2710fb1bf34d4ac9864", "27589dd2e8ae047b3f9aae95dc6a8c884e71e2710fb1bf34d4ac8d97",
            "e288ec01b3d1c7729e3c1e9ba479d90c9433bcc9f5a6a67b262d537bab459c912e6067175fa26ee024dc655aa15ebba68639cc867cbb485039a4b16d5a8e795a1f314d363c1caf7bd3102e43b930d9ca4330c90b210aa6f96e0ef32bb8183c823b530d7423031911e0f2d0e8dbc3bae8c7d6cd7c5f86e783dc448e8c9b50e239", "d0ee7d660ab2dfe02260ac60986035aca5c70e6d")]
        [TestCase("SHA2-256", 2048, 224, 909, 183,
            "a49786831f83511903e40e856c4a2a51b76c17ade8fea89640ab6da50418def4", "a49786831f83511903e40e856c4a2a51b76c17ade8fea89640ab6da50418f49a", "a49786831f83511903e40e856c4a2a51b76c17ade8fea89640ab6da50418dfb0",
            "bf06881451594c91c365a94fd0afd2f2438c1a39a983ea9c08212592c4d3c51bfd1eb104ea0a4eeb63e3185f787cfff48169659fcc1ba3a7e985bda85baa564526e62e00032a2a8db5cc175512eac9fe988cbca6f0d5e3eaff80c4bda69d98fcd86dd204303fc26698a08b9ef987ec3c6873237a88adf8b41b8d32c2f0fdfcf0ebb46ae0262178199e3ceef8dc0d1dca6dc71a164bcfb165f8c632921ffb880b3fd92d5982cf4828bfec68907855918272622d21bd8df9b262e674b542229c298f040d2d3cd0e776ba86fde09b582328bc6da826b39a17ec914a884e3cd261076431714b72c1cf0ba109dae77a654ffc9bfefa0cb2edee7b7cf39e0b5174a73d", "c6da0e014a896b4f4597ec40b669a2635980fd2ad4a709099f8e4d55")]
        [TestCase("SHA2-256", 2048, 256, 1855, 214,
            "fe83c5a82ff3719978986b27f0421f99e79420066d9097b00ca26330c46f48cc", "fe83c5a82ff3719978986b27f0421f99e79420066d9097b00ca26330c46f7d21", "fe83c5a82ff3719978986b27f0421f99e79420066d9097b00ca26330c46f49aa",
            "bf936cd3738bf7d4c519e5aad673d1991ac496f0dc1a35a9ce202bdd13519761d508fff45c5f65baa35160e19669582f51f9a30b03a4b997770f3c3e939f04b9407e13b1a0c543e18e03ab937fd832c2e58483c28debf504e8d9aee941adfbf06a7f086ba936be8eee81aa0359123fbb6853418d50e80e1ea5b96f0250a376842e408fdb83ce6d7731f4b71a74438d5d92fff9f895f9ebb6943feebc16b3d052896d4fdf156332264a2d1f62ade817f564054b2ec52926b55014a140048c3a0a0674057cc50e7a4776b67055bc301eb5d429566bc094dd8be05b941ffb70a260d3e452da577996ef85ea3f13d8b716ee12b3de399ef37024bfbeed1bc308b06d", "ebb6fc5ae78edcb1cc838075ef74ce347e6224f38accb221fe904042aa552b8f")]
        [TestCase("SHA2-256", 3072, 256, 591, 26,
            "e9d2e51177fd269b78710c5264aa47a5718e465ac28d23660b1354968de694ca", "e9d2e51177fd269b78710c5264aa47a5718e465ac28d23660b1354968de6a656", "e9d2e51177fd269b78710c5264aa47a5718e465ac28d23660b1354968de694e9",
            "ccebe945da661b95bf90848d4884337751dc17a4c6794a0e58df7acb22eefac0eaa952aa0e9752ad92084b2fe03900260dfa35e81ae7b7a5de0863dfe9546878a76054919adf429c96e4b5005500cad92a549344076458c0c592e0f836c411d8884a83425c5953ecbe2c4e9933565d8f22f498b76a63d5b872da0c826a74d0622c75a95dbb5af8169655c46a1f04a2fcb82703d61dabb5c2c2875e40a5c6742353dd1b0dde9c7b33a215f0622e09105e0ee14ac82f0e017bf68131bffd28902fb4a6adf4742d7440dbd7a8025a90cbfd0cc0ae24aa00557be8ee465b38d2cc9052332129bc09febfcb6c6c62aeeb4a486bdc2253d5de0e4594095c4e0582a0cc4bf11a4a5a22e637333ff8bdd2fc51a3bea7954530e34d67873b4aa9de3749b55e16796a60b72fc2ef58ab918ead2f8b72d7d92ea9e5e8b376db04957d708bc15b593609cb746fe08f1418969d00d29b2a003c82b451c248b60652c6dca06c0c92df891cc44beca0c4c4e73538b8faf063ed4d61a09cc8d25c4a4778213fdd0d", "dc55450f3716c6298ea06a38bd9a374d91f0959fcc19ea05181aa0fe32ae3729")]

        [TestCase("SHA2-384", 1024, 160, 417, 114,
            "d1c41b82c1b197f9e3a69c9359485001b3b81ae3a3b2e1da39da8c0d2849605f", "d1c41b82c1b197f9e3a69c9359485001b3b81ae3a3b2e1da39da8c0d2849639f", "d1c41b82c1b197f9e3a69c9359485001b3b81ae3a3b2e1da39da8c0d284960df",
            "c57f4827e793f4d854788836ca097b33ab25962b87c0666a4966ec6396c5555581c106a5fa838364ad868839640581b4de2a2a344c2dda87a3ba27ff3e43c427c86ea7cbc8c8745cf56cd0a2cb86eb601081ed286ff44f667619ac36c03f427da72ead250417418008bff5057fe60dd6c813cb76c7f9c8158ec98e115f3260d5", "c3f3e54d611e67720f04615333a438bbf790e3c9")]
        [TestCase("SHA2-384", 1024, 160, 1267, 102,
            "455833b8c2030862289d337745b77c122bb30d744981ccd3be79824c16517a4d71beb136bb2c32bb813d7e89b1bef2ccea757594265874c0180895116f2ce1a0", "455833b8c2030862289d337745b77c122bb30d744981ccd3be79824c16517a4d71beb136bb2c32bb813d7e89b1bef2ccea757594265874c0180895116f2ced3b", "455833b8c2030862289d337745b77c122bb30d744981ccd3be79824c16517a4d71beb136bb2c32bb813d7e89b1bef2ccea757594265874c0180895116f2ce210",
            "8609d9e2eb047ecd1ede344b8de1a35dcd80679133b4bae9ab9fe2768c76658657174f56a8d71fc9bae1dc906350c61eb2deb783ca9e5ec8719e8dc78731620128f759cfe877de2ca5cbc8c1c367256f132cf756dde893d010c51d715af0258187e9767f720345937083e6819af9a4edae833e7688a2a4cda12aa2b7f8a8169d", "ce4d47f3cb9b30a498948dd192fb908ac346b8ef")]
        [TestCase("SHA2-384", 2048, 224, 1190, 192,
            "cc8c17cd0dfe8a28846f041ec3ef6a06cd6bd9367780283a05b2e73b", "cc8c17cd0dfe8a28846f041ec3ef6a06cd6bd9367780283a05b2f678", "cc8c17cd0dfe8a28846f041ec3ef6a06cd6bd9367780283a05b2e804",
            "cf360fa804443f69fd48cade82bdd651b63abd92858a1dbe78d0ae2883c4e032c52ba1d22cebc92d9ca62fe866a7f61854be386ceebbb2d428fb677d3e0e2027e614c11e262f8f57a58559e61cec90267608af0d5c1650aa43c14ac24d76d3ac0f369d5dd5ad9edd30c0adc326f89fb258ebc0bee3d9f820327ce4069dc7a5523b31721cdbafd0e7f346a975ec022c34e3375e7824f52d6e25da8502e48e9bd127af7a42ce9180d337631123e75d7ebf967072a2c99d13c0fed5398a761b0e6d1119892735ee81b4747d37094b11a55ccbd483213252a37cc43d1000e2dded6f17598cc03b47cc166c8be109ad2fcf74eccaef7a87b45e7e1173485261ae1e53", "a5c92e52e86b354731d278b6feb0c2b3e28e6225b9766548c71f7e89")]
        [TestCase("SHA2-384", 2048, 256, 1626, 219,
            "d78f1d7ed91c3bd1374dd689f2877d908c270f6bf41ab71182553bbf3ee43660", "d78f1d7ed91c3bd1374dd689f2877d908c270f6bf41ab71182553bbf3ee44d10", "d78f1d7ed91c3bd1374dd689f2877d908c270f6bf41ab71182553bbf3ee4374b",
            "d43ec73a398a163a537219eda4855378183b06e0436db96dc6e6f8be97c7623b2e4a10671136a30fb1306730f40a455920fe7358b66559e00f864b8f985af811a516466391484393e1a3a5d97c19eba960d0c3c97846e119cf5b8d9e5b02b65b43dd4636cdd7b528f1234867beceafff4e1e1a40779ef7ddabece97bea7061c9885ac63db9ae12d153b6c7d81a810af6d2f815dd001fb04b25fbec30d229f0ea552657f92c3f9f2799fedc22ae2867d37537634ecc41cea7bc8131155894c189d4a7c6c7db111ee06779bb5a913f9a6356fe8f7dd92ad5d0033eebeceaeff218bceac8da3de9ba2d3636db5e2ef4a9d377b461b5024c92dc32500a34fcc61e07", "ea621e070b8a0abf23a4703085de06f3243bca5feb8a7da2616d5ea1c9ada84d")]
        [TestCase("SHA2-384", 3072, 256, 2913, 50,
            "d5c7e6522ae28220f13e75d66f460ac0ee755ef857264d03f77735b8793a255c53910dfbe5d33fd44e2e6895702185c4", "d5c7e6522ae28220f13e75d66f460ac0ee755ef857264d03f77735b8793a255c53910dfbe5d33fd44e2e68957021c60c", "d5c7e6522ae28220f13e75d66f460ac0ee755ef857264d03f77735b8793a255c53910dfbe5d33fd44e2e6895702185fd",
            "831ff1d02b089a082ddf4df32feebe6fd6903004126df6c5929c025f3fa78a5f68510fb1673149b7c2197ac1ea46801427cbf9f80a74201ce16141d227b4a2d8fc96d83922484fc55ff82df4303198a4a99375331aef50c178550e5604bb2c74c98c2c4193a97a272619594c38dad00d89d14f9502ae461706977d79c4be649fd3cb03f485be13d58a5784771e8a7bd5b3f08f63badfb678ad97622dda38920b49ea8e78ff76faeab96142eb177fc8f17311eaef2e226736db043669b2b43b248cee3587ba1395782dfe764257971acffc30385561d7615ec124e6f89ee2b9c6b0c6324c47bbd351fd68f294f91ae5a7d0e0d35307d7054cbfe6923ee08a43ecf888812849961b1ae2ce41fb0918fe8d66aef9d6f55be8bd73f2b506edc1adfa6f6d2e127424593cd9d62fc6b4deea256b36901e4be8988d39060c7ce0826d5166b44d4832ba6b1601c4c7b8b268cc66f1222c694e6476e01a2c4e3c325c7ec26cf90abe8b5b1fb2339ae789c709f91849a9888f62488617d29b61904dc7a91b", "e5ed3c092a38dd2a793931073a70157053d7cb5870ef5ace53af088f42358049")]

        [TestCase("SHA2-512", 1024, 160, 1042, 47,
            "351508eeb9e9a2c3d0036eecb192154718e08dba6ddf53a531ea1277", "351508eeb9e9a2c3d0036eecb192154718e08dba6ddf53a531ea1ac1", "351508eeb9e9a2c3d0036eecb192154718e08dba6ddf53a531ea12ab",
            "b8e97d1a38b8afc571888fab17e82f4b6f5801f1ed3dbb5b1949a10bee930002452417be96d397a76a295dca4899fe8319d9962b5ca753a767941bf38ccd67f1b8d194d83b9813b5d4ae0bd24a8c889b98a7d68d27ff65f0601cc747b32cb6fb91283c6344290d1923a9aefe22c2bcc2a2b60aa5a01f31c6854bb5a96872e767", "bdca08ddf5f37d5b3ebbe54e29f385180d3153a7")]
        [TestCase("SHA2-512", 1024, 160, 563, 104,
            "de5c306346d2bf7dc256f62f41d142aca1e90a6d93c240d82d8a0bd24d0771a11edcefe941b072307573ea2a86429ca1b703148dd9b343af6ba16de9c40b815d", "de5c306346d2bf7dc256f62f41d142aca1e90a6d93c240d82d8a0bd24d0771a11edcefe941b072307573ea2a86429ca1b703148dd9b343af6ba16de9c40b859a", "de5c306346d2bf7dc256f62f41d142aca1e90a6d93c240d82d8a0bd24d0771a11edcefe941b072307573ea2a86429ca1b703148dd9b343af6ba16de9c40b81cc",
            "aaf95d3d0cd0652bf6bee747205104138209d9848882861c63cc69a3f636b10afeb011b671f68250e7210732342779f7e9d53f364f3f310960953df9df31921767f22532ccdaee028734a222224b7147d93621c00e131f4b817b9a9f0fdacfeb6b01c001ec12163795e670af5847d92e91267a79900cdd7b22c4a37891826de5", "d7db65d6f66ee7a9fcbc46cb8d1aa0244da6a485")]
        [TestCase("SHA2-512", 2048, 224, 1603, 68,
            "9005d12f7d01e4c18037c487c14c75ddfa9978de7b4e74400759773b", "9005d12f7d01e4c18037c487c14c75ddfa9978de7b4e744007598c06", "9005d12f7d01e4c18037c487c14c75ddfa9978de7b4e744007597786",
            "a0dda8f0831e1369cac62b9bfcf2b6c9fa637efe0849e9b68a82ece17c9655c1c0015838282fe61f578c493d953f1da6ad72693a1de1fa02987598396d19df9a64e1847dab120bd6c3e5c563719f61e7682a8b167e63c73856259040e2687ebe72c6a8f3dbd0484e343b33002340f690172d8a7534a261ee38a2abff2704995f4114cb4825e7aba9fb05e614afa0e8822b6a861b68974269a0bdf89f94b02e11f3c5a4aba62e20d417d453f7f7e636d4abf051a85b441afc3447a20a933e0f952743da1adfcce8c6a03577544b622d4431a1474c842b51efa532f0e59ca20326ac67637e9d488ffb6ee34186b3f8ff20ba6b14551dbe6dca2ac51a50659dd915", "a8b58f4c5f6b6e65a1345b627b6a9ce5b0cecdbc265d8cf017623f77")]
        [TestCase("SHA2-512", 2048, 256, 2168, 120,
            "9eb38f12342f1fea333ddbae271649a6be1c50b9173a73d05136545c648e0e78", "9eb38f12342f1fea333ddbae271649a6be1c50b9173a73d05136545c648e2ec1", "9eb38f12342f1fea333ddbae271649a6be1c50b9173a73d05136545c648e0efa",
            "b80c80d28218fe8415bb104c08a0e3ddc70109cba46411c9b9f16989a4ac622cedaac157cfe28294a9828ccb88485f1f46ee47a83a334391e0098d57fc54bea4150268a7c626db1dc211106d454a8de23196f84802530c9fda1aa10b971f6d885e0bb43ca7b8f6d97ea925481a63a96c645c8f58fbace2cbc5140261d610ca2b8b00c690476cdadc19f9c665f3ebb55d237448e7e9a5ed7b580bae2edd885afff236f3c64244989e06e1e65fcaffaddb9f36f99f92e9790d5ceea851edccc1aaf704bf1a9781faa5469099a1daa0d1f72d866e48ad316590fb2bb9973936d142ba4b5b85f6b3778f3d64aa770eacd76819638436dc8d5bc6ed634d2a054aece9", "ed6b478db8b59bfcd48023e45abae46d9a02d9a6f0bfda57c393652866395cab")]
        [TestCase("SHA2-512", 3072, 256, 3748, 354,
            "b8ea4c35cddf00368700f07c2977063da363c201da6cee7635899adcd6ec3216", "b8ea4c35cddf00368700f07c2977063da363c201da6cee7635899adcd6ec7c92", "b8ea4c35cddf00368700f07c2977063da363c201da6cee7635899adcd6ec338c",
            "c7f738327614cabe85055ed8cded5057c3ebb16518d6d37242ad1d5082e153080a24018b7171c73d5b8afb0def6355731c2acd1f77d929b06aeac008371c6edba2f6dc321369510d9f43f214c84dec40f1faa0584606ace5e1700552cc1811bc6a3ebc1f629709b7b2aa379f24d7b575b835bdf42a7676d4394c72b6866508b6a8d3a29d3cbcced92fcc1201122fc11c1f4e135b5c3178d61ff57c4458387a00773c39c861f65a01d285a2a2f4e8b14d1509437d0eea36b3bb171e5b1306dfe0a82856e78d6fd184ccf55b77b866d8500124c5f907c65115fcb1d60065ca5bd92f251fcae1b487484e6d48be15b08a32dd6541b435e4a8bdc1382ea5ed045887b24f73923c8ec4353ba8079f46cb959c7a45a55e8c47b60edf2991bb608411abf47cd97609ded4ad332ecb63d933541e5930c1680ad37914325e6baa90372331190405a96fce503cf0e7a5bd6521f3cd7b327be46e890344cede75eb0c707c83044d5910362f7cbfd169f9ac876a84c7d0c5eef89ba15304a95337797ffda96d", "e07d13d899530c7e63201fb2fbad9a28eb8191717ca126259811c80f675ead6d")]

        [TestCase("SHA2-512/224", 1024, 160, 432, 169,
            "f901892218469ea7477693c0921d940dd77a4937", "f901892218469ea7477693c0921d940dd77a4f19", "f901892218469ea7477693c0921d940dd77a49e5",
            "81aa2d2b2a70be08d4a374ad2e5423afd05cf86b5cd56d987c5ee158388c1290afa0f5c22088606b631676e33b3e5b9b0b51f7e1b8160ea8a0228a86b2dfa0172716d987a13b301f70c7319115dcba8d01a60267de60e451bedc5e443cf17ba441cf7ad6b215e16c2b5a739c775c559c0c40471abb595a7624a4820c2a1056e3", "e78f8aabfdf2c18297aa605c437fe70f0c825bc1")]
        [TestCase("SHA2-512/224", 1024, 160, 201, 47,
            "13eb41483c30436a2cb2e178b7d965bacbb93ec68b1fda34905a95cced125302", "13eb41483c30436a2cb2e178b7d965bacbb93ec68b1fda34905a95cced12557f", "13eb41483c30436a2cb2e178b7d965bacbb93ec68b1fda34905a95cced125338",
            "f280a8d357ffa1ea52bef61719456146fb89711abcfb030ea38f28aceaf81ccaaf717199906261a1a024b890303effe475526b78bf18010b5708b3223c4f42d9f86822672df27808c26d1dcd1c374e1a14027d2a434bb68566e5e6a983dca9c0b37aad331ff9fd8ac6f33724cb9096cf34108d9f5d5470e397ddef84f1748f21", "d918b70168c5961d8d853d976635cbf7bf5d4ea1")]
        [TestCase("SHA2-512/224", 2048, 224, 390, 44,
            "beaee7547142d75d9bef45af38aca2971c08ea04b77eaad2bcb1fb6b", "beaee7547142d75d9bef45af38aca2971c08ea04b77eaad2bcb20669", "beaee7547142d75d9bef45af38aca2971c08ea04b77eaad2bcb1fb9f",
            "e73cf274222c2be5ce15f0f907544b9385d6b48ab923b34d979158c085902db7cbf68092466907ceb8b2fd1c0f5ac8adfec1039addad2f830e830cb22b41e07ad6f1f844f7d5882faaada427ad891bde7c78a0d34689b867cd2a991a7425fe20c24a09769548f7015f4f7213304567390fcd918d81d9d4a68751009c77f7e762e47e8e139b6b9efc623cf60ffaaaedd4fd66839c545d51844fbdd6f5e4c3d6f91cc9b36ed0fa5b53b34d20fd3473dd10ac3b3728b3e3db7b296e779549fce8e91ebd6610191222d4c0690b02f25ca5c4191efe5a0fb5db6f0418784e013beb397faa5e49d17301b8a4617dc3a367aec689a122d894cdfa837a6df403f17ccfff", "f83802e576b8f3b97311c06f01b110f1bde265a582131456cc69dcb5")]

        [TestCase("SHA2-512/256", 1024, 160, 877, 32,
            "90d24787346ce223fc6b92470af42b6710a8c99b", "90d24787346ce223fc6b92470af42b6710a8d571", "90d24787346ce223fc6b92470af42b6710a8c9d4",
            "bab8091a584c25860b5607fac5b40cca6a19cf1d15aa7fd6ef01c53016b98f1e340f7524ad276a03f737c95a45d23fec2f279ab533a6140141b14cabaaf407fc871d0352aa1ba0739958c82e5881dd0567c95619311aeb19032738c0b1e18dce5c5e7bd7145bc03210822c274ad50685b7e8e9c6de8353336ddf50eeec49afa3", "e6ce1aec28c8aa3d34a2f3752f18228f3cbd7fc7")]
        [TestCase("SHA2-512/256", 1024, 160, 529, 30,
            "345bb34ed5d5c3eedab8f91631beb465f010610a6ced8625b31a102133ae314477086a600e0b6a040e838c2b535bb4ad67e320e7fddf368e4f0241cbe138a934", "345bb34ed5d5c3eedab8f91631beb465f010610a6ced8625b31a102133ae314477086a600e0b6a040e838c2b535bb4ad67e320e7fddf368e4f0241cbe138af46", "345bb34ed5d5c3eedab8f91631beb465f010610a6ced8625b31a102133ae314477086a600e0b6a040e838c2b535bb4ad67e320e7fddf368e4f0241cbe138a956",
            "9096d957a67b567a5e9c956a00a3d54ee77f448c8ffc935a72cc08964a516ef8d1c59aae13ec2e94249a8881ee84329f034404ddbbcd2c30ba52a233d55ba73c796fe9848f5e8988f29aa891adf16b96c97dfa4e55627638b5e3c224510b8385b72690a0dfdb12e7b065e0510fd2837d4d107e028410b850c9345dba1427d6e1", "ec640c74ab29558dd06e4157aee5864ac1204843")]
        [TestCase("SHA2-512/256", 2048, 224, 1145, 174,
            "ef0ad209648ea0fe9bc4708dbb7548d243077186728c22938fe36618849e7019", "ef0ad209648ea0fe9bc4708dbb7548d243077186728c22938fe36618849e86ce", "ef0ad209648ea0fe9bc4708dbb7548d243077186728c22938fe36618849e70d7",
            "e5bae6fcd58a386cf1a1175abec4210bc9a3d722cc707cc4aaee3edaac28c8665cb041b53527d09168314cd829acd009eb28392ebe82061987acb45644ea399d932d73aae62974447fcb2ae412fe603356d8dec056c12c129a88aa5fbf4e1d140c5430ed0dc0b9e1b8b6a8227de18afc3748aaa0bf79a1d4960ac011e62244a65a00b0e00784700d377a2cb495aa37641938a7b707a66023675252efe14dc96644311c88bc900ab2d3244d2518bf9c846210943692eaf1f21b01b0721cd26d87cb3b3d097096587cc1fdd6983666d88e319a28805ceedf3056814da0e41a0cc28d4eba6fe09b20c5dcdc7ddb839d116243f1be25ce571003c5200684224ebfaf", "e3867bfc348be5ec50b3d1c9bda94448f07132f6100497d88a764dc9")]
        [TestCase("SHA2-512/256", 2048, 256, 1388, 132,
            "c3f873d90020d4cedfb544c15a5ac83b9c50e805729acc3c25a79f0ea835fb2e", "c3f873d90020d4cedfb544c15a5ac83b9c50e805729acc3c25a79f0ea8361ad7", "c3f873d90020d4cedfb544c15a5ac83b9c50e805729acc3c25a79f0ea835fbbb",
            "c36267522cb4ad5c418dd8e23120f28de290d48010bb42e6e633842d4ee81992c2da957cc5213f8af5413fe3761ff2e847edb8fa5393755fdd7861891a920f7900dd8c4620e4ccdc12bd151e400384e3a4577f58daead4b8734b94cef2e17117b824509931df5543440630c4a411e68b38b8f58d8b87c7227a755b077656e3228fe33f38ed4eac59cf0c49a13fc6a15f7422d2084b2b76b318158e89214e232ae482bb9109a2727da78319b74e0b7c51d79111387aca03dec7b997061b4e9e2e547b68286e2045241af1eb44aa41fbb099543793d7a55509beb6b92af761cc5bef8afb7c177ce0bb6a69ea213329dcf9ada340a66ad5fdd125d31436124bfe01", "d3868e1eac5fac475f9f99c3f831faaac7e9ef83c7dc34bf5c71b75e81f76737")]
        [TestCase("SHA2-512/256", 3072, 256, 2250, 96,
            "8e906bea7c0922bfc83dd71c33afa6a46277713578cad86cc8d2846c58f42e065501f9db8cf209d1fd68ec0c6a2dceef", "8e906bea7c0922bfc83dd71c33afa6a46277713578cad86cc8d2846c58f42e065501f9db8cf209d1fd68ec0c6a2e13f9", "8e906bea7c0922bfc83dd71c33afa6a46277713578cad86cc8d2846c58f42e065501f9db8cf209d1fd68ec0c6a2dcf58",
            "9e779527c2fd0e14b464c0914cf59839d2d79700455d74ba04f4f7cd62b658f4de2ddf586cab76dfaaabd744b68cc713071dd00e375db11247fd62aa6eb15dfa1a3b47863098cf380fcdeded46e51e08304b424b6056a60abc3bf781803e345946b44067b080deeea913f2024a33f84d191cc2da1d5e67cba26160774b713a84172ec4f348e5c6181afe5207f3107803f8f76342038f49ec2ee45dac3c6d91320c44831c7cc9ce16fdd21b7e0b8e1300fe949660af646ebf82fa0cd2a93eb199ee1c110629c0672e0470daa37215e69129810e8073b3151835e050b07997dad42e9d23fdb52bc20a9f2aa0fc71d08e92b62877b6976b77550ccc4ee6d9599e297632c29282c46679fcd92b280a0e74da19f50a0bef2bf7d916d0536de3ef39a5b3a82ea6d376cd61375612f8ee1d84dd617774a134986c203abe0abd65938c94f4ee48e867e630f2c13e9a4041e5a984c4931d30670984a7193c0a15a79d4b52ecf7c8adad268d6574373973647f183f310d114b06774ddacbc332aab2c0f601", "8d9da7fb3249978d8c95be0fbee1b2a200fd3573a388327a8571e0037e7ad861")]
        public void ShouldGeneratePQProperly(string hash, int L, int N, int pCounter, int qCounter, string seedHex, string pSeedHex, string qSeedHex, string pHex, string qHex)
        {
            var sha = GetSha(hash);
            var seed = new BitString(seedHex);
            var seedLen = seed.BitLength;
            var p = new BitString(pHex).ToPositiveBigInteger();
            var q = new BitString(qHex).ToPositiveBigInteger();
            var pSeed = new BitString(pSeedHex).ToPositiveBigInteger();
            var qSeed = new BitString(qSeedHex).ToPositiveBigInteger();

            var subject = new ProvablePQGeneratorValidator(sha, EntropyProviderTypes.Testable);
            subject.AddEntropy(seed);

            var result = subject.Generate(L, N, seedLen);

            Assert.IsTrue(result.Success, result.ErrorMessage);
            Assert.AreEqual(seed.ToPositiveBigInteger(), result.Seed.Seed, "seed");
            Assert.AreEqual(q, result.Q, "q");
            Assert.AreEqual(p, result.P, "p");
            Assert.AreEqual(qSeed, result.Seed.QSeed, "q seed");
            Assert.AreEqual(pSeed, result.Seed.PSeed, "p seed");
            Assert.AreEqual(qCounter, result.Count.QCount, "q count");
            Assert.AreEqual(pCounter, result.Count.PCount, "p count");
        }

        [Test]
        public void ShouldVerifyPQProperly()
        {

        }

        private ISha GetSha(string hash)
        {
            var mapping = AlgorithmSpecificationToDomainMapping.GetMappingFromAlgorithm(hash);
            return _shaFactory.GetShaInstance(new HashFunction(mapping.shaMode, mapping.shaDigestSize));
        }
    }
}
