using NIST.CVP.Math;
using NIST.CVP.Tests.Core.TestCategoryAttributes;
using NUnit.Framework;

namespace NIST.CVP.Crypto.SHA2.Tests
{
    [TestFixture, FastIntegrationTest]
    public class SHA2Tests
    {
        private static object[] hashTests224 = new object[]
        {
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d224,
                    Mode = ModeValues.SHA2
                },
                "",
                "d14a028c2a3a2bc9476102bb288234c415a2b01f828ea62ac5b3e42f"
            },
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d224,
                    Mode = ModeValues.SHA2
                },
                "e5e09924",
                "fd19e746 90d29146 7ce59f07 7df31163 8f1c3a46 e510d0e4 9a67062d"
            },
            new object[]
            {
                new HashFunction
                {
                    DigestSize = DigestSizes.d224,
                    Mode = ModeValues.SHA2
                },
                "ad82061ee0aa88efa6e85ef827d3989c88082b8812c339e990ac93dbf8f37d244e9eb122c622a6022931113379d4ad1ad8b93708a6cebd69ea0f193ef39bb9cd3f0ea1969b0bb28a8c182c78eeaf72c8db910d6bce5ef41208630a9e33b3e9d84679de63a88c34ef9844b6aecc8d6f0c5839b49bd29b654cb4516fe5016195af2c88716f35ceb598155eb7bf5c952d4f1959347efaac9880b4804ffaa5cd46b9b8e261a48af9bdefcb0d3892e6f033fae49896fe8db91514d19ab2c56721835eb42fb6e9ee34d25b81fa3f0fb2c50973829ee102d5ec6572d344a12e8f82d506e6197825aba77e4401cdd71e073d3824bb141d71186b0f008228221d641ac3191846b042077b4812112d05a72f80477356a253359f5e9b28a6ee407a2f11d5ff105e66274bd8b82e7ac2d39270b5beca1def8a35b2ee9151063e002d388f9321970aa0bcbee557fe033548c713042690d6a4ca5999427ae26bbe6c1ec7bb86e574f268e9aacbaceb762e6c2f5f96052d4a681b899b84de459d198b3624bd35b471bdc59655b1405e9a5448b09e93e60941e486ad01d943e164f5655b97be28f75413c0ab08c099bd3650e33316234e8c83c012ad146b331e88fb037667e6e814e69e5f100b20417113c946a1116cc71ed7a3c87119623564d0d26c70dd5cfc75ef03acaea6f8c0e3f96877e0d599d8270635aee25be6d21b0522a82f4149ec8037edaf6b21709c7aafd580daaad00a0fd91fcfe6211d90abef95c09ddbd4419f85026f30c3b25f9dffb76875da39e33e15093066b232fa7d56d1bba1f2268239a2eaf4e6d6e390b6afb7389bacfeed1c859adb4b574b95f7027ea122cf6637b5574e4673a02eb82c887cf7336744b012f07bd77b5891eb82bb457b0abbbde97d6ad66ec16ab95e6752afad255436b3861d542ce0fd2b838748ce5040fc531ff8a32973b67bac0acfd5f76359bbf97ee1d5cce3618e41e56c72c028acda4f618eccf05d3c1d3045ccd8fd20b6e4b8998ce08b02e552fd9a9b01c30b369fd937a7abd2343a966d95c62568ec2616998ded063a94569285297abd8102c6911b2aab0a7801972f8a852582e1cf919ac4e06e0f819e9b96011a736d9f1444fa3ac102af89cc3d30af9a51b810d2ddb9621d76c2072a9ca69af6ecdbc84a982061851562ae9b13e1065eb28f9cfcf3b89bc96ce8753f410a77434fcda2aaaa4cb6fc4aed8f780189b458b0ce2e56bbe2966eba4972e67209c28c030cd53f62c561b00a17d36aef72e410b43f6de61d7e7c93c7ada72617eca05670600a0ea9d58b29bea7237ac5e2bc0f24a802b602d374c1fbdcbb0718fc3b2bfe90e92165c25cedcc6626ae6b2264dc6ad294ce502aa77fbe9d57915d7ebb921566197f80d5fb869e1c8510ca7a05ffec85cc34f1cb3d5578ba23cdcebd48141da84330e056917c9a90e7a8c831c701148852f2cbfe5dcb91f9c6c2540008387e1f0e3d6f8d45552a8cf57c4e91d16949a5cd10c80b2f6a7123e978d58e2686a09323ad13c1409bb5d6579745e04cbff2a2e594cf39dcb9810033f83ab0c886eccc2988b63ca9d5a337b4fe93675f8c79484388c7d28c4127574d496cae17c1c891c9d63f44a98c5b77b4bb226e3356455f8ff39a1c6688ccf1de7352d03abe9dababa096226847475e00d4d83defa8beaf70de2f609318d9978f7fd35e5905d4e376eea31e0d8eceb440549f1bbc074cff8f506ee53b79b40f0874d99f9e1fd3ffd2c64e7fc1e958401b405e52c2fd571994513ff58431c721f05a4bdc2f9304c769327f8fabe14dcb3aa2fd28281147c326e98ad699ca7997f03a105d34e9ce05e0391e94f4fd161d458163e617cc84c6ed2137d1a0cc3138af1b126ad6aa987fe2e313d7c3c619fee3e67ad3b6b476ea93002e2ec2bd59cbd605384b3c5dccfe153946a041c3bf36bcd829392e5386f6bd8f5835262758190c006a47908ad14a21429f37957c708c795f585ea6311ab415d59b2ef59196eafa1590a7f7b90f2baf0707e3e97995cac283ef8b47d49cea43dae06056847b05474b93b49b73ee69678e64ed624394b63e4dd70839c67261efa6101472876f349cab59b3a43fd6cbf0e1a09d2a61d71996c4f61da38f06e1c04211927022da3da13bcbef3aa62f1bf308a13b695bc4ba72f13512adb5be325eb5cd2279dd24e9fd05d1af832f611f1709510f46bac56378da7c2e81c2041b72072a0cb541b5005911543aaa62d4a005ee9661ea0441da5389b4bb443e3f65a44012974bd5f54a5c653ad9d5c7f06564bf5a787dc4a0e8a906c3ff21afd6d89b696c0c64214d8faf0b6dd42de71e38dd82849d267f4955235793433e9f333c008a20b327ae2396f90bd373d949c4df1841fc180dbfa6e968860bcec395bd597aa915d4bd03e028e36b56fe01754c23bc03aa315b0b1e6c219b12ead91adcf7b2d035b74da9ed0d1535ddbccff41ccc71d1763038ec19a5f59c92dda8b5f8dd4f0667a40026b00d36714ff6694d9ea2e1b2485ccbe9ff5d8d9372f057ee79d4fa5493e2fe0493efee2596f4f708386db2ae08fe3d8a395c90879a6b0e4dc8a45bc0a1ba6ecafd7de75b99fea2ae54f48ccd9e5eb5572d6aa781f196f75b4b1519557a747801567dc61a405c91c659001818f2c45cd9444f7a8861b8379f6beedd180458463005b8366b7355eed8af59fd96ec785a97e6d2b0a4d21bf9a190f94e1328adfddf74f6dd541a32de6cbec7e44f75c1d6197cbdf1dd2a0563ea23fc154dcfbdc8970aff63e01d3c8b0bed12754c73e9f8e86cd6e73c52bf9d018ac0d9cedfcecdde2f9a711464b81d3ca6015794d036ea8b20e638c83291d06e2f0d439f4229343f4b91affad8f1bc88515d332f72f1d18afeb48c8ab2c224ba78abfbc7de16263fc6aac4995f2e8e7654eeb0264361d86e700a8c88bb9cc06ccf61a84e9ddccb6809ae59f9e2b6be8e187c778029d024beddaedfcc3365cd0c9bf8f23d65c54a417a6415234ad2725805cf2f450e84e002ad692e5e046672234439839b2017cb528296a11e7dcad35d84ae817ed9c632c34703214414e7d83832e90070b51b78248a0aa4f265e60824fbe3153272de428715445f884d3026d3ccd314c40c19773ef889c7a8e96e3935d3349269c11439d97ef491329588857c7cbe65a00d59f02835dbb247f0a99019756aa12badb03f3eeada5e48d6391dbcaa719b0ba0220c6baac80cd764e03257474de98120f97b40c1bf6fd4f789151abcb55f0eadbef28ebe187d612c5b4a77b3a41372023816666c6b6bdde0c1961f1b5259b01c73cc19d892afeb3062fe022039c60739b6383851a6fb6c7928c7512f1030f9d58abf9562004780583d767ff6d2ab47aeb8073fd938c788aa08d13b60b78cf1c04af589c328f0258c33db769c38693a4989ae026ce876395ba7db62170e17a1c6fd967d63d250e4b48d556f7c33a9e8f370530a737fb187744f0e50bade7610cde9c9f9aac80fc4b8940bf3fd8a135a92b41fdd54c61f7bdd46928cb3ef5446be58b78600d1d6ce808d268987074e970f9e39057982691c7ed48e9e6809574c829088abcdb44d08f4c3cdba827003a75376c90a487e36733f432a0f43f42729ffda63f1793a1b7cfd7d290d568ed9934584f9722b812f8609d99065aa776de51f7d70df6c2be8328102620a6c297962cc0fefc78952fc5fc2e0e52b075cd189c9c3d9fd0e4f5e30699b9f392a098a1cd261d390caba4406549e54e6c169fa1ce5f2c3d3c86d23809e900823f9f5b5ca3ec0ce565581af81a55c0220406791a65a5358ea004fdf2a0729c74f42b6a272f87508a0946fe7da9f611a60ec1d3d30122ec0c91fbb3b348bae01456b14f81fe7c7a8f6ee4b911929f7c22f2d55a7c0f4cb23f88e7adea81466e18eded760d6f500d6e0cbdf58442a6422146bd57761e871a800b454728d899a8cb101c781a10967bce793f1e1658cf164970e665418d6697768f8109cecd1922d363eac04870b437f92af4ad78336e6ad407ed0e6efa6fcb9b8c47806ccd696eaa6fc4d9091e4dd4a6a85b2e0a7108b289823dbd6ed406f96797f5258357feeeb88a273cec57a7d43f67ef1a4d80227fa26664fcc1a8d0d353290673930b4e159649ae6652db66a92be02cecd1ef4044e72adf36f7f731dbf6b617f52c35db85cc34b6efed180ee604a7a120081ce684a0561906823dbe65bac59624bf963bc1b2b1dd341b7c14fd5234c85e70a789c1666ebee5e0faeb1327ee0d7cbd7ac32bf2778dcd5e95fd618d0e2ef2ac0dae8db1db1d5fa49d2c66c685ea77a6721656f3cc453636f44cb52d9a31871acdd93c1b31d0de4db316d30f33b9a02b0aa9c54f469fe924f5676aac7f6c863d467e7efaf965dc3ccb2eea6a5e07808ba301e96d6cfa50b937f1e492045c6a842612a8e99838f40253c90f709b309378e99345c6a5f127643a60d566ff7dbe9feb4a5c5fa4e6902edb99d4ba41d153433cf26ce397f0c7a65b389fa3974cfce0e46a0bd595eb4b22c105bc9008763aab1b83c16ca985abf038ddb5d08236afe7c01639d3e1b37f7eb29139aa457bc3f113ebe59a513c5ee241e4ba6636e732250cc358e31edbc7a31ec0ce518f7e89b5a48f3c2535615afd14d20fed3bcb4e1908e60b8bb3c09e2064190d3e5cdaf6794bd24765bcb12a91102a48cdf76f3e446312a426370e8d87210e58c9243d94bc78799a045d98385ec251d790f02f9d2799cdc55b2f11e047e415437a7bf2deefc8d9a669ae732ea6a9fd4ecebc98e5432b7bd182f28760d31bc25fdacab74f93bb76ff0e15fe5819456110efc337912786a17b4627bb79c9469a0052a6e76138aed5f67a2a865f271331c06c9a984b3539d3050d353a858ad300d78a970fbe5f317b3f3662a7ae4091e3cfdda9175e0cb3852150b1913ea86fab37daf19cb177d1db4bbb34debff6500ba1bb8541540e923c32b9133bef927addb3dc6d1ad5030e7a7e8147982ec8cbfde87ea5b2c7cb447cbb9ed0b712e9633cddf75006b38155ed7a10e1605538645f06af80d823b358ab4e7a807f631dd72d18c450ecb7833688b0f2b8c3ddb5c7838eb6bd1de2672d5c4df499114a904542f6cbc6396b893ee0a5af243f22d1542fe33ca110ae4751145c65810923e11c02ea66467939f3bd99da9eba4ecf1b98a89699d34cc1e46247dc75dec39990e9d1763c5838cd6350f8c249f15f2ce513822b66da2ed7cebf8b507e18cd16202d532ca651d4705897a1ff595ffce6ce4331142c0c235a56e7334b16c5a2240f64fc704ce9f8ed33d019e4155cb46747a659e3421fe6b42d67f44eb84bdf3dcf1f31e38886f27e85b8b503368df238e1bb511b515bd59fa2c032bddb31d0ddefba97f8f19f7daedea027ef055a52c61d00bb1ec2668c57677e632b180e339ed1c5931310b9d718af34d70a3a4832b96a04fc702db65785ebf12a18c73753db15deb7d45e6cbb2667d546e72dee3e6d494699b1ebc1d3a590d6ec098153ce1d4c547abf330e8672a90ffc0858a2c27c4b342756952f8d20f68e2d6fdeda0effb5d560365735c567d3436ad0530c6b40e05c09d0b245f0a29d8562de3840a2dd02cfeccc0368e480872e17e1a5919555992cc5a2bbbb8a84f65b20b7160e065fb3a28502f02e8047351e87ceb8c8dd44d634ff6f19d6c752818deb9cf0b8b5d248fbdd5d85ed15465da33eca1518af8937f2fb78654e4395df8c37f260d74def234a3a4e3d2b1fe8614aa1963307888d3ee56e6126887bc950d47a49eec02af0d30c40579e6f1cb7f07364a5ab2bf4db4b9aacabc5fbcc5796053725e329c9a1e8b063fc223f783f8bbbdc6ae5ec70fdfe715adadc3ed1eb1f8d02f8f66ac65cd4d539ce5102cee983928d686bcf895fc807ed50d1b818de4dea424581199d9c17f92620a36f8d3088860c20a55bba9b28dcc8b03f0e0dbba18b999e2bacbbea329abda5b1bc4fcf0b04cd264b07611a914e917b7c972d0ddb0f5d654e9aadc1a51854cfd49f62ff6bad34eb95693968a20bcc1522e9e33f2ad4222d7279efacf010a001b48f835c5addf7d34cd7800fdb62dd1fca7cfcea41887c793fa0fe26940213ddb9e30d6039157a8fa9f8f17a9e0248edcbd6a6798f8ac0bafed655a9117b24d65d508d9596e221736533ea337a589421bf7d8c7795598375485082bef8ca676e275e6086e4d2a120e72ef6b4e0e4433e0de81b6ed383592a94c601d2aaae3017a043429eb3556e1aa83093897213ea954f8cdfb9ca86a66d7c9d6f7eb765236540c5905772f8ecb330ef4d2bae85dee9fd0256030ad1ff90584d083d9fadb5c9914bd64bb42ba19d19c17015e6b8a49e8ebefab4e4f3c955c06b7879d3d67bc70a5c80e5e76c314abb4dc8d2bb1ae0157d394a5a097aa8004d6f4ccde47dc9f0246e2ca09d38f01eadeaa3dcbc2af5f160f7d16ce8c4f02247ced1a4521244b777f73616462072bb5a2eadae3a677ab4a2711c680361465e4810c387ad22509f6d8e39c162a13d93589022c1e65ec2d1ea3b77c5d9ee1ef6d6cb8f02462c920a7da9a41c8339c52921a5bfb2108f82cb80cd9020dcb9feae7c55808ebdaf6dab30c0118218688dff3de5d0f979782f240eade1e39c5349c7a1556497941967d42f67eebca2ac1c8805b7030261871c5dfc32e9989958a4e4ce2197b739f90527b217a806a272d55631bfd257695afeebc21313aa442884788b7096684fccca187145ea0aa86b6cec1a66ab7301523b4018b4fcb33d415d154198ed1526132b28e579013324e437ac58221aefca1b561d38af012dd541b32d892108685d5aaccb7737aa1a987bba2943988d281404d3c5ca57cd94bc981b33ea9f74bc6611c382aef8212b83a088e595309ea68fad38cc4645be6243b2f9cabe7abe9bd0c703f1053122d066e11863a560bc058d72f9a334ff50111b30c3549d2942811de8e27912891bb3c2bbed25fccf61afae04aaed0efb2f4ba3702c540f41bcf6adf5e38d4f567840179f7b9f13c31c1f61c0a0fc3cbfb86c6d2f896b8d5a6a87218c9bc0242fb50fe61a484182f267df3945807356b367ede89d7eed8fb9f79ce90b5f94298b7e7daeaad7cfb2c3c15994e1ddc4e58cda5a9668516c8f06c0b294f0c38bd7d02113e1dfae6c3bbdb5392543fd7351926c3d070eb56b13c7726295eb4c19a7c4495d200740d97646bfd83aea8401336aba0faaff1f5bb65269176c497dc021ae63c3d9e0138a0b054dc17623e5f0f38c203d02c803d0df5e316b9899bd11de14ece28fc8aae0626ffb8f47aeb7b52a6d5b5f9ee7e74d074157b9ab6aae71258e5133a24f8b8f04fd259c2fd95de03084b7f1efdd5e32b682389c052ab680a0713d21c1d319e86b136862af426ce4be78c27e7626bd2475b7708d465859a2c7741d575ef1fa8f2d69409d366859452c90075fb242a894bd478c07df822c6a12fd5e2eea3a91e594652a8675b9a783f390f33034bf84f605c8e796411693390b739c22f3fb647e687da2c8bdc4dc13abc2127a6e0bf6eae7a21fa31bb422b2298d33ddfce306cbe23925ce9ef86b96ddc9e1a8dea662c5cb6990c8bfb95f47f590d1aa655fed50ca2e402299f2da6fe20eed56071d5d293985f771adb4ad7ce824e232ede08caf68a37e4f3f12ad11510791dc67ef4a77aa9d90387624a1c389cfd1e1c703693a465f2ccedef6582db35a7bd6717abf53a7070777a987b0be42e84d41b1470773fba7f80c2a0c7017716e17bec47e202fa758c9d9a86c6ecfac04a0dd1d19ebfef1245c8180c3695123c8d21fd138118e341963b90331306a4dab790e6afa8b4dbf4ac6e983c9b87d42d15754185707d1d5bf41a03a84ba20805332703b6769b2ce81c38e937df1fe473df4061a49779cf4b10029ceb54084ec82698d0eff0bf0976fdf0b305e8a56b9655490478de56219a51bb030618809facf8acf461ff679b27b75ca0afa061901cdd5ad30a2e5a3ccf1e0cdf007e522338112b181489da0a82b245563cee9b7c8fe13976616dcf4872e1bed9e26dc501f4dadde31177617d1057727db4b99a5676c8af948585fb6c0c019998b3cf226268b98afe5fb2441c570cadbe20eba7475afa84d57f5c27d124e665c57b8bb16d1d17f9100621cb10e13abcc1876b0a77c2df80e356dc9a9f42f8ea074389ba4b9a5df3c20fab3e81364a682df1210b0d36df6b6312ec9efdee9ff00712b1852367f140bc813ae496dca279aa66f5f2323e620c00bc737913b1433e6cf0eb5a1e0d3da8a564b506785dacb7e2efcf060d63d02c605b5b740a124c9ddfe51f806413a7f325c103ec4f41cfea7a939790c72c91932bf78bd70a9a22d508fa35401c0199e8e69f0ede420e72d91d5b35d887220d090a99ebea3acf2dae8e3615e26e607a508d06bd24794eff4d714d912676cbac56a44763f5c33bd5f01aa2a7ae83b6b2f3c5fef8051d88dd0e1e7494c2bcb2d741a30bdb3fcd6683625344d4eb838ea9993490a7ca564574e4cdd524f3805cf494aced3b117fd79dcde22682e3966dc60a82c3b3bc4b0c2c97267a2a03ea536d156af46bb301168df96e509adce2dd730d58a0022025656deed06a8f38231ea88d8228536d7cabb9aea0c8051f9265186c5e2d7d410bd89fb274ad39db53450fc39f91dc87181f8bb42098a9f4cc8e1bed3b740c6626ee2aabb94c1233a15008816738ec48fcf869d295c870a2b8dee559977d98d69e2e76a1484e018a36c8fd8d82246cf951c1bdd2a75e417380dfde771c4e07da9a21eb5cc8bbed263a3555b0995d45e23effee7aff6403ad49196e1170f143ba424df2a3e29bc050d41d78b254ec5d4bec3c649345e1a0993e13feed3b6e32bebf3cf1403ef761502c0ace5b5ad89e7c82ff87e421deff7f8455f4d526cbbe2e397652f983d6b86e6b83bf735429efbc29d1bf37396208a74667ba8ed812ce51d7817b975941adf2b911b3c1e9e83755093974523875a358aad2b6e3fa4b4970c2e7d6e26a3f28233d3a12",
                "594d9f83c3499fd8ec7450df310d0880fbc610e2ac8e7391faf0d837"
            }
        };

        private static object[] hashTests256 = new object[]
        {
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d256,
                    Mode = ModeValues.SHA2
                },
                "",
                "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
            },
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d256,
                    Mode = ModeValues.SHA2
                },
                "aeee8a111c0657ac8366b9",
                "be156389cc2bb54cfb0f67d0bd61e4b9fbc2c6b9311e2e3e5186a0de1f4f2585"
            },
            new object[]
            {
                new HashFunction
                {
                    DigestSize = DigestSizes.d256,
                    Mode = ModeValues.SHA2
                },
                "0928d4a8d1d6f9ea3d40f1a271cc1712bb5d53cf6cd49268e7d77348f7d143de66392cfbcb18a97ba3c53d27a3f365da4deecbe3c222bcabd7dddc986a561930f7eddd8266b488c1272f1d3381583b4927e650100dcf09c8790c0dd15d9ceacfe4cb4f064bb47d06f205f88db30282a972cd491df5e46006f6eb6cbe77aca001565ceb4e211f6f902bcf36fee0f92040552920d32468a8ae76026226618d210f752617",
                "264136193256ba5e7c17b16722ad618ada6e7e83684f7e1dc043f85674390705"
            }
        };

        private static object[] hashTests384 = new object[]
        {
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d384,
                    Mode = ModeValues.SHA2
                },
                "",
                "38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da274edebfe76f65fbd51ad2f14898b95b"
            },
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d384,
                    Mode = ModeValues.SHA2
                },
                "c65a27957a33001cedfe",
                "f89ca74516adfb393ca97c0cb62761b95e0e8de70ec573452ced7d0cecc47bf29afc32be8f1bd8a13fe8d144d0c6ed07"
            },
            new object[]
            {
                new HashFunction
                {
                    DigestSize = DigestSizes.d384,
                    Mode = ModeValues.SHA2
                },
                "34275b83f06d5f3db8755e33351961a1cbfb0de46f0f1a23b85a073538f90cbf0c64519db2f45d841ba3d1e5011456147bd3d4a9cfdde527876389dbc7cb1b07ddf883401acbae15e0e93bf1fdbf774337c48cdb28fef5974dc8354059d2c9afcf695b34cff9383830d00420d024ad7528589d42247b34be3112752b9717fffe09413f407a86e53433df943a234bdef376166fa6695b88e35cc8b06628a1a63db407992ec37b9b53109e54079d3af30648866acf9fa6db4df5724db7b678a4b5f744d0c451df44dbf095aa4fe7fbd5f4c631f7856f6514452598b6e7e6a5e3abfb7f4c",
                "529b0d03a76088a75f08d95d9959b0096aa6092803b820a264ea8c0b8e2ccc3c3cb35fe0f183bf51acd0bcb6a2720e1f"
            }
        };

        private static object[] hashTests512 = new object[] {
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d512,
                    Mode = ModeValues.SHA2
                },
                "",
                "cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e"
            },
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d512,
                    Mode = ModeValues.SHA2
                },
                "69677b0353175dc60c25caf9454d",
                "f2c5b24703b25c215b58976cd0b90b314c38eae5f3b940aa8515cd9317af9ae9f5ecac4dce408afe7850659acbe73e3049263addc35143c80d62067b6770bbbe"
            },
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d512,
                    Mode = ModeValues.SHA2
                },
                "95046894b35d7b41403d8858841a37af8c1b2b332135902dfb94f3c4313c57c3f4f0859d7d52a3af444d08c473b04fde9a1baa34a41f79770aa11c59467f05508b771197b34418777909c3c4e8f39daa131a6daa07a9c4dffe3fd286d5957dbdc060b58b3d790121463b5e5fcb2c4a9a5fe01c9d321b96ed3f36bd52c6c4e892fd751880033a873515a9849e04a47d37e6355e150cbd1a2a354e86c501556e58a97ce37eecced23c4d1cdb877ba05f0711e1db1b7fd6751d484ed5e76f9036962b3ebd8ee27f09be555c0b25196b189446ab3cb673b0d24fe10051c1f6bc69d4ed834f",
                "715c1acf3ca335d258641413cefe130a45846b78b6c167e7d9f6ed8a1208ed47b68c425940c77fbb7f10e5eaaed1647cd9413588f3f7e3a9068ba121a9c662fb"
            }
        };

        private static object[] hashTests512t224 = new object[]
        {
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d512t224,
                    Mode = ModeValues.SHA2
                },
                "",
                "6ed0dd02806fa89e25de060c19d3ac86cabb87d6a0ddd05c333b84f4"
            },
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d512t224,
                    Mode = ModeValues.SHA2
                },
                "a9071cc0e0",
                "95ecd0654e3a32385c285e9e490427362d69154bb93c59d0b2f12ce0"
            },
            new object[]
            {
                new HashFunction
                {
                    DigestSize = DigestSizes.d512t224,
                    Mode = ModeValues.SHA2
                },
                "1aa0ce7698d46c2ff175bed56a0947b1b9bc8dfdba4b6fed6320b9f0fabff6338560856683ddefc4d9cf784d0ff4f456bcd5dc443fa5a195b06b40201764179ddba2f7677dfa7a81851d97d7bd0573c79e937ae00876afea364e4026f0115ed702ae4b00eef1b570dea742fcdc026c0c453f8f597b8540f4db11e18bef9072e8e4ccaaba3e8b4798cab4a243d4b4862b9b204235029cfdbc88fb4ad67aa8fdd868443c1cd590d901328edf340ee36a2e8780bcfe04818e492655a48ffb20a4af755d28ae1bc812b4ff7b2057f057c01cf0a5253be9fd9aa39b67163ed9c11176f56197",
                "e08de1e77b20f1d62f35ef5bc6c74ee2c9b84461c4b53af7c66ddae9"
            }
        };

        private static object[] hashTests512t256 = new object[]
        {
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d512t256,
                    Mode = ModeValues.SHA2
                },
                "",
                "c672b8d1ef56ed28ab87c3622c5114069bdd3ad7b8f9737498d0c01ecef0967a"
            },
            new object[]
            {
                new HashFunction {
                    DigestSize = DigestSizes.d512t256,
                    Mode = ModeValues.SHA2
                },
                "1cb5dd77a49fdc888fc8",
                "4e483c4045558d5dadf9e25b85332e7c5273eb5d6b730225c0cd1ce2446d497c"
            },
            new object[]
            {
                new HashFunction
                {
                    DigestSize = DigestSizes.d512t256,
                    Mode = ModeValues.SHA2
                },
                "3dffcbe4114fb2e91257b8b550f41b1f97d49d744ed0846b9f7ce65ad9fc23a91219b387109422dd6ab95880ea381eab3631deacaf8eaadd9a9580d67ebdcde1ccc12fafc5f47f4999d40f48cce13049deb0f89c2b3b423c107bf5044f398a1fb521c8c1fa18d214e8cf6476bf985ae1d97972aa8a7f526f4a55cd4b1615624b135e052675a723289fd3e0708b05a35b6db5d4409304e45e904c8e1299fc5d4e2fa36f46ff4a786c0607099ff8cf139fe38ca7c50f6ffff12a88c2c3a194840e51168c895fa9dbc864946a6bce9fb296832571a1c76bac105f30f0c5f685de74c1dfe7",
                "4a0004ee298008558fff4662989f2ad424bc236570244297073c47910c057e1d"
            }
        };

        [Test]
        [TestCaseSource(nameof(hashTests224))]
        [TestCaseSource(nameof(hashTests256))]
        [TestCaseSource(nameof(hashTests384))]
        [TestCaseSource(nameof(hashTests512))]
        [TestCaseSource(nameof(hashTests512t224))]
        [TestCaseSource(nameof(hashTests512t256))]
        public void ShouldSHA2HashCorrectly(HashFunction hashFunction, string messageHex, string digestHex)
        {
            var sha2 = new Crypto.SHA2.SHA2(new SHAInternals(hashFunction));
            var message = new BitString(messageHex);
            var expectedDigest = new BitString(digestHex);

            var result = sha2.HashMessage(message);

            Assert.AreEqual(expectedDigest, result);
        }

        [Test]
        [TestCase("224", 1, "00", "d3fe57cb76cdd24e9eb23e7e15684e039c75459beaae100f89712e9d")]
        [TestCase("224", 2, "00", "f9352a492bcad2f1a44d31e697468b2491db0528caa40a7a86f52283")]
        [TestCase("224", 9, "F300", "b613c35a8268594498c8c2e963ce9467a7f4fb905e9e6c7da266af14")]
        [TestCase("224", 611, "563bb1cf219b8b8d445c0a0e096fe67617b2192e44724b87aa2d8ea0fd9c4b891cf07ca8e55d1c5c4ed5dce1b116187468e609b79a9d3c5654e543ebdcbeaa1f42c52d1237b527fe222e4e1760", "db686c2aaf6f9c0c707b0335470c6ab5da6fa8a21e7b95f1bf8e7e39")]
        [TestCase("224", 1007, "3ae0c67e4d6e0d186f76ebe0340fa9475acc2111a23f2effdebb61ab4c5ef6b3224f06196a45feea10494f1e3abc67c0d79be14f7b02f8636aef4293f3499b97ff215eaae937dc3290c006a3ab666da15d916d650ae5a461680ca927d9b5fb87f8dc38f7714c9039176378373016a33213342e1bf6ef1b410198002da7aa", "fd56f5761fd9e9e13ce10f8017f9d02a1f9bf45f77d701ec8a7e2124")]

        [TestCase("256", 1, "00", "bd4f9e98beb68c6ead3243b1b4c7fed75fa4feaab1f84795cbd8a98676a2a375")]
        [TestCase("256", 2, "40", "adf8a3bf1516307c387866f77013775d421cb379a2703d2e633eebab433b8233")]
        [TestCase("256", 9, "9500", "6db58c0be5e58a4b4fd984e5837bcdb0f094e622ed85b7c8a1ec79726d03d219")]
        [TestCase("256", 611, "af899bed1245f67bd013b30b0ed24b012db0449ffb9003832ab0e2710188825351f5637eab96b137d076617669ec7deaf8c0bc3c0f8f5698c071166a54d8b1653fbc56ca54f586e736e826de00", "766ae82a86cd52451adb8b84baa205d6dfbb5bc067a19eb1e71be1963fc64a5a")]
        [TestCase("256", 1007, "830b9ddaf8109fdf06cef473cd2eee7442a64094e015585b9beeef701699de14151633ef35e4840fdb21832e6af2d333b9251afcc415585ba1ce775eb67223d42adcdb0c998248e00ca0cef228936236a5829bb102440b80777ecf1b2c0c65dba8a3beba8cb4945b8193fe4a6fd84284f006ea3a046a1ad20646202fde2e", "ee83d8c124590a97880e66a1c2d92073f1ef377b09c41f1814421ee772685cea")]

        [TestCase("384", 1, "80", "9eef0094544d88a6e9ccdf9e31d039c5ca96682293ab1cc3afc6016486190f3d20c89d5a13ebc9d13ff011b411af9186")]
        [TestCase("384", 2, "00", "c6b08368812f4f02aaf84c1b8fcd549f53099816b212fe68cb32f6d73563fae8cec52b96051ade12ba8f3c6a6e98a616")]
        [TestCase("384", 9, "a400", "277ec060a3ff558addd832d749e020666a68e6045dec015a2cfd7f507e871910969d650061ddf080a9d991c94370b524")]
        [TestCase("384", 1123, "f90c330859e9dc8b942b8589f63511269e01a3c9e9c3b3da2ec962caaca60a54c08f1a035c0521f5b4b528de3a9c454fcd6e6d392d398aadb345cde53f4046887197b22a1c279412f715874196fad2b099443dd824d923778ffdc9925e75eeb673eca38482975d6dc61549b9f299dfce6b4abaafb4eaa7c329b6fcd8f18e2b672e569619769ca58b877b164e20", "700f6f98aa5aaf90d5dc934dcbadd7f71b399fef366c5adfe6e442d0d71e4de25bc66bc63f147e10b0ef1026e6c60d62")]
        [TestCase("384", 2014, "244a7972a79d2c9f96aea08f203da4a7a876ccff76cec166ac2edca67b53f3099675731be726afb2827e782cd775eef82b90955849c0ac647487ba53a15c69f6e351978527f3ab9e2171258b86017ac47c801eb44f58e2c065a78086749e7462f2270e37cdcac66c5dd1cf3497aaef13838e8d9ef0600c8266d857c75ce0bd56ab3e00b94374a8231ce49db07038f5ed28010b9b949ed1b05e60679fc1ececd9f6e09494efb9facb48f4b8867b73365b5323bf35a3dcda543788d7950b88a8f4bb53f24f3b60646dc847483e1e235764ec3ad2f385e0ce75d898d032a27d99aee2e043728e338d0f84257461c30f0311db8f6b5da272561c29d879fc", "1e16f1b69251ff30733a63c2d9f38e1a9c8045d47a12596915ea06b75314a4846ebcf3fb858158e6153ed5950c2e356e")]

        [TestCase("512", 1, "00", "b4594eb12959fc2e6979b6783554299cc0369f44083a8b0955baefd8830cda22894b0b46c0ed49490e391ad99af856cc1bd96f238c7f2a17cf37aeb7e793395a")]
        [TestCase("512", 2, "00", "c28f076e71233070d7586154c144577eaa578c3b2d9827010690594ca8677f7ed56ad3b30450c2abebba721abfa5df0030f4b493f03c51fb89760a7fc75a174b")]
        [TestCase("512", 9, "db80", "03dcbb4b6ee5723acb2e61500a776138ea192ae9fb5a79c9eac1d727702ef51b88f50cc372ad13e7a50391bad9ca38a987ad22eb00b7da86d81abddf50ace80d")]
        [TestCase("512", 1123, "de091056a9ad543931c4430b1836b98c2e641dd342b1dbed394114c75d01944df7e704d41f7b60b5d396ac3b4769e3c07cc23112148b611c659399c2cc92450c4367518736a39be8934ba8f321da969b1286516bdbc40a24430ee5a8bae4f216ed115f37972fec199a6d9ef94e90b8661938e7a44065bd4ffc396040d10084b51b6d96abea263a8f0f84f81660", "e85f94b10407d364a989fcf290c60967e94be383369d8b492962605c5e8dbc7bb303049c4899fb8228083bdb14581ee281b0b6ac8cfe1ed7766007c5620c7e99")]
        [TestCase("512", 2014, "c41a4d431e05daef61acd570cddf1c39d7c97feb7423242393a82996ebc98c61f8a1489a402bc12bdbb362e0328a85be07fe9397b6896cdbba4909b172b06046257d876545eb1d49f028e6afbc08b52fb4fb8fcb9e3d0dc9804c02be629f5eec549552cdb3acb5f0a9f3a704f3c27433e7a8bbb1b5a5cf94ed995de641fd4ff88dd1f1fa14d552c90cfcee085e1e8972a7ed5e6e822a79e4091962509932fb15d619ab13efd0bc7b242c02e28585be95fcb2c12d8d34d563ddb25825f1a62ae93955ca41cd04bbaff6692dbbf060d944eedf2d145f2ca9b7704d898cd2c1a41cbd6d94ab35d9170d8c9cb5bb2815a326865ce84b7f78be88cad33bac", "9d05bfc1549b1156abc2b95d52d519d7f19c794d193d271fc1ac1305af20b1a73cb9a7ad9dced16517e19a2e23f06863f1b9350227e0accf7107e9d0b00e0a78")]

        [TestCase("512t224", 1, "00", "5cb2c91954ab4fc72c555fd379268bf272782516ec5da0660c421dd1")]
        [TestCase("512t224", 2, "40", "e507c39a514a4bb104c4999f1f1f1b9022b7ce0e17fbf1cb65834605")]
        [TestCase("512t224", 9, "E200", "f8e683bf8b0f0327202030f404c1f53774b0266f8b935cc64822c8a3")]
        [TestCase("512t224", 1123, "f4648b26d43ae9a6c169ba5781f012ccec95aba9a1cf34adf9e2ebef394c6e670c60ceb13031e60e6fb1ebacd11a4427108d9b4f4cf9342c003f7d3f3594e70bf526f5d4030292a7c935a89a9231ee55f97302d1a163b760277cb0ee55ac2e8699fe2618b5769779b73c1aab2cfebb5f918f07b80ad4665257e0ab83035eeae0de2f8903ae559a8c2210686600", "b0c8e44c052a5ff2f0f7195fa8d20ebfc81b6ea1e0bd9bbf2879500d")]
        [TestCase("512t224", 2014, "6de16c47b13840802e883c0b4c29a52b178a7ee94025aaac64b25209919b86dc07b127983b1d04db22994346abe0038b8e623fc7443df51356698855db32645d3cece02d3be26897348fdb0ea21132b6e4da63bd42a984ee2bb83483c037373b97fa60adb86fb4dcecd2cc0b38a47bd3a459b17240519f6669091c3b499348a19d436fc1bbac30d1d3cadee67581260a5346f28f491d8ea39ac309247d2cdfb5d830d4114b81239f70e0d84761907b857b0beebb62f598cc454ec4e664eb439fcf27594470d6d76d4b7a84d505bac169a30f6d9f95c10709f312122a06b8be880a91c40232939264ed02a83968e542e154ba37e3e96921842b77be98", "f0aa77a4847c2cbe7ffbce5f947457984816a2f6d40d4032785920db")]

        [TestCase("512t256", 1, "00", "d2a8cc81374ea74aa3d9e4cd62a5c5bc7a0dc516399855300cb90b0c2960dd1e")]
        [TestCase("512t256", 2, "00", "0d98f1627ee8713255aedb71e0bfeb065a16b5b242ddd57f0e4147f30b40ba66")]
        [TestCase("512t256", 9, "A800", "816a2b11eb9d40f418f3bd563e702e00287dd6aa0b92b696ed3c2edb156c36da")]
        [TestCase("512t256", 1123, "90fdb8f79b7ca049bffd905e109a4bbe86b9aaa7f334355538b7f481b96983280ece658dfcec9a81a3ac74e2f884a66276539e89118c15fe6c97e4024b74193d4ba24abdd13f293c407059a16f0380ca5a539e89176c9dec0c7029c2603ac15aaf400e8e02be7400fe11e8a45b60017f988251aeed1cf5a9820a6bc9de01a408a2725a0977b1a4584556c8f2a0", "b6861fd68c4e0e0d2b8c68b9be84d94e06f47839e82c64c05d212bf8746790fe")]
        [TestCase("512t256", 2014, "f1c85d82d73dcc0cf6ecddbb7ed3e79e14974d9bd276a2078f7d107461fbfaca6135e09aae5b83aeb5bb4ae5af35e53e6aef30324d4a5a47971446e2e7ff315c01519659cfde4e55a633fc80cb15a8cc362aaa4495f5ca9f9408a5155c7453715985466841ac752952bdba35db5a7971fdaf8379b3613a3810c0f5b6c844a630f237ba6e0caf405140bf4eace5eea05449e8837bae74f13992a6fe6c345673c253d1b81439cdf7f6f8a37e8cf4b8659fa13c71ef8e1839cba32187e0a792014f04b90902cff0e13f03cf137d0da010778e1317805c345816ca995ab929e09afe8e5975dfd6ff4755e8add5293a8ee80697d63bd41faf97418f763da0", "a5e0679f13242f45a9f5f1dd6711613b7dc4f9ae28fd679ac05a963d7a6af17b")]
        public void ShouldSHA2HashCorrectlyWithBits(string digestSize, int len, string messageHex, string digestHex)
        {
            var sha2 = new Crypto.SHA2.SHA2(new SHAInternals(GetHashFunction(digestSize)));
            var message = new BitString(messageHex, len);
            var expectedDigest = new BitString(digestHex);

            var result = sha2.HashMessage(message);

            Assume.That(message.BitLength == len);
            Assert.AreEqual(expectedDigest.ToHex(), result.ToHex());
        }


        private HashFunction GetHashFunction(string digestSize)
        {
            switch (digestSize)
            {
                case "224":
                    return new HashFunction { Mode = ModeValues.SHA2, DigestSize = DigestSizes.d224 };
                case "256":
                    return new HashFunction { Mode = ModeValues.SHA2, DigestSize = DigestSizes.d256 };
                case "384":
                    return new HashFunction { Mode = ModeValues.SHA2, DigestSize = DigestSizes.d384 };
                case "512":
                    return new HashFunction { Mode = ModeValues.SHA2, DigestSize = DigestSizes.d512 };
                case "512t224":
                    return new HashFunction { Mode = ModeValues.SHA2, DigestSize = DigestSizes.d512t224 };
                case "512t256":
                    return new HashFunction { Mode = ModeValues.SHA2, DigestSize = DigestSizes.d512t256 };
            }

            return new HashFunction { Mode = ModeValues.SHA1, DigestSize = DigestSizes.d160 };
        }
    }
}
