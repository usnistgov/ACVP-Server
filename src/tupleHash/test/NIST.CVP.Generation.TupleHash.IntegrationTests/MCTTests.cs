using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using NIST.CVP.Crypto.Common.Hash.TupleHash;
using NIST.CVP.Crypto.TupleHash;
using NIST.CVP.Math;
using NIST.CVP.Math.Domain;
using NIST.CVP.Tests.Core.TestCategoryAttributes;
using NUnit.Framework;

namespace NIST.CVP.Generation.TupleHash.IntegrationTests
{
    [TestFixture, LongRunningIntegrationTest]
    public class MCTTests
    {
        [Test]
        [TestCase(128, "6dc13301be877363018fbbbddd779b7d", "6e33bb56031a5c652c54ff4a9b66857d11defb83912e543053f8ac86c10dfab5f892f863f054d8aa2a1f16a9a4ed51e78931d34b6db7cf84db9c9894f4c2cde4f8af7a18342a79195a9f43b182ade6d5e2f587a51ef9534c68c6a46de49f83b9cf0cba3b4208b7468420bff2c336545ab91b00428588d2055a0a540c582a40ad59543eea50117044e3153eee13547215b07cd5496bf9d0c2aa33e915e75dc17f57f8dff348741bc6d4858af78e9ef377b5e907e15d12316bd7c5bf590faa47473dae044ff796836c248e40dbec3a4f454613bb5053e4c4b6d0ace76828ba06bd020c6ae7b0366ac1eff62ffbe783f2d5636c81e16f2f0ae7253dbe578f2e85dc9247266994a48016b8ba41dd76c994649cd1dbd7de228b94eb4ba23b6e9408834ea6a01e6b831c8936ade272e995931484969dad26ecaeb0888195b45b122ad00fdcda7b2e0e93ad71068d80e759dcead6db9e0a8638f0bfc5ccdd4de30aaa06bf4df0647541a42253f8589b754a713a189d71fb431ed51475d372d8d54a0af2f3bab7fd82ebc94e337e425238c0ce83b041330e1daf55b8eed05482261fd84b864a302739a0c2ebcb8e0ccf3d58dcb039aca735e59c1361aa406ed9bbc7036d1add488368f2e39ced840ee2dd5e1e6addf41a0c1855c17653ce39a6f1900c9381bfeec66dd8d1cddbdc47030a3906b66654071363541e4b2d6f7c3c4762dad4e9141e240ef2cce2408abe45cb8023bcfa32934ed68518c8282a26e12dcd5040bb7caf320277fad28585c81a15bc8fd0fe01d2ff0d8fc4e58057fa0c8fc1e50e82283548b177ed98a70b8d31d8853d9243c17e87532a34e2639f820549a45ea34b41e20e896d29f6d9d2cd6172a7bd9f2c01879b37ede691edfa0e9db7ae39439a82c8e62c8df41b923f33ba5d4c2bf0be5878e5f26d0a3aa50cc789c81c934272ec17d0cab9dddd46cf13b1590a3bca200cedf16d920b163cf8f5adae3e71c187f8ab59bb6fafb965147ea16878bc08080595eb52e9d9b00fc0c677edd652930edd49b46769765ce10142dab7bac03723c7a7993c7bfa95995df7388997457e6812e41d7eb1fb7dcf0fd8f8a68ab15ec374333cbc44e867faed017c1462044590b0128c1e9c3b8eb36d32be55f54c72e1e131b0444fa852bd4949a703de1d9b8ab4e73f3397173a1c75d001b508b1d7f9ad15fe045bb5ea19eae8244db7f0d94369c074960b3ead070157b8349cbae4b2709ee76f602fa33ea1cf12445ef284b81ce2d24190f1d3757cb890b92333158455a550a345cb85b1db5a2c56ce0e04c9a445e03aeb3a7396cbda9615f09cbd99d0419f9e3cc44a73701a5689540e0617916254e5dc892903fedaafcb2b8dd67dbd5efb0f27c6499461232d13e820f52452db6f3e4e6755e9315b0a8ccc7bb62b0dc2863bd0245967cf8148ae112259d43a6713b5b22a448357421b0697f7f163b3a09fe4d77cc0d7271c4b60a2b93af40ee47f1da27a43854f5bad9733e734e193eb373fb3d1f835e0d83c7c6decaff7a70833b574785cded49ecce102d4d6290a02cef3b9138f314b3d1fdc12ecb623988e2e595ce50f2c0259c2d84bf9d65ff70736798b9f9275f6069f6a507328f445c54c4522ac59cc4ba86cf3c1fa6ac50be6e7691974398323a76d17188593caebddd19d3f98e6a1abaa5c4eccb5420f142c79d2508ec7f88b035d3682a69e56e3bead20c0eb86138ee60aac3f774729d0c7a768c0dcaf8f2d0d88af998385967ef8e734ad0e928775a348a726449a95ead7d183af2c5b5add3a0349aaa9341e417ce493761edcee13faab05974fa880a3f33f700b462f82a68d720e5dffb406f410297e2a710fe8d41008a7e7951ee287514bef7965f469afb2fa9e1b8cb9e535de697c6c309e367e19ec8b54154e48194db07adf19e24e75e17e13da811617fdd9e1480e5e9cca5a2ab224bb22078190746b6dd53943cfcd16472711d458593e9417cbc8b659601005850edb6a452e8fb6e6ab6d75748facdec8aab4ec074d87e7699d7f6fa290f313a962c3e6c2c43e34787775a9415286a259dbc8f1a42de1605b9eed8a8d7d904c28d7a09344d0c518fd7b77bfc4574ea46d9cf6ccc466370bc1ca24ca0110ff003b047f94f8e72f839d7bfab6849756178589b62d8bf4119e8aa5de1ea4af82213e967a9d07cd8760b0ea74c5247a1bb5e38f843a02b004f63770dff638eff09747dde895a21d4c3d8aa22723a8ea99d5095b68e3bc0b5a763dc8065ba41e695452d7fb48a9e75cf00289bdf0c35bfd6750ba499ae15e77470073c887bdd9f02b5f50a2774818e31cc087887222eea0c079aa3990e7b9a017a08cd80bf4063041d31c270a241f39270ecb6ba441979c5d638494338b0a79d53fcfa8c71b758427ea4c1b8b825f6054c11e6b554719d1146136fe6139d0126cbc7dc1d75a1d1bd2c1e2c2d37f3bda6633c3a5c0ed1bd02335e1b986ae94d51f4ab1b3ee4f3bf136a6f4e531067393979f6ded926d69f979e4de731f23ee06bdecd4e4ab3ee8c18a3c467a00209dd7c4076a55fcbc9302077e17512e3db950f7c086b5fe714fa7d19afc25411a2c0e3c44d32472ee4fccc592c04a4f5d7231e49237719eff592c226181b5ecdee36bba55e503bb5139d382203845972f509e457585fa0aa3ac966a0c6a0842c6c6b6a76b541ee8d13816da02995883e1086a7b62574cc5c50c248eacc54ecce5ec2641031eebf63c224a8a0179562a17f8bbbf3ae6e62838092937ea4837976ead21a87f0f0d006b87ef3ff8c0daa5f81677178d79cb36fcedb4ab7834f048fe7dc8c09ea14b133a1995d4d37acc29d21c0b44aac0ac2f818f40fc2987424156f058bd6b66e594b4ca49f5c5298c9438f88c0a9c8acfbd52579337fb9551bb784d6783435cea50beadf0304dd44e1b9b8d3f744dac5b625bd5672f0c7a25317d3306e797e893e15443e35adf4e4017aacf5cfc1feb4d08adde30edd41e11004d5cdb291351a63ea5f13e1fb20f10cf444d29d28711edba66b67256354fc07796219ace3947c8d978a9b9e53578ee12f2034063834a6951f14f246a09ea9ba9436ae24409336029404d434cb8532e82d21b8f3aaf1a4425bdfd15bd721dbdfd0101dbc4aeea7964c371d41f653a767eb1d76145ecb3c8f3f062a953d414c2fbc7ccf31ed8158b14b6dc35efa8d534a4b436abca159e0aedaeff85d4b15312c93e4502da255c7ec1b58819683643ecf75bc1416bd7096b0f69a935394b2d1b1cc6c3220e3f31314bc1a562c8d60ed4d8aa61f75497e68f7bc587b0cac8aafea936ea76cfb3623f6480e63cf098d438052a38b8267f7ebd9fae7fd61b4fe47f6eeafb9c989483952ff0dd9b495239227262d02eefa8bb66b0f94c2e294731cb1be2cd59c791e3128fd2f241d98e090b65e3ba41818c8766a907f125ddf1bcf241a06c41a958e24d91067d807d76fa82a70d5c56e2495fce510f225d02c4de2c37611dad2f2f054026cfdd7ef784534f8eed931a10eb99fc074738346b43c2e519797736225184ec919bb8e212f361ea2934078e776452763993d20ee953188417910ceef554cb453c79e894b723edd6e11a06ed2e88829c227830e730964f0a25446a0439e552b4a2fc329fde842acbb0c4cda5f33fe148e5d757714320866a3d77cc09805c40a75b4746f595d2cb923a81eecf3e7f79b62ec78a1f765d51dbf8046da7c5e77bd02c7412f83f21f36a41f75a622712d994877addc1b22592c8c651f9d56d3644d068d4769671b2f4cfccf3c5ead983472a8c312db358f5d44f7da4e6f7497ebec2979fa45fb7770568b70fbc43eeebea8955c02b9c5d7502fab028f72e0b8205ad5da0392d53d0b55fdf9f484ae55d16cb825e70bf8963df6cc68bcece3dd89a48d6200e69a182df4bf681cd95e79be4fc585b34f3eaafd4f3e0a0ff552380f1060ff2a2df561e3b2d2433bbf7e00970a3df0347014990f2f4ae437a3c29dd713b5977e92c2da2d55eeea235dc3eaae0f34cd997fe518ba69412ef8631672c3f9c79e05c5a3feb75d9a0db787f570f54bc3a2f3a7de3c8a5198d3fbdf441e019a5c80aba2551e8f867dcae27535f73c308562c6415004e85c0920ee9f0ab2c7121f9723fbe868a94d40eadea5f7fd6b4bf7c68c2f6ece4fb443b5fe2a5611deae5b94ff9f1a6e9d608cd80c255d6d16a73276541c12901c0b973813ef22abf77a88e26b24ccd076adfa96696269b4c433b21c5fb9cf1f827a5098a325138e09612baa57c9c0fc8f61a91a27e9e259b03956f3012b8ce7f117f726f666bac60fe082f89c35db47ccaf3b85a5d255de0bd9f0d91a31e98062a97ae2e6a08e515d672d6ed43856e667710acda67fd1128597c64bbc829b3bc6986fd280b99a2215d3d769748924630233bc9f26bba790893bce74791a5dbf84fd3740f745a5362de9d60d577349a78922d468c9ae41035fb748ba6814672ede784b68505f94bcd19f9adf843ac7367dfb550768331224d26ca87ad636e5d8fcc42df27a7d1ef93964cb290d090528501b1a0481c00971991dbf66376c37f2a9cdc5ad886b1f02bb4e8df7ca41581ef4e589d21fa03cf40d44ee22194a0fdf200e7c651d75d1023b4d96b02cd1c6264ba3ef7f44f269ffa58aebd24eceab16f194e92c153fc93bedb60c3a4fb1cb1eac905da3029ceaaf777d255f91e175ebf66b09c49f9dbc959f6c2215ad93f5877e9a98070bf6a862a02729d2fc73700c152cff0693ca87e265edba27eea7a02750eeb5c696d764a52276bc42a317fa7d4308a0ba541281565b38a0ec0d891d82f99b7f50d449fcf28332ad04f985ec438e77bd35f5c6aa28234855e6e178dfdaecabaaa6b752156f168c5f739d41276db245d05336246e1565a6c1add940a2960532f6bad69cb61256654160c1c30a75fc1700aa1b0c847e5764c8428c9557055671acd55bc970ba282b76af4e11bc80ac2a7f256c1c49afab972f215e1fdbdf39965540f816d5076faf72db6d905d4ef24ac821fc1e4ad745437cc42fd0e1312f9f890fbc7a7e7c3c0432446d864e4ad21614c4655059818295f2a58bba775df17576c4281177c5f944cbc0744f584adfa505782a4bf8c1a9a0ab078bac694b1b584d5864ece9435d952fa2fdad28fc0d56380d3e8f7e8dcefbc490064d328289079a2e75a2eab50a7ffd8907d1f9d0cc43f2328d9221c5d8db5b4fd4efe200e63766e50fa71d6a1046209c1ba8efd2a5684095657294ffb5404f7072042ac759e97c399f87abaa03f8a42321798218bfc546862daa8d7d67a14ab7d441e64d3367c5db57dc92cbf6f637b275547aad5bc05e24419397da07d605f51623dcccb868445f0201647838d9fb2a2507a641fefe8c8a579b251eb289d05d38974e3ea9aad348cce274bd2fc70a77d995743fe60b072c20f205b629b1ed98c821ae3a3e82a74de9f16411d506c4525a088140393eca8c901769290660a42bbfe9e96cef5a89917550a5dd5e410c8f44e474a31c18a800e031dd6af10fdd1930cd5ef7eb1dcec27057d4dca4599d3ee83913c68d0e356df7ac99468c5f02aacc6ff90c42d8781515552efd28638fbd57a99c7cdb27c00a536582beb272c87bf9e00979c1261261b0719574cbc6525d50b14b72a6f33467913b8bc79419b510c553d82e63237a48aebec91720d8431b9405a890651136bc88e563f8bd2d70daac86472226034cc49fea3d02fc1febfdcda750f880c9acc51ac12160e7150d2ca7d954a0ef2aae4f6595ea944fd83f95750afa37d5f9ac49acc7b6c2b979b682e133cf358600576c3e9d3cadbde79c84487e0e51b53303c65ae15a848e84cb5a5a25260a2c01e7550f7e3da5a04f7f89c255dfaa682b29c74a1d0d813c189301d37b8dbbb9c21bc3fe31fc7df9c04811065f23323a35fb6aa03049214db5bff9517512b156e5e23dc51a9eaf25b9a15b83732f73be6203177078e54e20ec49ced731b4f398292fb2704b812cd479f4532f1a913762dcee68e70613935dd30e2489d91cc4ae56b85f1d1efb12494f5a4a7bc607288e4e89d4a3790e7c017085e17f6cd59b2f0bfc3a9a8ee0f9435c55721c5a4df084da3cd0c33cbb61a656d4e079d6534a8e5016d095d32bac1e0feb93e252a0e737f992daea19e071d8ca8b5de918610092b4a5e0a375df9317e26d3fde9691066627597684d1916907ed72a7bb0492ad794521c7d093ac9a3809db0ce10964c22b39e16f1d8ddf1a5173c850ec36b730271402c16131e014f9972eef844b8e9347e8977a834bd096715fbd15b98654fefd519b6d9160a28938d35450b0677776575d67a73466a6a6fc21d5612e4613c5d0fd2c64ff3dc9e264faad93808e684c6a0f878b185360ddfc1e93a2751fa0a47276be54bed52afbf3969e912a533300c1b3977b78da7f6c2ccec556cfdc3f59de5fc5ec63d2e680f65f793d044f72a65aef1a4899244ad658b28095f01a569da38fa4a688e670b388437df742898710313aa6317c01db9bf7c5cd0e14a35dd6ccf7b506b6455b5aeb408f800b3af96f611ac1b87ffff53eda7322ad01981c721bf88815f1594a6385c3b362eb31503627e82a52b8dd8b0eb3f74873ed28ec0a4cb74b846c4e159796eae5a6312738a27e2f2e5bafabefaa8aac0efffdd55bc20e48e29844515f93fd557c39f90c1536e8e6a61bf0b7ee58a68985699f63765a40617287c5afd9abe46f90e6d266795a74f7f09b646e9bd1abe04c56ea2ad5f0ca8ece58620e966be97295e453e77abeb2b298f6195dfb07f3f0461b363f161f8427cb31f1f3c502c550861263c606665a7adf1433d0448821d75249b21f7dea8a6997a88888eb498f99620a0c84e12b14e90727096a2a98472f1a7974840bebc2d11226acf3ad4a8161a9f825b6c3d20007ca4aa3a21355036c5cb35e195b6900d4f5fae7aa75ea978a5230ebd1fe49547ab901406afcc8459ac12a95fa8668a29826cb60d29e95368cda0a899c0e7cfb5d608d773e5ed8158409de7085a66a5a9f3aadf99917298415a29c5cc43fdb46a6d164e3f3de0bd1d875aaab4d06e8501ae7570f5a82c3cebb21dbc44fe29668aac9b210178f97d91309ff50547c801479cf478ab48b9460832c0548697207106eb52629da58438b4044ecc1d8b36c4143352be36e798618f1f353c65c6fb1f41f561f037722455eb7dee22a88c08e60ff94666437078e8e5843b1c6bd5313289e4fb45e8f3eb8f496129626ebe29fc0d29bb7e153d793fe68ff83808b571df4718d348ef4ceb5dcebd4b79aa1870409796835c088b70b32ff43e85e45fdbc49a684c110bcbfe317339b9c2d1d8ca2ed61d084c83095638261679aec4d3f0c2223620297e5ab3e77d41b1c1521dbac0c2a6481b59a7bd347f083ce63d7abb6b19c0961b27e23bdba1f83890012fe9121a9a6901c0345b69c5d22965004e2910900bba16c3581b5a1716a52a56726ccb2d07e2189ef41e6460a24a09df2890434c18444039e977f91528f34905855ad0650c8b81b17d265deec23d4bce615a8396b3bafbb32c72d79a265bda4883690e88990b8d477252aa51201860bb8d57461ca938f32fca517ddbae409e591cc2cadbb31ee6ac414d160a49d8808f5ed9421f64dc074bf6bf98dea56a071cbad2bfddffc1995ab3b01039f9227fc81d89c7cf5e69b7af4a946721546a30aa87cf00d8fb6f731e78aa582c9c6b4361dd095acb7fc24f47f294f1a005b7cfcb373f5cfbd3bbeb33327c223d6f0a82c51bcc611fa547a27e37149a225ecab1b990e1015357c562b37e5b578e7d82dde6b22e6940c433fcd4d92a6d4cedeffdbb4de8118b3d00b02116b21cf7b016bd68b7776bcf3bfe0552279aa3a3d961918cbd830591daed6a01c147e4108c963017067b1952865b0cbfad024111c7859eacc462c0e43664c15a112cdceea987ff35198fa75be788217496415786d22c20de1c417eb3a72820e34a53415c358dfbe4bb45c61b15dae7b82662b8df213e5957fa1bde03e56fd97a82fa3df57dedfb04af3b47610dd1e368890051dd7ffab42419668917030faf6bee64d8d15e487eea0fbc2fad0cb15943c3cfb86a37df2ef8827bd1f278568f181142b56df78b148990e85ab727df42b1084c3c435c18f6dd658f765e9348a597e78e00f00c5e464fbe66552488aac48a58562e9bec0a2e518af02dee76e4757b0cfdb265b7d520b3dc2ec2ee6a0cfdc6286da9850db928430d5135d8aeba6f7bb088d09d5158bc263547db68763c2bc4562d0acdb451b69eed1e15b0e334cc26eb3cab715e2a016a7705926dfc301638780ec29702fde756a0975e64779c84a726e42d5f2d00ea314f1fc86a3f608ad5dc52c0c3dd0a6d9ad4f5ee86d12365ac5395adb235293c02856a06f7bcf835f6975456aac9cfc614c4f06ea95262839666c864bdadc275e5db17d61eaa083af1655760b2ea14736e0a12ee041cffcf1fc2d6f660849e7921e3a5f89331594a10ef5717a295cd4322cf63559640d584664463030acfedc972681c1b0c5e8a43420a74369d69f1332045b8a4fb682c6b0ab5a6c9d8fd1047cb88e6328655ddb61df3862c3fc33203f51690554adc3e4bb945e28c729467fdcc3bcb2a0926bee630a3875058e75d023d943bbd042982a5b683b0ad03e2564b6d4d2efd94648a38801b764e4a70f747783b6b54593c9537ea6889fcc4ff0109b43f1a8093517833c35b6a3954b70004ab8e0a61f3387eade6c220c82cf68beca26dad21490fefe687b85398b7b94a9abfc147bdb4a564abbea2f6c20148cd033126e1e8086b744b86846528baa9ab2ef03dc4e6cd4f9d70b64b6724c68209ad7ea5")]
        [TestCase(256, "acb91ac0a42bb1653fdd3b43ce7e8aa259f36a62a77b533aa54ade01d72dffc2", "01d61dbb369a0a8e8d062aad96467be54a7883bcc5070b666744630a0d3d7416701de7d79e0b77523cc4ce4d2d8415ff1a54e974f8ee2fa5317a9ad950d0f3c8c9f5330cb6150bfc0e3a25770977366d9c3fe451af3eb60ccfcf44cbcf2dd0fdb400167ebced7de0b66a7a29fc5a5c501ed7a80129f84bc94cec84cea74d121a65bb94383ccf3ac4cfd4a9da83a6cd9bb13a562f2e695e8e2a543a49704310396a7d0f431bdb5c87874fe88f71a1c59b591fd305ef19c57560465d404725c84cfd6e53f9eeef1e864a68ecf532ccccda879ebf047a191407d652280525d1f692af58af79e3a9fe1e6e6e783561a7dcf9cf4e8b9870b9a81d6c355e41c16069d7edc085ae928b3d1dfbc2fa153b2e3cdd82d6a46fb070daf8e54ec7467ea36f8b2b840327b4e402637789fd71929f617746b4b30bcc437bb298700459e36322f3a507460bf205fdfc035ecee4ca9d0df9f7c36da21cf1d00c0d9b35e8ddd1ac4800d2c8e3b7e77bb622b01fb9e9ab6055faf1d5360a0cc368027b423c4aaadca833d6e27001a908813e2566d689efe70b7ebe676edcb122587c25e1a39c89441b67f9567788d2efbaf30816a6ee64caf4141eff98bbf6dc2a168220189cb0fd353483cb85b9333d611f541b4c3a5cac014a70b548e3cd04b2061d213b234138d5c3f550c46dff5ea0b63cb84f90012c835840572b768750997e8f6911e1e3dbce2a87a3d8ec878872088fe2ef337412764c6b0d4b7c4f4a2252db0c6d72abac599e24563a02225dea5e240308362c8849fb1c0a6102f669943c100891efe645a36ab4ac1b94765c1e47e60bdf728cb0671a489c666e76152ae4ed91e5da8b137eba8cafde4f11d65e5bc7d441a09cb9cd2ba2abd3f46a7670ca4d2d3761197a560e27822efa12e7a6736c504d2d07fb1428ae6f75f212e623b7d0bb2b5c7fd56ba120004f3df2ef6181faa3c5e17636bec561062301abb4e769f537a9f3b02295b33aebebf22b68050def992e7c51803d085f6911dbfd62cba1f22b04eee111a21bb0cbf3f47032b34a63af16de0074176cb0b86c3948db894e5233d47c98f4f086f094d4fea5664d02c35e96734d659e0f730a01253721ba7bc68e4f554571c46c8d43414219af9c843dad1bff65e7fb9c46e733cb9fa6552fd97d52ea878aba1b2816303f550858a9e072081533cfd29aa61d97e42c2c732b3279be46b09af78ea410c69f7de057b1225da5f477e5fc096f0b8eade0ca3c8bd5ee233d8a41387e06531f23c04f9129a551ad376aeb87183c24a6e70e1b123c8eb13607b0dd4646ffef627c800a13b02c238d296b1cfd08782a53ecfa658950055e7c4c81f32abb3d84691925ef176f5e6ac72bccbba2f58b014a9f1e7fd2718ebcb48c4964b075ff0c45b18e690b34b43e2358a26b494a9b3f5ff4637f1b00dfb229d6799af71866a70615e4925439ba4c019033377c85d7a193d7a19ba128842bd8e642a52c5b73973753755546d0628052240c615e7ec81372a116bce2e0e9f1d01df0af7d56a25490b32218096477d8f9971310cf7548e1202c25e9f29357c5eb9092a0d71922ea95b494f719df5ba32cd64ffbff7230f79205c0e026a8fb73bd26661dc217a106ffe11ad324bfda2922009594784183fef24c9c6b96e489b9ffda1341cdb97fba27765b22fc2f2c9be86eeeadebb66749e205cd0aa4dc9e918341b446cdf3b794f18ab647a7675a9d3baa12488a250e4e7426f38d7177d15b9e9fe7f964748a1d1bfe7552ba3cd36fa6eb7f414c85879e0788ea8507c5ce91b21575fd357445b45d0d838abc67d44ae2b17f668e7f6d9eecb654bc8277223f26f14981a34100c106812538c3c1ef51dcec098a503605cae6eacde3a93376cf7f329486efb7838efb37ebf38920fdf04fd9fbae4a425f95e9321105d92e1362088f906b65b4bc260fbc745d05cfa441899b0f7d338db02e2dcf64a86c4e2d072eddd61d5995e22da58acd313e569959cc0b7b9a5ca79963ecdf22af4e55bda0ebc5bf829fae7b7220bc6bbda19fee3390721cecd19063df38a9ac39553c432e02356981d568afe005012db40832b606f47cdee00cb102a7aefd746aa8f641f9f79aa588337464cdfb4dbd0c8dab7c35528da07a8ac5aead9a0e1d2441e1ea6f96904b69b9e31aa260905e8a3a963b83d3c0b6af358bf0b524dd724d48b8502b07216e005f83ffbbea409beda96263a7b6dec5de2525301fc12b7af04d43bd17ff74262cc18132cefffbfec3a2abf3bbc4d906cc1bf1578ec77718c32a45dfb0614f25e6342a53d0bcd0b148b970a5ec901457b2a28b46226ddc8e53e819e110809774d28d4af06a07165a36a60b36914bf0cbf3ec910e46e7c5bafa895d01f125443d70e2fca970fdf6bf7049f82cd2d3979ab0155788be23cda34f7c3abf17f7dcbbe23ad1fbf08a46ca250840fedb847d1978a01eae583578646bf68ba66f7546e7c1b10f99ff94071984e6e1caaaa2f072e909cecccf78976f8daff7c02c9898358792f2563b10d7305ef15d9f7ef958eab75cb0f3742e8d49e79aab0c570dc7412b7aea83efc84b33eda90ce4a15f6a84a7bc09443a940e261b5f8b4f6aa572ba41da188443abfb0464fcbb4fbe120a9c91b37cd62ff5fcad31382fbaad929e23e5d9e62d2080b9a8e1c7104e89950bfce40f434e3f6dcc895b58ebf254520b0d9ecd82929304044c5dcbaea5148abbaf45e9aadcc7daf931db22c3c78cd6747effa9b9808a34ac398cbebfdc1f00ec03d980ef34eb8b25c662ca1974e7b43a70f3d0b6a7ac0224400244da076b3f3099ccd827205c2cbda221642ce1b0c31409cb11818d853cc426661cbb6cfeecc0376956f72adec03704b42655e661056f762ca7b41a254ffbcb97669a6a79fedef0b94a2dec3e25d853e368176bcaf70b62cadfcb18de25db6593ce99c737a1929e2e5da78c3678f56df32cfead4397f1400045f2ef4c3589c9d78ee16511f18c27a4f53ec3cc8c035dfdb77dda6129b0c540e29f94a50ec9b1e0308a096b361b25318c6989e20c2bf5af50f1cdbc7f52bf8ebd68b35c4a62e82ba6293384d03615d6c2f09fe1e67fcff14f6276352d13c3490149071742a6f958c81e4ae7c1d902f6c8e883ef9b8fe3c048764e5548c378fa39c6d515f7b3de785cf59723067293721443dd38e5d39799c30cf11bd072fbe54204338e129e952287bab65a14098c88100c2043969260db03d9215d0c26c452ae3a1b5d35233f9149d28ac09cb667e6ff38babd43ed7e924a042c378d8b9049ca60a6f2665385f202e06de957030c35371d8d8e556d8935fdf2e2028c72affc15c769809acc990fd4efa3faeec0dc331e977d2e2e55a7791b5c694998748231588e08170975d8fa1dc4f32e927b83279652a459f873f28fcfd24f87c627dee5bbbd89dbfc1631970ace96f7a32bd5ca69c848f0086bb0e513c6c321bc6a8f8e8b4ad706f0d19b5c4a4defff5459f4a9a842b8b48ef62cc155a3cce54844c20e9c5e162f94cf9e47aa44262b4b54e7185676cddea90f53c2f107df35a0073dd131aeb3c10d683608ef19387063e1be0f08169af49922b02f99ffd197c99a6fa564b44d6978075ce912f82d5bab1f6a862f71627571eb89d4d3fd5d310e15a78f40f7ceed45b1057e869fb64541ae30bd5b3d4921daf2439717404dbcda9c129618e24e3ca9b97f8a7c077a6c4fc4710c4307f558a00d20e29a35e3541716d4f786a0b92c8238a240a4498eca11367faaea8df473f3c4324588ff23216eacad5386d1b2bf3ad4057759893a7159e46c93f8cb5af5d0927e2dad0efdd910e43e603492d5d3aa8d2fcbb2b9fa3d908b03e06c543361153c7e15307bda6da17771f21fc61a7b5e9c2c5144c54b79e15b6d17f17c4ddfca0d88400fb2b5cbd27f9d980bd9101f9026999b0db1e40f975940daef2173c11839729df6695443f4d880b2fc636b1af33688111c62a3dcb71276a124a19721894ca033bd32bcb7a4f9bc0f0eeaf6edb03628e1c0455c0891cd92b9bfa5986cc0d419ca7fd41235087262b68c5dc07a8060d372b1bd265f442fc354b558b8c4f1193819f5c23176b53a9a7f2a2d5fed37978b3ab61659bcdf3acf26a800c90e78e63af2c996bfa4c9ee2ca69cd266a34bbdb18274a28f33fb47a8ecaf2eecbf228c605bba2af5aab19180637936c937469091694f13e0e673a45107890435ec14bc32ec6e490eba1402a74f30bac52f25d22c803f5f65f3e0c419ecc1e2f6dec9c18401cc484c52b98c68e66780f1a451fa05f67ca6e4de2cba989935519e4aad1e1de9dc5961b247d1eaa7843af3eb81ff630443609c37b860e8b277301be1195954398743f91aa097fa29633248f66dd90345cb027ac9ed28c21e15cb733f1bba8c2a1277a5228f73d2b170005c08efd2fd0f82b7a59c7137c1dda1646fa80d550cc90de6b2746d65d432b116b8ab3b5b231481651113156efb51c827a283c0b9524bf4a05d8db79ff7491c941ea159b1618c2f2100c4289929267b930ef4947ff98dfcdff9782e86098382f3577e828272d10dd9a85a54d216467981860d1caade7e5fa3e55e678c3746223e6779804bfb6a354ca964ad88fadf58fbd54fc6eda0b2e9733c44cfc85c996d5dc0a4cf1e01f2dc7852467755034d00ed2477f6967193e45829020f8ec0978e85936441b6f24e71b7527cccab742e6f2d86ddb4bc857d0729e84c9600a1a1b87a262e7f45886d484134b4bf547d3b870e9636b426e54109f218af1a5f1af3776c74ea3b19859887926c659553065d45750dc733194a3133934dbc1cd53a8529945a51b645760c2d4e25c26f0609146535b5b4ad6069a1c70f828d26bca8fcf391daa6f8174db0b0c2d04ce1f6e0a1edbae74ef05caf9ad362280c002b5f031a3c0900c32fd4ac5f5ebde42bc4d23d5187e4d3afe28b3c56a16a13ccb3160e633ab21c6793d8b010a7a519e4b6836a7139aeb611e0acf8e339308f9db9438082525ea9d818f33b4e818395e499921f1e3fffdb90625b6da53337acbd8c2a37735e974f32beb3f214cc4d180f62969eea88c882f72588bb769d6b1787868173b8773529c696311c272aeaa76f6cbd4a2d0c54307b6f6fc6db536444606d270908802cf2a1b2b65c76de5406029aed054f1b5978034d2aa23054e8e4dd5d83626e0d34ea4731df16d9547cd4a8d7766c3459ec3a10590402c9e05467674b8fe3ddf8a95d33fbcd796b5aec0eb433d3eecbc936b3aeb84cc147850d25b67c6063de7df9063b95c9f7c33085f257007a351b4db96602705f85512c71be51fa7fc411ba4f80f5c9d85150624ced3d5d256331702d4298d1badbd3b71e28e6d93d5558278e5083c53ef17f920021b372769a08a1bc97db6287abd9d83374fc2567d134d29acb2be8d99a6a18738b8f92736e62a34719346891c4564368ddccfa0278ef2c5b2b0f1652e742e6f86ffbf1e27beab5ede55d9e525663f441d925d94bedc29b55d06165c5c3a87b019483c6adf25cf23141c339bdee4e8a27e79a3202fc577091259557e88e0ce3c81284b12ce7483efa3f2e90e4e378d30b755d0f709429194545d7b133082adbede4246aed6dea412ca63ffddbfb1b2f2847e2937894ad0972807b434da5edf7a37d72e805bb62329c9b66936561be31f8cc40446d9164efe3abf2d16ba0ecd561512d6b9b931cb7a737e92d45bf9f2e98cca4a3325b08f75d98dc366b9d14ef2e08abf4de1b553887e80c78e03bf4b53b8fcf8717114a5837b8cecc0e4a5a7ac557c439c5651148d73fdae11e6c0fa450bbaf30889cae0ab7b406aef5094aca16efa29c404fd7bd176a646e7ea521c88f1e7045c179e622915ff1b9363167a405af331840e72dbdffaf1db28c4cfa8dc4ab8f15cde474feee1a8c6199fb4aab2f00b929b68ddd9275a81fd921caa90eae32fada49d70b90389e50512c96dffbc3133ba19a66d43190c2fad642573b9ac6f99166dd77ba0746b8304b35feca79053fcdb268f5f3c7f79a04939056e987cc2ee5a9a20c7e78367dcd18abb15423bf7854f830d43201a43f1303da5db7e789ca87f142e57ef21828a375245970630b0e9feb94756eac021e8de8a21e7d0dcee5849aaf42a5cbc95fc833d8caabdb02942ca5e855aa539c5d3f4f76a4b269d7ce9d553ebf1027ebf618112548e40f598675aae526f55cbb05795a38e5132db88bdd294ba18a26c8214c814c116cc491414e42ac9f5b3047d5c502c8d9f479b665f4edd843e1dd49282e3e8a71e1198e675992eda3b6ca5e42f27487e9cc8c98e7812bc6ff17008e589a7af6ff1c292adf01f24cbf242b5fa2b83032acb20493602a712cbe137bb611a40d50a873133910ccaddeb8636784a3004fe7c47750cc5cf5e3e1e990125e059e609efbaf645e98d6ea009b9cad56012a7c09c91fac02e2df84ebb4be3a32c57ca2f764311525181f7663ec757d8dedc215dd79f3c2db5dd9b301da579cbb2b8e45c8dd5c6906bb6f9f3c02841ced1f4a554f8a2d2d80dd2417e35208b77b7bc57b1fade0085cb8bdc7aa310ffd56829491597f909d246fb023744f351492b5b5292231056e1c09e9da62df9729da90f59e2309574f9a365be302f55e853348a87cf6ab0b7e21323963d2706a2cafad46ccc4ddad127a3aebcfa1d203bf08e0859563bcbf4378adfcf70eadd916ebe1d4ebd368e4af226c725ec3ce7f1bf2dee6aefb651f7bd97fff39450479bbe2e9a95d291b418dae63f5ad91a473f7891510c70fe636323e81fa723699b184502e8a1c84bcfa6131e7e52431cfcd91e97257ee63268f9c4fa83e8cc86282f5390f84299eb8749123274d30038e486f864f85afd63afbf681f852eb59e4ac5fdf33a4654d6471c52ac95733f1ef50ff48a8e49c9983b269487da7f86b895410631edd377675b791946a917f61727b2fbeef92a47ebffea5d537db4f933c1e27eef9e3328b2505d8bde756b3220b75ef6b47b59c0baed6d26b912cbaa7ac1bff39d44df8ffb5ce9cdf891fdb37ecc3c49cee45ac8cf71082ed1222dd22f19c0eeede4e67bb2168456d1d5026021116c2e6c3eed612ab662c9b10ffbbbc23f388fb53fd03226f1aaa2251ecdf748a99d50acdc36695656d0f16d439241837ece868b9ecb4eee0558d98155a4055b2fb9b4275ac72c678c2c6272af87c7e8faa0884b1564bec955d44cacec847f012816bed6fb09199737709d5b41ad720bbeea458840b35d2cd23e6b197506d27e975857e52f78bc17ce50dd3cbea259019eacad8214c6b0559605659421d7908af87bcb77867e99f14a7c4d6b23fc78ba4ff9031849091e7c03738de0c6215bbf86f50b81f5701ab3ff837655f3e86727e4a8def0d4e6bb101b820cde2e34a2702756cbd7d8317624062815fe474e6e07c2475716e32f21a3c475e0b6a2837b493474aadc41b3f26e61292ec8efaec4d469257aff683b39a9dd1d3075e7ca293bcf46b2d070163f51387cafe1dc51a9f9a1f20f1515c0d4ebfb47c61d6250b40fd76b8997fd4247b32af5cdf10dfa58447e4a6b07eeec8532a3f8defd32b915ad59dd8840891cfaf7f95e0e6e5cc6adccffdb66d0c103cde55c39d5f5c7a216326ae0233dceb414894b232ae8663c47e68bb8b78947e9b7f8dc9aec846eb10d7749df0d0af8ab9163d1c8e07a8e080f74a3a7c19af5254e0f552c986609d39b783b02fe9300c2187999fb9eb21898bc80c097e347c7b32c8912f33c110c8fe3f0a32c6753ae028b9027d1ba383fee53105e7cbd2ad12c5bce921b64b855965d0a4c3e956794d2c6fa2089bbae05f6cb44efe5db59bc19bcb60d2ccaf3e9b0240be3a680fb4b0f3b852bb4db02d6fc40464d22f25d8ea3bd409bc7ed148ab63093db5cd172d88fa50c98e8f0840c208edaf8185dcb79e30aae9c11fff0df2ed75a7f3b19f33998ca0f66be5ede0cc98d4ffdc4a2e2d412db671000755f593e0271113c4172a3d4adfbf90a4ca09d0f02303c5bc3958ad60f7ee040f238cb647c9b84a9444aabc9a0a50ce40c3e6f8f71d58ea31517d1d94a92531966f9c112e0623911ba0b062a5db3c1d3029f917b26731e3f192d3dc2998cf4cb444ff094ab588180108682190f608eb67edf428481eceb6a4094bd2fe5abff70b976e83778d8f5bbcfb6afadc40561e50fc23f82001fbc60b43db4ab68cbd2188e40c17d3bf3d5068e30bb3507917e852f2a8f079ab5f03976b490f335850f8491481f40959abcad2d317d3f50d3c4acdd79efe5dc74433a40866d85211424f3a32865f1b00d974300c55b1f83d9aa453d1c9c89f27d3c466b8f3cbd6269592401b91349cb782d1044628e5412bd0a34b958b2dd1e61c73e720658edc6a8504c2e5b7786547431b5c7390b86d1a859c5ed2878d395e903dad0bbbf0330e914fe526638081419c85bd445095f51c1037cb724c35fecf59ec602f2126f524011b7eda25f18184790827fe276e183cd6a97324141d03c106ad696db233bfcbd164763a12e51df7c055dc7282dc5c624a1902dd826c21b778b3b138a183b556872a8e08f39fce317d9f01bd0f6bef2234ea85561f1d167622df65ef8ed0b3840d111adab979aaa6b9ad1a96d9549258bdb01d5b4321021a70677a1023b635fbf57c62860b01b00620fd77d2e8aeddc0e7733351dcc2fe61548766ddecf7555d45cb6e1f36d3532edd7c8dc0b78a4d5e99e992b1237e2a542e7e27cecf726b1c433e91a48a79a875709ecf28deb5ddbce6626e28b0c631e1e3c113ca4ccfbe6a39d7ccd497f8d08f1a407015dd4dc6978673c6f1f82fb1ba57f49b72980c8965294a08c389e3844b83b20975c7074a58521bd0f742d3981ea2cd00524473f0e5a4feb8dfb49a960d4f21eff53f0b7e63c509e05c4bbb3151e958291fc500c4a2780396c19dd5eaa9cbc92f380a6a86008a144b121744411dc95b5df91706571b12a53ee8e7e518f307631a06fa09ce4e578c7313cbbb92e3cade9b858fc0d34122361668284bc75f84ec54e4abbec226de3a0eee9dc891b8959012e229297c262cccd9f3d483ed87cddc6cd996cf7f1ff9cd")]
        public void ShouldMonteCarloTestTupleHashForSampleSuppliedCase(int digestSize, string message, string digest)
        {
            var subject = new TupleHash_MCT(new Crypto.TupleHash.TupleHash());
            var messageBitStringTuple = new List<BitString>(new BitString[] { new BitString(message) });
            var digestBitString = new BitString(digest);
            var hashFunction = new HashFunction
            {
                Capacity = digestSize * 2,
                DigestSize = digestSize,
                Customization = ""
            };

            var domain = new MathDomain();
            domain.AddSegment(new RangeDomainSegment(null, 16, 65536));
            var result = subject.MCTHash(hashFunction, messageBitStringTuple, domain, true);

            Assert.IsNotNull(result, "null check");
            Assert.IsTrue(result.Success, result.ErrorMessage);

            Console.WriteLine("Result: " + result.Response[result.Response.Count - 1].Digest.ToHex());

            var resultDigest = result.Response[result.Response.Count - 1].Digest;
            Assert.AreEqual(digestBitString.BitLength, resultDigest.BitLength);
            Assert.AreEqual(digestBitString.ToHex(), resultDigest.ToHex());
        }
    }
}
