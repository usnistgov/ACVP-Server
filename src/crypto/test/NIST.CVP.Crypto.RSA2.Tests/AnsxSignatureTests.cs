using NIST.CVP.Crypto.Common.Asymmetric.RSA.Keys;
using NIST.CVP.Crypto.Common.Hash.ShaWrapper;
using NIST.CVP.Crypto.RSA.Signatures;
using NIST.CVP.Crypto.RSA.Signatures.Ansx;
using NIST.CVP.Crypto.SHAWrapper;
using NIST.CVP.Math;
using NIST.CVP.Tests.Core.TestCategoryAttributes;
using NUnit.Framework;

namespace NIST.CVP.Crypto.RSA.Tests
{
    [TestFixture, FastCryptoTest]
    public class AnsxSignatureTests
    {
        [Test]
        #region SignTests
        [TestCase(ModeValues.SHA2, DigestSizes.d224, 2048,
            "19f9641ecc4e21405d238542fc633a35a33f3ddc84dfb8dc000c27bdfbb5128c0ae3b561ca615aabf7223824d6415a8a6285ca781683aa76ab9c8542dc02bc50ce60770246fa565a1975f6ce508d3cfc30b24b7eccc02183c5bf6a9b7900d621cb3e97fe57031574ab9e54b0eb2040415262cb7f354e032c39453ac38c51d9f9d98bccde0b866d5bbb4013b84054d55ecf8677a3af7308898ef03d30c796cb020aab69002ac00e820fd0bdb176c20589eee572f8699c27353dea73f7ea9b6c83a55d05f7eec7bb77244f11895ff0f462893ead61d8e51c55eea2ffc5b522c0b86fcde09c785f418570d071ddd39d8c3c3a05d80ef51a081ed3749180b973f24f",
            "a674f0f2a01fa0a987d0ef355f36cbd7eda5a931d5eca30b18fc237a481fcea435fe514166db877ca1e645204b0e1e2a8e5f7fcf28a98306c70424f0f4025c7d8c6d89063ac7847bf52eb1f2852bdd5cc03c1cbf63875b5062f4d22b290526a5fecfe343d39c3b46626b63e91670802b4d7a066973474a757d3e5957ddc020afddbeef963643b237651f7bd58d9af4ea67da7de5620539fb904c5a0243388498013470de777c8f11924add97fa1fb11b51cab46ea38adf995ad5efd0958a98cbf022dfb0d4b128917e4b513f120629051307b4d9d1014a28c55c93aaff59f47a7c0472a8b7a1ad5dbf07252c4b2602278fe18a77ec8acb8798f9f8b720dafe03",
            "d20fca706b61bc2ad3ac90c7e8e6bcfd5c871f39b8862c34a0854bc758497c00876c3e753b56afd82e69f4cc487cdbf7648bbf5957acaddc2e45c42cb87de2c845f07d5aaca7ce449347357bea88d998b9e98f2c1ca3fd548bdbff8e5f1b49cb92034ec6c73c61938aae1a7bd8f3fc07e20b545b0e5164c53fadc196560cfa31",
            "3b3312298cf3d8d027053d2dab5810d74794073b33d51b40963ae8dd46d8a3c338407f0476746069e72a316581a82d3b5647c3255a77fffa318c75995343548d5eb16e43941b54235d88b1050997ba841dff679a83fe2f85cd6f4807e923a3d1fdb5a8d80fe472d012b262360da3b9dfd43d42333f135227da6428eb3ee470427bd045cb2cf63b6b62f7f10a8dfe597628e2aa9df29d87bc7122078fc6cb5e4e4976fa96546bcfa6d7f5157f7801bc8eaff9a76e304e165fe11676e66981dc5ea2810e74a72382a91259ab36e0ac89adfa0cbce171b6179ec0bdfe07fd7f66ed70acab274ce572e3c2a8d5954f9c6885a2a7e46fe7b471e6c0672bf690257912",
            TestName = "ANS X931 Sign - 2048 - SHA-224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 2048,
            "19f9641ecc4e21405d238542fc633a35a33f3ddc84dfb8dc000c27bdfbb5128c0ae3b561ca615aabf7223824d6415a8a6285ca781683aa76ab9c8542dc02bc50ce60770246fa565a1975f6ce508d3cfc30b24b7eccc02183c5bf6a9b7900d621cb3e97fe57031574ab9e54b0eb2040415262cb7f354e032c39453ac38c51d9f9d98bccde0b866d5bbb4013b84054d55ecf8677a3af7308898ef03d30c796cb020aab69002ac00e820fd0bdb176c20589eee572f8699c27353dea73f7ea9b6c83a55d05f7eec7bb77244f11895ff0f462893ead61d8e51c55eea2ffc5b522c0b86fcde09c785f418570d071ddd39d8c3c3a05d80ef51a081ed3749180b973f24f",
            "a674f0f2a01fa0a987d0ef355f36cbd7eda5a931d5eca30b18fc237a481fcea435fe514166db877ca1e645204b0e1e2a8e5f7fcf28a98306c70424f0f4025c7d8c6d89063ac7847bf52eb1f2852bdd5cc03c1cbf63875b5062f4d22b290526a5fecfe343d39c3b46626b63e91670802b4d7a066973474a757d3e5957ddc020afddbeef963643b237651f7bd58d9af4ea67da7de5620539fb904c5a0243388498013470de777c8f11924add97fa1fb11b51cab46ea38adf995ad5efd0958a98cbf022dfb0d4b128917e4b513f120629051307b4d9d1014a28c55c93aaff59f47a7c0472a8b7a1ad5dbf07252c4b2602278fe18a77ec8acb8798f9f8b720dafe03",
            "f648ffc4ed74845803fec53ba865d3889b3892e402d96c5eba814698ec84b32ce1d7684917cff19d942ba2787a55cf2edce540bdd067dfafc55eb442178913c7e164144813f2446dc4ba9aa0c90fad708695233304016df04420b27cd31b08e29ff9ea080965e7903bb297fdbc1cd31741512590c7307ee7ded0278d48c4fa47",
            "4d4ea9c758775fa7e90977ac8ef2249be7a8c3f2288ef36b59f9efe8b0175f5a7405970cc1884820fc9adbadf7b17cb258293b0cfcea119bacd5f7e1de4aa99757d2cb65bd21f58adaef0754bf84e84dfc05ce1ea9fe40dcb5cf8221ce1a4a99acde9e84a2214b7a3e57d7b92d59a003b83af7b0108e9ee6c73580004244506ef3cab5bd1ddfc319a474492645b1815349f77a9f581b5f1b84e5ea03f48f2f12fffeb62e84535094277544dabe3e119b42e46f16f579b3c4d9dea86cbd616ba2e04706072293cd7eabcd667ee06bacb435004f3e8be90727e44416b6be1672ef465e01645ea38f4f899c6f6ac5f8c5c6cebdec629a00df53a923d3359821ea4d",
            TestName = "ANS X931 Sign - 2048 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 2048,
            "19f9641ecc4e21405d238542fc633a35a33f3ddc84dfb8dc000c27bdfbb5128c0ae3b561ca615aabf7223824d6415a8a6285ca781683aa76ab9c8542dc02bc50ce60770246fa565a1975f6ce508d3cfc30b24b7eccc02183c5bf6a9b7900d621cb3e97fe57031574ab9e54b0eb2040415262cb7f354e032c39453ac38c51d9f9d98bccde0b866d5bbb4013b84054d55ecf8677a3af7308898ef03d30c796cb020aab69002ac00e820fd0bdb176c20589eee572f8699c27353dea73f7ea9b6c83a55d05f7eec7bb77244f11895ff0f462893ead61d8e51c55eea2ffc5b522c0b86fcde09c785f418570d071ddd39d8c3c3a05d80ef51a081ed3749180b973f24f",
            "a674f0f2a01fa0a987d0ef355f36cbd7eda5a931d5eca30b18fc237a481fcea435fe514166db877ca1e645204b0e1e2a8e5f7fcf28a98306c70424f0f4025c7d8c6d89063ac7847bf52eb1f2852bdd5cc03c1cbf63875b5062f4d22b290526a5fecfe343d39c3b46626b63e91670802b4d7a066973474a757d3e5957ddc020afddbeef963643b237651f7bd58d9af4ea67da7de5620539fb904c5a0243388498013470de777c8f11924add97fa1fb11b51cab46ea38adf995ad5efd0958a98cbf022dfb0d4b128917e4b513f120629051307b4d9d1014a28c55c93aaff59f47a7c0472a8b7a1ad5dbf07252c4b2602278fe18a77ec8acb8798f9f8b720dafe03",
            "ccd28fa083c6a9af7d9d12e6c549c7ddd95ae4d35417675acace3751f46865130d40b1ee7b3650d7b2ffec5b56bfedd99fd9f7ef0205b3320ea4d3229451505d0ab9f61231ac23b9f674cc019665c00a06b531d5928e70f9c462f897877fae8f8ce367f4ed51abbe11a4b9bfcf64cad9d6979a6d4cd92516b5afae9817190613",
            "4f537f706692d2c45c9623a60c22d00278a027d8fc162fc52aa7f74051aa0028581f041040f5b7e6899e7c5b67a5b1ff605aedebaf70d7d965896cb20b1d01d810fc6c06baa33c38340aa65b29d0d0fb81eac9a92738cfcd714b3791e371ac4a05339d0dd9ff116ed6173b115889d80a34ce9a9ad9e8b67ff88d72fc8ca8847c4106b596e115e566188cdb69e6b199929043af1d5a29c28f377c67bf0a073ad5200bf5d2af8b9a6e2b0b7d3fbce42c1ece60f1bed3c997b17d6dba726e0e859568565b13385c92d1965543c6fbd2761fee2fbf8130b2a0e877affa4f30289d0d173c218d04accd987463dff81f00a812966d09fe843f5913cd6ba9b72e0d5080",
            TestName = "ANS X931 Sign - 2048 - SHA-384"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 2048,
            "19f9641ecc4e21405d238542fc633a35a33f3ddc84dfb8dc000c27bdfbb5128c0ae3b561ca615aabf7223824d6415a8a6285ca781683aa76ab9c8542dc02bc50ce60770246fa565a1975f6ce508d3cfc30b24b7eccc02183c5bf6a9b7900d621cb3e97fe57031574ab9e54b0eb2040415262cb7f354e032c39453ac38c51d9f9d98bccde0b866d5bbb4013b84054d55ecf8677a3af7308898ef03d30c796cb020aab69002ac00e820fd0bdb176c20589eee572f8699c27353dea73f7ea9b6c83a55d05f7eec7bb77244f11895ff0f462893ead61d8e51c55eea2ffc5b522c0b86fcde09c785f418570d071ddd39d8c3c3a05d80ef51a081ed3749180b973f24f",
            "a674f0f2a01fa0a987d0ef355f36cbd7eda5a931d5eca30b18fc237a481fcea435fe514166db877ca1e645204b0e1e2a8e5f7fcf28a98306c70424f0f4025c7d8c6d89063ac7847bf52eb1f2852bdd5cc03c1cbf63875b5062f4d22b290526a5fecfe343d39c3b46626b63e91670802b4d7a066973474a757d3e5957ddc020afddbeef963643b237651f7bd58d9af4ea67da7de5620539fb904c5a0243388498013470de777c8f11924add97fa1fb11b51cab46ea38adf995ad5efd0958a98cbf022dfb0d4b128917e4b513f120629051307b4d9d1014a28c55c93aaff59f47a7c0472a8b7a1ad5dbf07252c4b2602278fe18a77ec8acb8798f9f8b720dafe03",
            "64a330d769d328a042e93c9dd8c12aac623f9be1733e471d37c960e2f98e2e65e98ff7e51d1b213cd5fd9ab403f3781b0b62dd1ac7471ec2ce712468f6ee12b317c327f312e0e7b41252759412bb4451a0ffee26e0416458d30e480cd9d7975b75a58ba85108c031825095e50c00d576a98097aec6126206cf079575ac330686",
            "29c0bcf7810f223c3fa5222a9649dfb1ba5ec3157c415994c77af183d9d09d2d831d43f8d81556af66e2f0591905abbd09ff402dc3005d650d809a7d1c4a12a8d5c561f09dcb8f3a4e7d516cd75fe9c05ee295748b7e8d5d04ca441daf8e8bf73df65b7240cf053fd3831f8d0a7e1652149f3da3f13b5df95f6abfa170f063b02cc263b0a5d8f4475bd86154702297774ad36624591dd71f98a49cfbad919e52834b43ea3cb7a6c91e05dccfcdcc48d6a74b0cf7963a99f95c0148df1ff9f79b96f30b9e279d629801cf8befb7e73e0efce8e61d4d2f5af203f2f892a7e0ea785928e219d15b1f71b3a3f574564618b3093d24313d9f6fc44e28dc754f6db8af",
            TestName = "ANS X931 Sign - 2048 - SHA-512"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t224, 2048,
            "02791b140546ec6c183829676d63a4ae126f863a314a733401be20e1f550f5ba172c5f77a5b17e0bc1cb7f6bbc77818e16a117e9fcd51a432b0f8994b6136dc2c3b9b815dd2f86586125762fc0c1054796c87e39fb5719aef93f9e4f3d4f2a812e5a608dbf3cebcf26eb1e89d9fd8b8baad5cef1c3b77252b365bdf0859baa1d06bc4629ff233b2c0cb8834ce395818a325e6fa35b485af1b2ddfe5376fba5d4896202d735dd14c0caccd8f54cdef07b4f83b2a1eda7371c922eb0435cee518cebf6cb54f91999407425968c628c4b6f6c75d9dd7ea8dd52a9ddcb72466e7a68241dd52a01cf20d103a9ad1e4746bb859114309a40705536c2ee95471553b983",
            "d01be600ad7f394c1641b5fbbb79062fc0cfc10d8ba489d5481fb59512695ad2ca9de4f39c9b74607e579583ce1bc43d900e70508bc2699f8f72a55bd91285ace6753ab45dacf7b4e23ed46f9ca3c88a23025b6c5ff5180088ef9a64ab9ab9c8846624deb986453c52e3247782fc828498d563ca2f5f0ea8613d9fd5c178a15fe1bf68fda5172f7c02115cf9d34996b6d15b9e14edf998d6fb93c8965dbf19d2871058444e537b6946c3a775f58f0ac27897924e2d9a264aa1d021b3858f66f5cac5a5498afe934cd5f3e1a7dbb32e95f7ecfea72c554efdc84c6db76631c76d1a5ffa12a54b81106137650e68e3399aead8eea83694ee10bbe335ca19d0fd65",
            "04af4ec1ea950c715a06bd9588efe4b3ae3721fd0bad56df2b3f08d46a6c087db4fc52f48eee355e5ab2b4bfd6982d13e789389a95f5d273560cbb6c8f311c1958ab6d23809e96e3d03a542f9433df745871ca05f0082ab3bb6afa9e28dcbe4b782667f6c68f77294508658dcaa843018a589ee924d0a6c8e2c28e123b54363b",
            "30ea6542b24abb9b03617ef3daa65ed3cd0f3035c7f1a741a0403129f809150ed65f23acbcc21d63e6c63669a6175d2791e7d005c1b9931ffa6cb86297cdcbf83d6f2bb674e0ead4e25e0f2118dd0d8406fd1db46947fb0ab9f1b3e41e8e6ba7c4e98b66d5ee618027816cf8f62e768be46dbd8851236e67e429811043a630d17dbf16b50107e83dc981f3743adb04130e1948547d6e10dd7e23701c9ee13c75924afe9b8ab41d420c69b61ada9895f7f557e33d471657aa8a2b37877b969776b4bcd944052cfc0f86271734cdbb8b96c29b806de77cf18fa5c096e99fe3ca546bc1e5a335bb05b38b3b42438fd8ce981828ae63be8653b23c4d087720366b3c",
            TestName = "ANS X931 Sign - 2048 - SHA-512/224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t256, 2048,
            "02791b140546ec6c183829676d63a4ae126f863a314a733401be20e1f550f5ba172c5f77a5b17e0bc1cb7f6bbc77818e16a117e9fcd51a432b0f8994b6136dc2c3b9b815dd2f86586125762fc0c1054796c87e39fb5719aef93f9e4f3d4f2a812e5a608dbf3cebcf26eb1e89d9fd8b8baad5cef1c3b77252b365bdf0859baa1d06bc4629ff233b2c0cb8834ce395818a325e6fa35b485af1b2ddfe5376fba5d4896202d735dd14c0caccd8f54cdef07b4f83b2a1eda7371c922eb0435cee518cebf6cb54f91999407425968c628c4b6f6c75d9dd7ea8dd52a9ddcb72466e7a68241dd52a01cf20d103a9ad1e4746bb859114309a40705536c2ee95471553b983",
            "d01be600ad7f394c1641b5fbbb79062fc0cfc10d8ba489d5481fb59512695ad2ca9de4f39c9b74607e579583ce1bc43d900e70508bc2699f8f72a55bd91285ace6753ab45dacf7b4e23ed46f9ca3c88a23025b6c5ff5180088ef9a64ab9ab9c8846624deb986453c52e3247782fc828498d563ca2f5f0ea8613d9fd5c178a15fe1bf68fda5172f7c02115cf9d34996b6d15b9e14edf998d6fb93c8965dbf19d2871058444e537b6946c3a775f58f0ac27897924e2d9a264aa1d021b3858f66f5cac5a5498afe934cd5f3e1a7dbb32e95f7ecfea72c554efdc84c6db76631c76d1a5ffa12a54b81106137650e68e3399aead8eea83694ee10bbe335ca19d0fd65",
            "6373589c67f37b8ec290d625476667748a460cf9e7aca02bc6f167521ec2ac9b38d1a86cb6caa6f5d3896508ec8abe2a40a186eaf4ebb6715a04c95b727a66c5b1823fa702ea39650b4fcda0b190ae52de82ac1a81e6d8d4d798e96dea09def557eee5f6533a7c05f04ad6969d608015ec53443299854e7cc7148d318c555c54",
            "14b45928ed0a87ba76ca890fe2843cdb9e2a1fc3a41dd2242a3087d1b7b594b46fa7d857644aa34da371572e6ac5e2b73ee306877dae497a64c66cd62b698a110074708b8a1595f56e33f5284121ca4a3a73dadaab3ad1654fe95679b1ddcf72144cec6cd23bf7088cf5fa8f4fd3e2b1bef8fbefffe8e3923afc2523c2a91fad757cb11599f1a1aa03a0ce3c78c765beb4df190d98ae0c3d6f1d1014604573e271a74e01caf1c265b614300f218af08512c8e9c1544a09e691f71e9810f37edf8949e63f98036318bb9097f49aedaf6bf1344e2a2f52475d31f46d58eebf8fcdc37234aebaaa9774bde8294bfb72cca9e71051cee9a64b6c2dcaa088db569b58",
            TestName = "ANS X931 Sign - 2048 - SHA-512/256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d224, 3072,
            "24ae1c4fc7a4bfe01109e903f3bd12fa8769be59a69022cc4fb6b4c59ff6a105cfaa39de08f7a1fec3bbf5d0afdebc87cf394e5eaffaeffcdaec5f2ced1a48f163681b5d6a38911e341e7a2ae708799de83e642c41210b449b14b877efadc46e56d97ea3da6a7c82d5373011cb9d5232c7ce6a38fd2d511dbe08a67bae18a03584ccd63fa08ccd59cf1f752b28e4e24b09736a05841a6347751ac54d8dbeff24519b2648e974d258b6702026fd04cad50f5dcf56efad53db3fcb912e778198df8bd2937eccdb88ea2c64a3732d0ef24ac7b7dc9b63f31efc68cf657cbd83f564fde28c92d2b1c7e5521e3dd4a660ba80d7accee31c65d8b37247097f1c23f8dcfa2cb49525edbacbf05ef669f748c60b8aac9a9723d2620bf97d3cc8c8ac3ab5a533714b8ac76fc3eaf6921ef5cd23b847d3bc68ec019be2fcc932b8209d5bbd08e5b96e97d448b6f4e19d91b325c943c43b65a42b593cfae7c35987d739765471a3e276cf9e670c3fa8bc49bd891744a9b96c0f801581cc28cb04e5a83733f9",
            "9ef147700655a568cfffaef293b86e35f562ce3e4326bba11a049fc4e4b766270608e12d5f09dcbf4f295131a8fb0bb5875a6394bdf129e307cabb5861710a956aa9411533d46994b678aee60b5927d065b6bc3130d0bd36135a46d5153dc530e619eae17b06a6db2d75a4b31e32539a89bf1b2b350c7eccc02a573af7d0d34d98e037698301c84d3e9ae66ee5e3429bd27c908140167d3c0ec4bf7b37a4eb60456d12752bee1e0aa705d184a11917bfbe8a73c07f42ee1957fdf30c5a331f7335bf113e215c0a4c9f89099b94ce74ed76e380ecc7cea221d8bcd961cd014762f9d12049d4288f585249c9536ca8abbc2b6ea63afd9bdee0aff6ee91a2f31ca82aaa778159fa8b9bd5e72268bf89afee45494653de7764948b9b877fab124b3b66cc4ff7fb56ba4140936514436aedd2cdc34c032c5b3c385db4f8b658ed5027001d9084064de2f11bd10ef2e290e421d3f8fdd2d217dc6f5aba8d709b6b25c17c0a4825a1e3633005380f16f51614aa3a7bab5169cf840f272919a28a765ba5",
            "bce699d74adc1b6b829ce240c1de586cdafdfac066fc54f15cc82df5e2bcffb0626aaad0df9968f68a8a041690804720377eb4e0295375230fd4941b62696e047ecb6508f90bd66032d74bbd2df9f1e69e204ca243e329d87703d4f505f08c8e3a8f34473e3b4bf3a40a1efc3f513c05376a2bcf5db45959bcdc554c705b3f95",
            "16f420e10b1a590bbf450fa4ae1bd0f52e684a0a32bda8f262ea53d02f54251addd1c6a74b881dec011daf7e5fc85f2200da225e1ee226a9951586bf3fca60ccd940a8d83ec0e4dc6855e333d35fcb2de42d99c82bd8b0b460bea678885885ce6ec6909fb06515fec743016d296787cdcfc53d8ff741f7c0609e6a0bffac1524d1a1d515b03197db26aac9580b5613085c9cb4c47352f30f720f24c5deece49fa0cfbd2f582b51cd763f27f4e667106fd90aa9039f4978c11fea4949844ed86e37f6cbb4ee7afb81d7a91278b69fee7ca59af2188a4c343e50653298f46dfdc4c0bb93c13f7e260da2e0c5d0eab47ba1d85f98b0c2f1810fb07a962707cd95c18e1029a0ff0f035b97283a72a2ca231729982900b4177809fa7884f3f5519666a5c838b86f3fa42bff92d3e69d1dc61c064d28c01704583ec44b5badc17ff82ba0c01f9948a2962189ae2bfa4aad5f5454ebd32fb654aeeccff53be5a9625ef5fb06e323ae29085824031bf6d97392c6b65ccf7d644770594882fe47120d6cf4",
            TestName = "ANS X931 Sign - 3072 - SHA-224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 3072,
            "24ae1c4fc7a4bfe01109e903f3bd12fa8769be59a69022cc4fb6b4c59ff6a105cfaa39de08f7a1fec3bbf5d0afdebc87cf394e5eaffaeffcdaec5f2ced1a48f163681b5d6a38911e341e7a2ae708799de83e642c41210b449b14b877efadc46e56d97ea3da6a7c82d5373011cb9d5232c7ce6a38fd2d511dbe08a67bae18a03584ccd63fa08ccd59cf1f752b28e4e24b09736a05841a6347751ac54d8dbeff24519b2648e974d258b6702026fd04cad50f5dcf56efad53db3fcb912e778198df8bd2937eccdb88ea2c64a3732d0ef24ac7b7dc9b63f31efc68cf657cbd83f564fde28c92d2b1c7e5521e3dd4a660ba80d7accee31c65d8b37247097f1c23f8dcfa2cb49525edbacbf05ef669f748c60b8aac9a9723d2620bf97d3cc8c8ac3ab5a533714b8ac76fc3eaf6921ef5cd23b847d3bc68ec019be2fcc932b8209d5bbd08e5b96e97d448b6f4e19d91b325c943c43b65a42b593cfae7c35987d739765471a3e276cf9e670c3fa8bc49bd891744a9b96c0f801581cc28cb04e5a83733f9",
            "9ef147700655a568cfffaef293b86e35f562ce3e4326bba11a049fc4e4b766270608e12d5f09dcbf4f295131a8fb0bb5875a6394bdf129e307cabb5861710a956aa9411533d46994b678aee60b5927d065b6bc3130d0bd36135a46d5153dc530e619eae17b06a6db2d75a4b31e32539a89bf1b2b350c7eccc02a573af7d0d34d98e037698301c84d3e9ae66ee5e3429bd27c908140167d3c0ec4bf7b37a4eb60456d12752bee1e0aa705d184a11917bfbe8a73c07f42ee1957fdf30c5a331f7335bf113e215c0a4c9f89099b94ce74ed76e380ecc7cea221d8bcd961cd014762f9d12049d4288f585249c9536ca8abbc2b6ea63afd9bdee0aff6ee91a2f31ca82aaa778159fa8b9bd5e72268bf89afee45494653de7764948b9b877fab124b3b66cc4ff7fb56ba4140936514436aedd2cdc34c032c5b3c385db4f8b658ed5027001d9084064de2f11bd10ef2e290e421d3f8fdd2d217dc6f5aba8d709b6b25c17c0a4825a1e3633005380f16f51614aa3a7bab5169cf840f272919a28a765ba5",
            "9ae15d2391b6e99b14afbc2c8434e9ac2fefc823d1389bda5bd171b4f2d44bc13be97e11d6bc58c628af066d5eccb58faefdf882e07f6a850e94940da8781159ba97ef4c72fd597cdd0e7387f17786a6d0645d844bf4ef50a5e93e109aa57e39a0527a7d6d6034e5b934cb1f451ea2191c8cbfcf197e7161a93a3668d241db8a",
            "2c5a2714be3968b4b1beec37abe4ab9e00c7df05cc210166971ff2c8bf2c8c139099f90c3dfe446c6eb14ac81cf2a4f99d3e66943a31dfc0028e05f7fae3aee2a07b569e30e800cd84d0000482be5f1379dc4bf7b006c3773b695516cbc416ed384a6b22e43d40a445814d43ed8e25083dc25eb55bfb2ecd1ef1cadf5c7771195d764b063643d01c4744623635fa4eec3334a490635348bfbf7b765c98073a9f5d25485d7175d34d97b240b8705c8a4ebfbe9d47a59c8059cc672226b9b0d0bdde0b653bfec89d4eab91893bd552dc9527cb82dd7845e515bad6533770da51657977e8202a0efb38c888034dcfa3b2c432db146ac4ef111116679a00cf684ef4bfaa85eb1f1c99c304cd77cc57e86615a9e6472e423231324b3d63c0147718e85d2a8565f5c9cd2aba736d3867a001d27f02d6056b5d1d0dd06525576c58ad940817168deede22a6af77001391fbf059f15501c3ecd6d31d9fe6f1e3095b0a75eda0efb44fae79e57737d732d7990ea30f7205ca9e8d5f5f169748b616d4b793",
            TestName = "ANS X931 Sign - 3072 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 3072,
            "24ae1c4fc7a4bfe01109e903f3bd12fa8769be59a69022cc4fb6b4c59ff6a105cfaa39de08f7a1fec3bbf5d0afdebc87cf394e5eaffaeffcdaec5f2ced1a48f163681b5d6a38911e341e7a2ae708799de83e642c41210b449b14b877efadc46e56d97ea3da6a7c82d5373011cb9d5232c7ce6a38fd2d511dbe08a67bae18a03584ccd63fa08ccd59cf1f752b28e4e24b09736a05841a6347751ac54d8dbeff24519b2648e974d258b6702026fd04cad50f5dcf56efad53db3fcb912e778198df8bd2937eccdb88ea2c64a3732d0ef24ac7b7dc9b63f31efc68cf657cbd83f564fde28c92d2b1c7e5521e3dd4a660ba80d7accee31c65d8b37247097f1c23f8dcfa2cb49525edbacbf05ef669f748c60b8aac9a9723d2620bf97d3cc8c8ac3ab5a533714b8ac76fc3eaf6921ef5cd23b847d3bc68ec019be2fcc932b8209d5bbd08e5b96e97d448b6f4e19d91b325c943c43b65a42b593cfae7c35987d739765471a3e276cf9e670c3fa8bc49bd891744a9b96c0f801581cc28cb04e5a83733f9",
            "9ef147700655a568cfffaef293b86e35f562ce3e4326bba11a049fc4e4b766270608e12d5f09dcbf4f295131a8fb0bb5875a6394bdf129e307cabb5861710a956aa9411533d46994b678aee60b5927d065b6bc3130d0bd36135a46d5153dc530e619eae17b06a6db2d75a4b31e32539a89bf1b2b350c7eccc02a573af7d0d34d98e037698301c84d3e9ae66ee5e3429bd27c908140167d3c0ec4bf7b37a4eb60456d12752bee1e0aa705d184a11917bfbe8a73c07f42ee1957fdf30c5a331f7335bf113e215c0a4c9f89099b94ce74ed76e380ecc7cea221d8bcd961cd014762f9d12049d4288f585249c9536ca8abbc2b6ea63afd9bdee0aff6ee91a2f31ca82aaa778159fa8b9bd5e72268bf89afee45494653de7764948b9b877fab124b3b66cc4ff7fb56ba4140936514436aedd2cdc34c032c5b3c385db4f8b658ed5027001d9084064de2f11bd10ef2e290e421d3f8fdd2d217dc6f5aba8d709b6b25c17c0a4825a1e3633005380f16f51614aa3a7bab5169cf840f272919a28a765ba5",
            "ebe884674ddaa754c4fde5e95692861cb4d2f680b48ed00c01133b1e115079bf583bbd29bc703d87481b89fb24191be5c55a2f63618ad514a6f04422ab96717f27aae06ee124ba4667a9217203afc0bdebe3a6cdb8c754ec19a0140fc98f8d10befe953fa43d4619896d5457da9e9d2b8e3402c6a18f761dc4eb54ed5384f6fc",
            "0bd290ae926659e52ba3938a9d73eb940c108998a17714298c9094b5bd67ae1dddf3d30f0e9f7434f64ec9f71f35c7174d8e72135f7c5273938b441572051a39de60f72a0150299a7069d8f323a5570cd2b26cfbac37f7d0b2951db851dddac8015deab440ee3a8b5764ac5c38070021677e29fbf820cd3c5e0b994d07f3eae15b5388306fc8b77b74094db89c9e8aaf70a90ef0fa821f26ec30821632805ab88f18ddbfa3e26821bf35cd9b323ea14fb90876e1fc2ad1c501b52e014d0bfa991c1e3bd8b0523a02f508ae3f788d6160d2e98481ce210a1167a3e6e52d1a7b87740e71a2d77d8f729d90a0ccb00f8e9c6d407f27b8e3fa45418035469884b6cc976505fee0758e8238d2b4bfd665e46dd3d5bf6694c7295b6bfe4afbe245d69fee3bec2cd6159cc826a3ce3df7634070b49400380b9b69f6a14e2b96006439754277b1f7c93b16cd7fd26b111452c04d9c864ad35191b5b9c4d401abbf5595a9392a1ac2bf0e952b2f74c0d3ed9578c80971fa2bc87b3ccf16fbb2bf3540d0d0",
            TestName = "ANS X931 Sign - 3072 - SHA-384"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 3072,
            "24ae1c4fc7a4bfe01109e903f3bd12fa8769be59a69022cc4fb6b4c59ff6a105cfaa39de08f7a1fec3bbf5d0afdebc87cf394e5eaffaeffcdaec5f2ced1a48f163681b5d6a38911e341e7a2ae708799de83e642c41210b449b14b877efadc46e56d97ea3da6a7c82d5373011cb9d5232c7ce6a38fd2d511dbe08a67bae18a03584ccd63fa08ccd59cf1f752b28e4e24b09736a05841a6347751ac54d8dbeff24519b2648e974d258b6702026fd04cad50f5dcf56efad53db3fcb912e778198df8bd2937eccdb88ea2c64a3732d0ef24ac7b7dc9b63f31efc68cf657cbd83f564fde28c92d2b1c7e5521e3dd4a660ba80d7accee31c65d8b37247097f1c23f8dcfa2cb49525edbacbf05ef669f748c60b8aac9a9723d2620bf97d3cc8c8ac3ab5a533714b8ac76fc3eaf6921ef5cd23b847d3bc68ec019be2fcc932b8209d5bbd08e5b96e97d448b6f4e19d91b325c943c43b65a42b593cfae7c35987d739765471a3e276cf9e670c3fa8bc49bd891744a9b96c0f801581cc28cb04e5a83733f9",
            "9ef147700655a568cfffaef293b86e35f562ce3e4326bba11a049fc4e4b766270608e12d5f09dcbf4f295131a8fb0bb5875a6394bdf129e307cabb5861710a956aa9411533d46994b678aee60b5927d065b6bc3130d0bd36135a46d5153dc530e619eae17b06a6db2d75a4b31e32539a89bf1b2b350c7eccc02a573af7d0d34d98e037698301c84d3e9ae66ee5e3429bd27c908140167d3c0ec4bf7b37a4eb60456d12752bee1e0aa705d184a11917bfbe8a73c07f42ee1957fdf30c5a331f7335bf113e215c0a4c9f89099b94ce74ed76e380ecc7cea221d8bcd961cd014762f9d12049d4288f585249c9536ca8abbc2b6ea63afd9bdee0aff6ee91a2f31ca82aaa778159fa8b9bd5e72268bf89afee45494653de7764948b9b877fab124b3b66cc4ff7fb56ba4140936514436aedd2cdc34c032c5b3c385db4f8b658ed5027001d9084064de2f11bd10ef2e290e421d3f8fdd2d217dc6f5aba8d709b6b25c17c0a4825a1e3633005380f16f51614aa3a7bab5169cf840f272919a28a765ba5",
            "b157c87db6afc7a601bb1c7e371c33ccd8e03033c3f9914efdee0effaed1c4036c7193cabcd0c586d6d8f083a9491db61ff62998a2316c35df84997fcaa2e5e9e29c6c31b658d07da84023aaf13707e1e5d1136b78c379c60298e6f83fa6aa239a41195aab2e31b3fe5a7d9d16cc3874b1d9b6534e97002aed94bf1016c75bda",
            "1c4ce7cd53e939f970f7fe14f9c5b2f4a11f004d06f98e536832a8c612475af2032f3254b0b05dac10533a2106b6395b91bd41ace1d9dbb362394eaabd827ec62739f3b1a2d497d0053b8929c7f8a25a6dd0c16c8fdb5d7a9ca9561d37899f8a1b0240075fb99e73be0556607795fd8df71d1ec3ecd758c339b1e1ff5658999e09698c6e31ca49d76bccd4412d7b6f74306b6e4c3a8a2df0d4b5f7bfd9f5fa430fa156102dc4b75b8d3a8b5a42f5489266d7ef21682f4cd51a60e756a1e5aceed3468c00a2369dcc45fef29948da54811cd4b30b6c9205d1fa2455fa6941a53e64157432feb6d7de4dec690e7a534770a482db4d9fcbfd52d7345a2e7a32812e6516116ff9f6d487e418c15581aaf765c91010f650cb19ebca57718cf5b5cd03cc027a875c3d65509da3e2069559290ace290e6b68353d8e67167fc0cb3830d9bb6b10d01712e31450e2bc066b5e269566ce4c8ec2b89c77883d29e6ab69a61af6ba1dc4be8e27755bb01ac9eeaef7755265ee1c997f13fc41b404d85022e439",
            TestName = "ANS X931 Sign - 3072 - SHA-512"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t224, 3072,
            "459f579635047ebd9997d80554312c25ab5697de4306b2647c95accf47d4dc57c2c6a42f5be9ff9d8b47eada866e76abf3a7988d905366f368f2c586c6ae8d47a47e7dc9d77fe8071b639e2d96b6dc78b76f46f745079eb79000d0bf8c86fff0ab9cea65e18a64132c31e225a5630ee07977878007d972fd5343ce67942bee0e85180379e8afae714c7499b519930f7c3912d39881e894ef45034abf026e54b0a7ee9bd6c1a0c519251c3891a45e853a82a20da93e9c48c681e7c3ec36f8697d840df55c640c91ae0e5c370e58bebfc8ca1a6e5d68f89552f9796e7aabf654a19021fac9def39a062994439041027b8a2a89557c7ab35cde2d4f1bdcdc21ab0f93bd522177179974f1ec1a48d8da0fff7801bb65548c781a8f98fbcef306a547616c91c18f2f8250386e44d91d7736b36a44f16bed3b8d4cf43e286f7cbb6a7fe823eccad53821e2bc37c221f81d06dc80d70914bb6d8f8ecfcb5eaffaa5ae706fc9d1f5c005003ff357e5ffd0c948a234e11ae3cce2674e7002e38f1cca86a9",
            "8ef6f9be7640b12683c3062a36fb034d9685be9b9baa2fdb296d3ea9117bd680e96cb656ed0c78b510941ea4f92e7536335ed8344f916cbc61fc785078ff95328fb084b1918d80f70d10eb8fa15c2d010edad2d846d408337a071b3fd1c1eb6f17d9ea38e9d52da07c9ace95da25789b8f79f7d2edfc69f15a17bd73997739b07ab8bf0fb087d82bd4fa43b61c41ffade40f89f656d8bc009730411da46f5abd2a0e7d6443339b98bd519479532298e63277bdc6648395c392b06b8f15ca9840970d6560520ef3ca1c21ccc4300faa9a8060fa2a0e4499eb2eee3721a31a9d5502fd1d2dfb58c07eb7d2c51540624c373cdb54b9ad8fb79bfe25b36bf02c702ea5c1cc6d29eddcceae549a88d4596e7a3871529e427a2b26a898b60b584f2b62a2ba6967c08a44556bf420d2b6c822f3422ea1c52dfc30ff309e6ba383f49a2b5a80eec5c09fef308b06ba8f84a11324aa6debcbd77889dd0368eeb0981790cfacea12bcba13f9dd41e58db11c1d8dea6df146ed5c277232e697175687de1d29",
            "eb94dc2cf1f69b7d9488af2050ab861a2233357ee26a6a92d357a22d79409c63aa6d0d64e82f95a2ee21f23289ae7475a9d3b0f7b82679972a180ce956778bd88437ad904771b39b0dac9e49f45c9f56dfa8cfc7ca7020155a8f938db85dacf7a0782476b5c5ddaf18b11b2d38bdf004ec39f8b5bf4f47528a44a0e349fbe707",
            "28c98b48fb6102e3ae7fcd78700a6b2b05af606a6911502bca653f3ac909e7a3b60d73e34fdaa2d77cd5a0a1eb1ce4012da6a480d8ff1c674b436842922fcf5bc662c14950a859bf9ba68af88e16bba9baad26fa8cc0af74335ce6281ed30e5b5021a975e5b831c1f8c77a224a5a7201380f4ce158bfe6ac7602570b08a9f197101414da5e15501656a05e273b6d32046febca5fe536e3b0680fa021b4ac423e624a806016ab7b30ec374fbbd55c912fba403eb4785c45136dd5bcb82241860dae75b37a2b241a44b62fac5dfd1f3210e824ff7dece28453020dc311bef6e8b849c1ebc6fe97a8f6a1daa61748de503766fc0b4ea8a7fc8569ee84e11243d4226077abc6f7cb198db9477752ed9eed9c9a43f8ce3d5c787718dbbe2b6a7772f8c1185f05cfd98bf74e224ef419114b77f6d4f87fcea8230df57cf2bbf64e6913872b795626ba77866eddae0aa345472c3004b9fab95539e9942bb523358d938008beb0a1d27580aea89c9c5ef3cd225e4695dfef8e442229fee088b9b757f7a4",
            TestName = "ANS X931 Sign - 3072 - SHA-512/224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t256, 3072,
            "459f579635047ebd9997d80554312c25ab5697de4306b2647c95accf47d4dc57c2c6a42f5be9ff9d8b47eada866e76abf3a7988d905366f368f2c586c6ae8d47a47e7dc9d77fe8071b639e2d96b6dc78b76f46f745079eb79000d0bf8c86fff0ab9cea65e18a64132c31e225a5630ee07977878007d972fd5343ce67942bee0e85180379e8afae714c7499b519930f7c3912d39881e894ef45034abf026e54b0a7ee9bd6c1a0c519251c3891a45e853a82a20da93e9c48c681e7c3ec36f8697d840df55c640c91ae0e5c370e58bebfc8ca1a6e5d68f89552f9796e7aabf654a19021fac9def39a062994439041027b8a2a89557c7ab35cde2d4f1bdcdc21ab0f93bd522177179974f1ec1a48d8da0fff7801bb65548c781a8f98fbcef306a547616c91c18f2f8250386e44d91d7736b36a44f16bed3b8d4cf43e286f7cbb6a7fe823eccad53821e2bc37c221f81d06dc80d70914bb6d8f8ecfcb5eaffaa5ae706fc9d1f5c005003ff357e5ffd0c948a234e11ae3cce2674e7002e38f1cca86a9",
            "8ef6f9be7640b12683c3062a36fb034d9685be9b9baa2fdb296d3ea9117bd680e96cb656ed0c78b510941ea4f92e7536335ed8344f916cbc61fc785078ff95328fb084b1918d80f70d10eb8fa15c2d010edad2d846d408337a071b3fd1c1eb6f17d9ea38e9d52da07c9ace95da25789b8f79f7d2edfc69f15a17bd73997739b07ab8bf0fb087d82bd4fa43b61c41ffade40f89f656d8bc009730411da46f5abd2a0e7d6443339b98bd519479532298e63277bdc6648395c392b06b8f15ca9840970d6560520ef3ca1c21ccc4300faa9a8060fa2a0e4499eb2eee3721a31a9d5502fd1d2dfb58c07eb7d2c51540624c373cdb54b9ad8fb79bfe25b36bf02c702ea5c1cc6d29eddcceae549a88d4596e7a3871529e427a2b26a898b60b584f2b62a2ba6967c08a44556bf420d2b6c822f3422ea1c52dfc30ff309e6ba383f49a2b5a80eec5c09fef308b06ba8f84a11324aa6debcbd77889dd0368eeb0981790cfacea12bcba13f9dd41e58db11c1d8dea6df146ed5c277232e697175687de1d29",
            "17ddaa94d739028d28d0e1463d18b5058eb85ac57d9ae1e63a429024e45f29c6f1a07017cfc9e71acb06dc7a337fa5c0b72c2bc815eba576f6d0a6a512bc5a609b310c55d964ec8612941042ac9bb85495c3d67ae3dace19b8897a2e69e17188df3789353d329a3ac2228587f2937529f02365c22f90e336491513a82ff7f6a5",
            "02b6fdf2a8cc1741f94ce46cb0eb8a41ae8d214ff48771c716069c5b152e402d44e249d4e64875e768e87dda782d92197b32c0bdbbfa0b0a6a5d8514dd20edc4e02d5258572adff5d614a0955dd11931c1aaead4944dbb9caff52536a595760d454c327714eac3b025b9e07a67e9f4bfff863911d0bcea855bec64894bcfe82322df14aebb57e39235d781a22762051009dc24b49ddcc51baaa167e20cfcc5aef4d7018b58142fe0830009ba062d14116477b48b7e9e9e414c1e5737994222b229d321b37b3d07aac99158caf4ac06f8d957d0fe4f6e821e94146a918ee0093d65ab5adff6253ffa4b3171e1b56aa8b065ddd6512b3ecb3fda3a1e6f9d384407d7d1a0fdff58b69e4a290ca3efc1e2d8a348d097fb7f8441ca9bc7424e26df5f67a70b6676d15663c7fefbac96f4f706fb8578ef968c4c4f35c3b66cba0877cf630b2ed7990f61a39d1a15ed992bb82c746992456d337d703199ac89117a6e9f49d1d5de205c5a453f8c6cfbd7d653e562402cb56384bf5c86bd4af392e696f9",
            TestName = "ANS X931 Sign - 3072 - SHA-512/256"
        )]
        #endregion SignTests
        public void ShouldSignCorrectly(ModeValues mode, DigestSizes dig, int nlen, string dHex, string nHex, string msgHex, string sigHex)
        {
            var shaFactory = new ShaFactory();
            var sha = shaFactory.GetShaInstance(new HashFunction(mode, dig));
            var signatureBuilder = new SignatureBuilder();
            var ansxPaddingScheme = new AnsxPadder(sha);

            var msg = new BitString(msgHex);
            var d = new BitString(dHex).ToPositiveBigInteger();
            var n = new BitString(nHex).ToPositiveBigInteger();
            var pubKey = new PublicKey {N = n};
            var privKey = new PrivateKey {D = d};
            var rsa = new Rsa(new RsaVisitor());

            var result = signatureBuilder
                .WithMessage(msg)
                .WithPublicKey(pubKey)
                .WithPrivateKey(privKey)
                .WithDecryptionScheme(rsa)
                .WithPaddingScheme(ansxPaddingScheme)
                .BuildSign();

            Assert.IsTrue(result.Success, result.ErrorMessage);

            var expectedSig = new BitString(sigHex).ToPositiveBigInteger();
            Assert.AreEqual(expectedSig, result.Signature);
        }

        [Test]
        #region VerifyTests
        [TestCase(ModeValues.SHA1, DigestSizes.d160, 1024,
            "027835",
            "b9ae6c5b00174f664f9667485d6fa496a8ccdb51d1749ed9de51b50470f85240da701166a8e613762878e0ef66f263a7622d987363c0f79b841406e3a80f366bd84cce138e166e3b9905ce517d0a3cdd2b103050941ea8aabfc38ae27a0c9e8d6f86ab49860d14d52c824fe656899bd44b85dce8cb0d6a420a009b4c9d727f57",
            "679b570e5a93421622d2fbc4ca0cf9068e58864c3634b8a5a3c9a224a871cb891b77e01d2b1ea5def3e431dc50075be3f049705aacf0276b1812d665580fe55e355f831c708e99365584fc76940ae7824d8aa8bb6a16996631ac520a19b91d18dddbabd1d0eb0565703bc4583d1c852acca4983717aef8dc172180db95765b01",
            "2cf8dbdb6b0e44f8398aae45573e84632baff3884c1c71a7da0fc510a1cafa16997ff0cf7196177d079f39b38c29550b89db1e8ff9222e26dbe11290280b92f7b4ccf3cb352ed11fc230db6f1a20bac1507b521f196827864645b246ef0b0a24f24203af798ca08f473b635705ba9f5c58401fe9a156d4ed493abd9b26c6e18d",
            TestName = "ANS X931 Verify - 1024 - SHA-1"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d224, 1024,
            "4bb667",
            "b96161144113e5062849eb1a50f5a1f6f42014eb5671b52b874d959b598e1bf33b29e21310ddf1f5a8e12eeebf90e670455db390bfcd1be3085a3ce40ad523b1d09d5be7dd3de1cca3c95349d822ece1e31719bbcf93ddcb71d4ce194ad00afa15f2623bc11f8ed2c43602d5b156de8b04cca57018e056745152a0e0a7f716db",
            "d6001025482e3ebb6d4b7f6463ce07dc0dddee28675927c1161ab1f4447c1189aa1affa3eed960e7302974e0e08751a2d24690ae94904616ffa836e20c7144b1e9342da44c9e76770808a2f1defca87f95f4a41c4c64cd7310fba748aa267a14bad702ef0a8468b31c72715f0533f6b97e6e943839dea420719d6defc5a399f8",
            "3c9ac387272f9d0d7b54e68bf73b4c4495e5a0f6f7415dd6809e1df01f1b371bd4b104900910603ef61e6ef3c51cbfdfa9a28fdce38ea42355c7c21f2eb83bd86eed2df179c934a1bd34a778bdb9694490bab2c8cc10e3ace3bbf609f9313cbc430a0d20a53a3da859d4ee91cbd02ded94f05defeefc653147e9dc92080890f5",
            TestName = "ANS X931 Verify - 1024 - SHA-224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 1024,
            "20c097",
            "d47fda2f9140124468c8b402f36511a42e6547c6437666d0a8f6f36560ccf93ae20b1f14f6ef51e31806b509acd7cf5486f3c219fa0374723b9f48d9e6bd750ffa91fc4ae1e8904047ae2fe69666807f992056f46ce6bbdc45d142bcc09742ce9b377de2ed9e674c9374a968d8f5b7844d41dad6603c0290fe8b22fc7bb0729f",
            "7a161c26a58638d2e6312b5c60c0cccf3ebf463e99f31ab69bed6371e5df5e4c2faf297b2e4acb7cbb3b7549317c08d2178bd6aaffc1ad01ade012d27cebca5dfe3a9fd8e3cd60621ce12a3840c1e62b2edf1352f423c6fcef83eee834d4ddb92fdf04a48ab8fe6c504bd190533870c3cbe1849c3fc06b8fa9ff811cd5429f46",
            "5941c6ba35d36bfbd02289bdf1804571a1fb47816501c5ad771b21adc6af691503dc09e338777e0f440ebfb08c684c83cbd592fee41b0b1aea5554126c9c23517008eb58314d7445c48235f9f8987608c83d5fc9224efde27037ea550126c9591509b5cc19f8e1cdee1b78dcda90ecf3e69d927b2f8892c1064b99451a4ba1b1",
            TestName = "ANS X931 Verify - 1024 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 1024,
            "911a61",
            "c2d4b973892a1857975fb5a6b02480fa3dcc4c1005463f0a8d5c9045de9cf08943d91fb651996cb228234acb0160c65c243461f1ca3bba86113691441fe8bbba3be1f3d0a64317e9660df3005cf3c5590ac5c98dbd02e36e9ceb4ab8862b34c08236c70ee661df8dab098cf77dbd91460d2b1ce4c59a02e836ee7f494f9e4605",
            "43d137411f82980b41e265160235e95a0fc64e201acefb09cf9820530ae38e584788cd575a5c687760588c09f5f7d10ea7e058f9abc516b6cf8b6feab0ab077d2dd8d5561be279653adacfe76877c4e515b868fef7cb4567ff2ef0308b14ddc9dd0a77c4ccda70dcb9af5637c57b68e84196a7b867a8302647c8c8ac03e5b944",
            "17a7a3a26967722db6ab68a4e90e5463a054034db00adbb1f9e2503a6155b173f76f3c77723909ed0370feaa2efe3d839c7f86a0b7353ad6bec7dc51deecdcb63d2f754b5edccc085336406a2fbfa36d02a05637d982aecccfd30d81dd7955da5d79bbb180649e0ef50fe15255d4e9964f5591f4bd9e112cc1287b355edf5b2e",
            TestName = "ANS X931 Verify - 1024 - SHA-384"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 1024,
            "80721d",
            "9f43ca3db677518f5260a0b2019ace13663a1277a847827bb3485cecad980667d1c7cdf960d410fad51c07aca96a3e924488764358f7df06564d4a8b7057220b177a9042184b1d7422e377e61337574f0f044089fb5f800625337c42506a207d2ddb31526474c3110d397bf43dfd8ae261194caea2b8184405fda0bd8dae460d",
            "defd489f62770ef3b8be9f52a515803d781e1c84914d675c209cc2b12f801fbee31c65dafeb51695a9672f0371164f588fa71cb56c6fe24264eb7e7dcab27bd22da97a6bda76d749a2378994de734a2fb050f9908b073ccff59669fc8bb5a7b6460a50f9fea09a382c9677acf414b9eb63837abcf5febb2a5a034bd7796feb93",
            "27768eb5da8469c5eb2f0e3395ab3e4545a1a16eabc81ca1698312a16d07ded5762bee798523cf9d37f5b321dfb25c8f2ba1f8db4283cbdbd8f3bca434d6d55a303102da49ccac15bf211cb0a3c7e51083143b184a0289f0ee8d55426291e9e1781db90c0828235e4263abd413d1957e6d5d76311f02ef528e712caee59656a5",
            TestName = "ANS X931 Verify - 1024 - SHA-512"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t224, 1024,
            "ad84a9",
            "9b4441c446b0661a910fc62c4f7f1701e2cb8ea7f005d560219cd69c11e046c9f4f01ab6e756b454f650160ced825d3e7878144566c13c19a75b19693476f9d34ba07eb2f178be6505f310a9d959f61029e7d172749c3c617f9e05f95ab1b014ca540e2ef458ecd281d9965328c7edd1fea5ea3b66752461e8b675cd52f4f3bb",
            "0d910c34e391c90a76d5401a2d3caa44b8c5d5aef3e928b90d2ee233e9f9a2cec4a32cd019d06a0dc1fcb1125f5746a4fbd32169ed7bf0e4fd065fa7c8ac97c366380484495f5c5b6850dd1c9d8cd6694cf8686e46308ed0ed1f5bdf98cd831339771db63de5a7deb3f84b9eb183607df35b3427c6b2096324a05d4521036fa5",
            "13b6949b57a34e1d8006c35053c636fcbdef91b9c875d0858045345b3502fd0af4f8eb248a4ba46e8e8101075f443c6249fc49a6ba198dc70e6461bda917186d8149585d17441cd051da4207d13584bd81d796b4d533c4307b77d095f4bcc756228ae2f227643466783fda37b4c04d12d314a8cf1cd97969658af8c18f548690",
            TestName = "ANS X931 Verify - 1024 - SHA-512/224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t256, 1024,
            "476f9f",
            "c2635be22955f2b1f104377750e3a289092ba24863985e85b87b38c10423a649293856233512e784f5f484bdbf11a2aa4809a3a7fe137f635384b9d10f05e632774c93edd3478918a55697bdb327fc911d85680c4ac9d7ed229c7912ab782fdc37bf62973326610d49eb773ea6641f414b851b8dfd3d2109e6f61a305434e755",
            "274d29a04b89c130cf9cebcbf19defec4f8474e7faed3bcecd190d96fd36f276f0e0a49053e743d367534a209ba5c2ab6060b6a539c8e61811eabf12d2dc8b053346e66ed22171b582bfca54e60cbb3c3f13b17482c47004aef406115ca5fd499788d582efc0b29dc9e951b1f959406693a54f9efd67425b493fc8ddc218b10a",
            "57c3d8f620830134a1748c356c0e12c70779db921923f726f266f93cebad6c1f7574863d171d3058fae43f90da793156bf081d8c3f8c54560dbe2a96b8268934561dd0a586b2a7b436ab4dd91a428e076b1c36ee4f237f571143c2911486f66092bbf8bc13ba5a202629f0bdcf4b0fdb644d630fc972507b46d9d92143757144",
            TestName = "ANS X931 Verify - 1024 - SHA-512/256"
        )]
        [TestCase(ModeValues.SHA1, DigestSizes.d160, 2048,
            "201393",
            "b7efe30b7eb18f2f4e4b26bd956a335276c6a888ce9b16a448fec5d73eb631987d7c8fe9a6b4b1f768fca20ed4a1d92e14ec4c98207c218d9eb83e0a4f6cc87aedb1fa8e9417b0906dda43b591595a1b0cc74d538cb2d851a1d04e9862256418e27115022b91da32a7fa347d29a2f60b46518e0f65987e6a64b98696b35c8eebcbb813eb7178b2a2f093ee9f20357667bff8d2f40ff242900cb436caad336e67af1abbc92fde13ec3bb7834cc7ea723a2e49f4bdf785cc4a4d54b2ca46f0511e94b8708367d5b3b465b063cf6c4d6f0661f2aa0d7c798747b1eee64df3c5245a71212a14457c9f636b2039953514abbc865f07221e695a23333c676417cb18df",
            "11df06d0e2cd5bb5cb89fa9b0e2441ba1137f80cf82483b0799e5c8dec6cc137a269aa1678d0fec5acb606b8efd82222bb97bb15e64178eb7892b5e6ba7b31138f2106740729df5d3233651f32a4fae494a9aadae1795e946fda53ad7de6cbae7f0f0331b76164470507fd18001131c94574ada310529e71097c20296036f9cf",
            "5a31c028b18d605ac75cd0101148761c0a0b5ae3410432cd69698b9d593ceeddf07b0f4402299670e862d5827521b54f335c4b14a11b9edcbce9cd9bbac41817aec8b1090e9c4d3f3c2932f65ed11a968f9d089d3515ec847812ebc6dba540d30293297439dd600f72ab107697c32ffd5913344c30ce19b7c08193bb3846edc40d97543e748c5f5e8d66778ef474f25177221126d3baf76c066a0911c8b160d6bacb46b5a5593c6d5355b9ef0dca6d27e3da1923e0b8f6f858876c35bfc2df02076b80c09208f25e5c2a963c84270d6777d504013ef682344c435c8f0410dc3a9937a586e7b3fbf1f8c821a6f548c072927d6afeb3dbb962ba29921d0fe6823c",
            TestName = "ANS X931 Verify - 2048 - SHA-1"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d224, 2048,
            "74d8bd",
            "be5510446eafa406aa7d90a505bc9a5932f75a3edb2accd18f2e09996bae592b87fc632d1fadeaa41012dcb720331fe461814c94bcd7cb8d1db528061edd693955a18173658912714581c89f2ffc7baa544764270a5e3915a6d1e3520b5080127d520187d7d954fd35a019c467b115f95814dd25c0bff58b4c0ab4ca59971ed81746fd27ea41a761f1c0230329bd1812edf66b04230c4183e92cf89578343ce2889ac1fa4642a67b2862596926fa42f2445a6be498d534a659e5031dd6e96a647c44edf1c713a65fa1710e294af4f323e258f2559f0f678770da33d716d62c05a8c7af3edc19268ed65924b11323f06dbc7b8cd3b3e231af553cf73ae75b9c9d",
            "796d05d4d2088893007c73381b4fc716361f3b55ede3754f3d73803a994b7b08398b8e8bb64323ddd4ee52ff9e3c9cc0b915dde0f2da7c7619eee58f12753918295b43fea698af93a1b3763418859d293f401fcc17b028ed42c08376163f564bf0e40d74cb90947e11d4c91eb0b3311871a9e95f86ece07e61f14436cd323a69",
            "112c1f08660dd984ac27beac29526b2c7606c2dd6cc1dd487eb56f7dc042be692b32c31988a29eab0165be7495a0b2f1ead36632b47dc05c628398ec753340501914b613089f1125ec41e5c3498407104e4ced7f3dd6f29da5603c944bfa256c7e5da36292d57ba806ca479295986a86fc800519fce053ee4967a309789fb53d5857a1abc6b3c3ffe75fa0fcfc944a498b580f77744ba3b266209283579410f8a5e9c073878589db1db4c2aceee327f919dc146876b0cc7875e6b61d170fd085fdee47a20de7241eae6e28cc7de16b4fb5866e79896c8512568cc9928058236d27520eaa12ebad38f19a0021e671d9182c7693a0b1b53acf2cd9be7448dfd9fe",
            TestName = "ANS X931 Verify - 2048 - SHA-224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 2048,
            "e402eb",
            "98b41966f6588854e286721c50ed5ed9027a1ba2fd26ca009df68d873247381945a4c9d4585eaee2baa6c16a6804bba86f0bcd5941a48530f8fd1aded539255f7f2374f5b94eff9c339a0daeaf6ee66ad4b9ab84bfc0c41bcdfb950a8f035cfe3859c994cef29c7053346ed42450b0d0db4582057719ef320a27d92b3aaae16976e0bbaef8b569c3234a78d508839288994982c618a87922b8bc5f00eb0d117e815dd39c63c9838d3ddc01d38302a1e6c4deac13524c8645fa2b86fbde57d52277125f2d69137e52ff41f16a82e74614aef48e7fa3e9183de546206af7fc00ba73b1deb4aff958f672cbdbd72605bb84f4442cc2f8fa1bcd6ea340c2a39482f5",
            "0a9d6ed0d731084202697012ba0a6dbe1131b7eaaf365160c3d5185540909dee454f3002dc4a3d22e828dcd65968a32aa201be696d4542298d0bbf87340d15b4668f88b1ad4216560f6707993d37c70d0d83f1a92a98accb0a653a7c21e0cef655a59e64b1e03ae85d6e1ce2ce3f80703aff76314ff5354f242bb2bc70cf71bb",
            "281e0d2edec929dcd6a1831b065236c5e269c2ffe72572434966cdc1e9f0f256ea4cb73df80c81d7ab77e122d0a5e152668e40ae44adc58003c3399d6c82f09da2704e9fd6866711017c4f72d23f123bf6a22ff8dab89e0c5fc7408802b178cdd23511e0adfb50c63cd4f401475b412428a3b1c1571b9cb5e400b357ba40e5c29f9301ee54a561434f6e857830e1650be68fab5f5832b41107392f80b7ceb70f8296c9bd7cf3823604c1d744583089cf58eed943ed10bf2cecb7e3dfab9316cfefc4181f76e9f349c5114903586918dd0fc0c8bc5d617e137cfe70da9f7f79cdd4387999a642a4c415089267752e12103592433a3b4216c3d443b602a3524012",
            TestName = "ANS X931 Verify - 2048 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 2048,
            "161c47",
            "ee4e7f8cbd2b5d3d2e81559fc01e10eca47d1cfd60c58fe1c888eed09fe3d0ff1de93680ea56a16fa35bb9acfddcf895cbed25f107a2d02f58bad3f23adde09a4086232cda4a3159278b6791efe8160a90e5238e2c135c92e2f959a841a39ee929e630bb09323108b65b86053ff7224e7f330665626e5225a75d2a31ec3daef0326ba48ecc33bef80ce1fc327cef800a7c35332c286298fff9980b4c1bd882c61faed76337c4b461227527ec9a34fb5515b5e605cb3672a1d860beed7a92bad3446e48e846c32040b668c8732927bf0e3aa112c2227a3cf57b49d3ea62dac7770857b41bba049d9f24724b7acfad748347b2c03e717320b0358c1f6ef532a371",
            "8b628f618e0caee6908cd8a6d95bb576769de64330489756bf8758d63a61288fd296d3f1c0c97f5c7ce4819b30b975ae6ce58dcc1bfa29a8b6dda8f4b76c7e23516487745e829c2c99e963220dc46b81cd2c78cae64c1b1892c386a8ae499f986e9653ef50802dde4e63274658c5c079013a4e457986962fbb029afc0741b276",
            "5d9cfa9703c3208b0c5e19191f80855510f2ab5e4d9270e216d8e6022f9d10b0fa1f207017d1c3deadb90364b5cb3560c4780bd12a53a5c29ff535b77c1ab0a964fbc4f74a6d3f436cfbbe5ac8c97589ddfe01060623559159ed3e2b768cc1ab724875bc2d9bea081c4a53a52de41f84111cf65313f5da5453bf5860ac78f206222a6c78eb905754bda15858650be0fd547eafb3378bf1ed17f84173675c607ae32078dc1b2ea4ccb14a7a15e0ca2ca0ee0d8ee9ab8881892d2c470998947e5a6c3a412ba280ece8eb3a6a5d9f457256454cb1e3dcd657667d145e7bcd3c418382a3818c827b518c8a7e5e1c52c948a8713c7ce646ffe94dfb24671851583b75",
            TestName = "ANS X931 Verify - 2048 - SHA-384"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 2048,
            "26b5a1",
            "eb78cc281aa650a9f16e9b8d35191fc16e52d1bf0809fe33389738745ecf6cdc14603785907ca104fa526648904f939130545e935edd1edceb9aaea43ef16f7e4b5da36ed42a585d678fdcb1383f0582c077413a94739c9ec5bd02ebd235de5bc244017e381a1b258d7b7bf47b7b0eb1571d6611c6d32d4b284a564b40d08600ce66c77892ecc0c85eb83325aea854a1f32c978eebc8a813c7f7a4a2321c5cbc1224dc124ffb6334e590d24c357949ffeb9c7b560307084bd7b298c6f34f3cf95f2ef7269d99f68106f4a8c7cfa0daa16cfa07bfee7fe3a5370e194a2397867c72ca660b7df6876de4d0b58523d14bbf49c83c974e1d65e70d6946eb349b341b",
            "7bab1695c55c92ab1ebe6680ebafc802b5a8189b879569ab98e33c352ada8ed9b22d160239cfc86002099d996dca963b1b3efff653a1f108a5561af8cd33c087da2004e48fe0641f092e84e0a20c2e5916589779e4a0e462f737ec1e8688408d39ab69a28d3670cf7956a4be521e9742ec1e6a8d02384aa3d7af3b0f1e8114d4",
            "6fe7cbe281b292811705eb4e227ea0dfafea1c67e7e2e97cfc4a419e2a4758da7fc212c0d10aa887426e0103f17c15b90acbe025f5d6ac5cc042c3ee80c296d3efdba21c2027bb47170ccb83c23a691f4633915df72051d7eb768fbaa186b3b9bb68c8c998a7dc70f50039c0ef29e63e87b46e900668f46b7c671d2252575854c3bbaa96f4c0bece0e302d5761a0bffe4eed03619468dbf160c8b84d9ef3a4ff598c9a5271899452e2e1e47e9262e9afae4125fab43c3b83792dcd060f90eed6ffec3142a127b41e349586653a51abb9a5e81eda254193260f366baf2d6304076c682eea2e7592a85e3975834063da6273a04f1811b17028617dc03b7283502e",
            TestName = "ANS X931 Verify - 2048 - SHA-512"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t224, 2048,
            "a61a11",
            "98d98218fa8cef0a10bd900e73448c643b5e7888906dab4d033d3ac30d813ce0e725130b83d7f9449880e843aae5c9b17cead40506a4bf015caf29bbc7ea6f07ce099efb9f2988e3530e6a64c88c305313d8ab6fee599f2df01000b52615ca2c8d967b0d215b12ebb09c2c538d1ee36f8e43fdf5e56e10b400557723d20bd7648f565be4e715b36aa2de227a7755461851328950d4c6a0008b8c54fef72050b23ae57ed86056db0d8a65a3fc1de7cdaa1b6402ac8977c0fde5cc582e8a5c9a21ee30b54979b457fb1ddacc54e4f19bd0134e67cdf23508b54676d46a1bb44dc17c3b1bf7c87dfd952fcccc0a78b2b499b3b973e0538cb575ff7e435b5688e535",
            "982061851562ae9b13e1065eb28f9cfcf3b89bc96ce8753f410a77434fcda2aaaa4cb6fc4aed8f780189b458b0ce2e56bbe2966eba4972e67209c28c030cd53f62c561b00a17d36aef72e410b43f6de61d7e7c93c7ada72617eca05670600a0ea9d58b29bea7237ac5e2bc0f24a802b602d374c1fbdcbb0718fc3b2bfe90e921",
            "3a27bf67a8bbe3521ec88304f05f32eb2f9b6d76cba2f4bbe0d41100e3d81a770d8a13155558a90aca7ea0744d548f6f14a4aa610c41106d037b807b6111bc4c7173cf694cdb6238d5b9cf466a08b75d098a3752b731c17789d864c1f162823aed54957faeb428e2f7afb0e4c26771e399c61cebc933c13a4dafdad9538d9d8428030b64a9753c06fafb14077eacda5319a923b424e3f964a30804643ac36071b67f76636b40171a22843257c34b9be257fda88ae9f0a06947ec1420ae2e076dbb6f16f390b9e9c7655ae8bcc16bf046976c2f82bca3f68d85d040c55089bbd4e7cedbeeaa20d26044cb53b73f0dc2f4f812802a2bd4a5be8c1bcd1d1717a41a",
            TestName = "ANS X931 Verify - 2048 - SHA-512/224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t256, 2048,
            "1f7e47",
            "9ef6e8e1c0a6e27b2892814910f00b85604d27c55342d7f2c8630bcc0676423d60ca8263595fffddde4df74010fadac96da7db855347b494b9b1c188fcb809d6050b65f09b5e1ff92c4afb291911bd3f153e754528554e20c8461f77286edd8bd1e5bbe0d3ad01a1ff36b60b8f8f25a02161aaca753001fc44460fe421462f893f1b172f22b459bf82f4bc8243a697c677906b3358c514589a1a74e50e8fcd182e04f5a78bf8d82a720652a53127aa445d401857e713cb1f43a302b6b8a1ec7c7062b80e664213a125199f6836d60d9b5d89bad3ffe4bea6b33d32c4eb07d569ba3836b28fac78b14f0e14b526b790c5615e11dedc08789a659b044fcd28ed5f",
            "0b861cfb6b2161282e3e1b0e8755ac0f9d011ab1320fcb5083d48d1070c4da16dd4159f858b1a771fcd3585a955339d5059cd8cce6ed479a70af1c079d06bc7a8ca6da6a23e83a16f91cbb76732194712d34de509b065373f01155423e2b3267df5ca63b15eda17dedc14b4a69e94549dd7232279a817743caa33eaa9b5ec145",
            "4d7e534071cbeedc2e6a81d51b46971e447164780a252f2d28fe0fa8a06bf44720f7b12d5a5eb91214b38a8ab78b78554c1e9d838d36491ea4f55d2d38c800b3a44fb4cfdc8137ca9dab7bc871a95ece410f8ad791321c73030d550b30707dcfe64ed2cd10e64ee5c69a39396cd6eb04c3ec7618c320e2ce72015caf27b2118326f6f7dcecdf11844f5cdf5361e03e1de6d2f36ad6e9d817acf09b6b74a671b7dbf276e753e0433e172823088a34c4790d750b20ae43a37a2b1579e3314b585105e8272a7ba8a8df2592910df8177e81ac844b55d4baca0442831934fe9f53efb83eb5f14e60b6cab7fbb5fa232826e96c4dd537a8d3c8c79acb91d93d7fe151",
            TestName = "ANS X931 Verify - 2048 - SHA-512/256"
        )]
        [TestCase(ModeValues.SHA1, DigestSizes.d160, 3072,
            "2d3117",
            "de0ccca5ed381a461d1df54226075a73974565204875cf94b88b15d753f3beb4a94303e6a02e6df2bb550e55230b7ea94fe2249cd54c77989dabc5875e4fd58b58423d940a8cb90126a984ec03c5b07dbacee1fec416ff392f51daf1afc8ab28f9a6a47f194d9ea838f073c85487b1bcf1d195b667903acd46d0462bf8da732389fedc30abf50932fda33cf880722a6869d258c8904c0cfcdbebd4dcd6f6d24bc866e1e90b2d95988ae53891ff5109084e2073f1596afadf3f071dd6cd05765361b8e6eb0770950c8381441e4d64891098f7c8ba5fb8abd5ad6db08e8dc0e2c02b09e3a4bde93c2cb1ff5b2f728b339cba1749f255a4bf1a06e6dbb8d97924e153f46efd097d1a08e26fd98953edc064400d8e809268724face03548aa8ba5db43201ccab64de79f47522a40ac0f0082d53587508ebd07fc81768031883b5d9b2db09dc32686e970d52427b30bec3360a73c9d5e560b8ae2e52a2a081bc3012f6c464e55087f49e1a0e4a51a13301034c0643eb14d670d53eb1aa64ebb3f4723",
            "3269b2c0ca3e9818e2d09354e1fdd66f23b8561ae75fcdb16948056d4b9e53db396b618dcdf5310fb04e5f1c0327a712fde5a6a4d5f7e5cfe266130f01ad92d237cc362d979849ce6655d2327e861618f0046035ed4efe29e7208cb2f347751f72b3b608f0cee53d4c0c72fc19c32e67453e0934f80d20a7bf9ef7bdea1202ab",
            "22ccb4b39d0735f2916d9f650f8c2a9ccb85439695ad574815cb411f2fa8dcaaf5ef5228dae3dfbad1720428af4e7f924efc1def7c845097b07cc89d3fdcb33bdc1d6cc854cd1d3a996402fc278b5a770a8e53e625562d2b0ba88904b66527d4ecbbb838b18791803832d43acd04b750fea9f4955b021398ee5f708718134c4532006fa61836c2892e4aa4c68c099e3d50a80343000d63f2524e4e9eec878e3ce46941c11f769b6bf562bbb560ba270a7288be3246035d4b365c2e4cd832d7dfe3703d3dd44187a8a2739d7c54a381cffe60fa0cab2933dc62c9c085c780ae84b9b030b7f0c20faed25092df742cc100a877c9f88f59e10591d52f57ac5bc56a9c7c7b495634000035419c458c127ff464061f6ed1e5ab39d5a4ec7c0b8d52ce0c1a1a39a39641a8aa97ac6a232f71b39723f06c11ee27df8e2f4b4118dcd6594e751cbb9899aaa6c66a403ccab905503f1d0765bacb6db90e792bdffe744dfb541166221091404f0c0dfba32d8eb222a37365dfbdf9b1ba08f945b61d9fa1c7",
            TestName = "ANS X931 Verify - 3072 - SHA-1"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d224, 3072,
            "a565ad",
            "eac1e7a1a407812d43f36a6fe54dc9e7e632474685e53e34aab7049ebe51cf0b36034ae0e003459e7e8c9df7c969f510cb56c08b59317bd28255f68b1c1e453b9b0fe9fe245c0875d97febb64b1e89843e7d37bac873978ea1c8d44f4948433c9234697359b9bd9be3abdaa1f5466741d24c5c2ea800ab76a8e8dd7d2744366e5fe6e84382e0a3c0960917a1daf12cf4f8ff10079bacc1e4d12458a4299ff19d4b1c456589aa19ea11d0ff965d61bd37c318a84423f09ee3c73bc64cae552ef060a957bd76abee1276f4eecfe7a975e7a686625248097c3835f1b7ea0480b90b1d72e77bf930fd9fd335366ce1df350a8818d97cc4d0cec33d54369f99978b888b54ffdb23bfca8797120d55d57192b37dacd2d9573c209c406b54e46c2a49a80ebf9d989ec683f59f41397173fec97ef745bc78b2741e617405ec74c15c09f964a0212bbf40aee2af61229d00cc70c353ff0f88f2a73e95348bc751670cc30c192ef05c6e1b1bea97edb9d740fbf01954ffa8572afea655da04774a832904b1",
            "4da3c03acad4719996f0e62a578ea175459c2ee5ea0c062125cbb59975f3385f7441a939a2c91ef464e8cefb4d7b75289b4efad905d84f47b4259a138f139222bbc12bab6245758eb49dc1e82ce807e415d784d44c5ea78047af2ebd56688d42290b8fb893b03f108df609197e3f1d52ba1d14fd4807d674e851bbc0545bf068",
            "198863aec88054729ecf8a00d0a546b7863d64d10d5c3c01d51be4549e3006cf654510ea666cc32ec71338f7e27b0f0dc2688c009830280fa888d9b8a53a372eeb6b4dcc2e4fbd4547459c5219becd8bf0298ddce1e7fbdee7037f8d15e8031c69e01c00fa1870855f0f04586b3c7c5dc447e4e871d23330a8318abd19c573d5088ea677cf04775d2f84edb27e3efbe263b831c9cfd67bc248345fb6de597ffb1d8280c67e572497358fadf7d6e38232ff4e406e06ac3b92ead37e9bf9713c60cd0327b6012c0e3465e1fb0b7e5514a7c1b2a226e42b34f821541ce49944371688f590f717427c18ea6765ddb6b7f0a374aec61f558da0ed47ed9ed8c889bd8bf3e67adbecb2f07c36520ee57d1bc6be4d20eac9aeb77c1fc5821a72fc2cdf1a3de9473f67d20c3c9ff58d812ae74834630ad49d1085ce287a3a42a875e7ddc0d304df27ca1f3f1a0b4d99ff33f1237d9dd9635652a510b44d780b2a383f8ba7e48d7d1b275395e4be268fe196ea06910655e945be8ff58eb4d8c02454cfd91d",
            TestName = "ANS X931 Verify - 3072 - SHA-224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d256, 3072,
            "89ca09",
            "ab3c3b9b176bc55ea65f847ca68560624c76149711fbf8c3eb471d8008466cbac645c8ae551cf280cfa03c04d28ee15495bfb6d289cba0dfe8ade4fdbcf9445c9e59e53655b76f28f0fb1015cec9ccaa93b51f946adfb8df8324e7a12090191b189f06eac46384dfc3084fc67bc182ba87b24b539c09e8a5364ef83174f8157f524df4aff35d1e9d48967665cb43193d070ad269e3423cd9d8f3c3e6167f8c2f13b50cb585a15ccfbe35a36e7f40c9cc192bee4d87792314fd664f03da8374b081126bc3fb6c3eca1649320a2054442c12096c281254daa9b8c2867f7a25a51e9d6285e1740fd9b0dfaf95c0388943a2ebd023ff7d7128549f968e777d37c17e1179a7f47431401b1a0bf5deecd258333ebeb8964a5f76e76e07705de0fe4b4a0bee27b2466e7d3e74c755b73cdfc0b1b654ea861aa8df871845aac85738b4fb564016d97740c51f7bb59623ee0cbbda3d8010c9af8952fec1ec21018ff4af6b9eba169667bf3b32408fd74edda7e3d6a05fe0ad065d093c9bbe414457147c51",
            "47bc92e0356870e0a410d6d49af41690301a2bf84339040b6dd6202133ad5b70805208d553183fd2b43278d3ec1859b5f52dcd88309e5694568da49bb16f665e8cb26062e8a3bef47090a86baf2916ad812ce6f5c7422cd35f24c97454013f235124c3105cd29450c0718c264bf0f481ba629dc572ec2cce71e2b633832d8dc7",
            "47954ce98faebe50612ba0d819bccea10c1db9c47b1af544d7bf1105d42508d96829dfb8eeaa3874b9a17cb0e04ffe0d6ffba10c997114408a65ec6a9c88c3365160eec237d28b450df66d607ddb6f1031366aaebf5a91505db0f2840add8f116cbe32b277cb2003a8980f9bd069a1e4c13536c4a4317a5c4ee16fcd64d616c0ce3736dfac4f192807b4807957de8944a03f099fb2d780d1148703318f86e47edbc72413b95094cfba0906f677176b8eb12e98e5d335521637c79bb1fe1e9bcf657dff23ac7ad38c34b47b39ef3c8076f16c339edb9fb55ee0b197716dcb0ff32428db405f45bf30a565666ee0fea2acc129b28447b8fad8c0170269bd63948f9ca0bd281460c52c838a0666dd5003302d56e3b5cd225bebd96fb08e8e550bb50cd9c72e761d3c90cbe6517997f5df81444f37ba2f7229613cead3f32348f3702f44eb15884df8afc6e53939ecd5bb9152ad59f0f9441efaaf9e4f375776170aa437812a6bbf61304eb5c1cdcbc6a10a59a72c5eac2e50661ff96cbe9fbf4316",
            TestName = "ANS X931 Verify - 3072 - SHA-256"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d384, 3072,
            "d97f4f",
            "ca60b9a9317939ddfa248faefa815cab6ad95772e884e3c757d9b1cf51285867430a9c129952b45b1dc57c1bdba4cba79e1107cc1ab010e140b621d217feb5e30531991667b0d8fb453034001814e6ea1053793051d603e86488a2398f848efe87d8bbf0b1d85d16896dcd5027036ff2cd9b66e2348a427cfa4a6293bfaeec958a0c384730965a58f5e8bfdd6ccd022434f0136380558fa39c9d7fd05dfcdc01b20abde6f8fd6da99054faaadb5e8abd801a55a09a4e3237f75a796e280724489372040c4143641d30a6cdf7bd0e2702706140b9561fe481d0401e8084149dd80c27353f2cb163d585a8a2fb19bc720af6bd3f66c37eca8a8f99c8edb1ecc9fde2c142f9ff0e9d88f8e40c629037b7a0d7a6722dc0a8fe49f4c803ce56d2b872cd0a302179b43eda5dcdd917bf083ad53178dc1ba8d18e33fdd85c67b87817036d2f5cf5eb16fafab287dd3854d9b2f72f756d2b99d53f137c200ebbe3e5d8ba1c9731cd56b277be208f6c59b346b1eda9a7845868dfa76bbe24c7948db66855",
            "c4fb1e0d2a4de5c71098490f1ef8c40544af650f9f76d1ce9c1188515f266988664f79fb696ee0bb854134999a36fa97f2806a9c236a736c36ebffd6087b7830f1268b00a4df2cfc5616da35238d248fad676c740682ebc9d006f521a23e7e31aea7de85a147d171cb40c24980a549d4be8cf2ff0f6540cfb18af199f5178475",
            "54330836c0a8b769285fe39c1135799cef407b601b6d88f6de9b94e0f351a60bf60b43d0a4863af9a324129f7055013c818c6b3debc3a99990d22f65c40b6bb44771d2d5fda3d090dd5419af3389805d61d7c0a869a7b286571c6b8ccf3fa62666f74e6919b172c0ee7487f19bf1bffa8ea1f810eb704e11d80db964fa6343a7340c7f5737b720ebbac7da01f864d46089f719b280076ae1cfc83c5aee3b24120788f490b4b8f1166aede921b02a5be48e82d7ad5af83372b983402623be7467033b25075783f6ea7d9cf42bd9bf8894f8e441e62f2ab573a9c1174cbf93b7b6c39da3f33036bf7fbe010f15fdd32dde85024cb0135e8e3a022402118182586aa5a0b5995e74ac4c9727ecce5a70ee37dfec91dde4ecec939850431021b0ccc772d9b6099c197e346f06fed95be6d0f802727de7a7e091d9c999faecdb1edd97f1213b2bdc8dfd00422d509775564d7f52955a8df641fb5b4540efea60dc1ebe029d8ae52cf45da84bc263ab9f37d2686cc6f602d620d508b0ce3857841c7d7e",
            TestName = "ANS X931 Verify - 3072 - SHA-384"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512, 3072,
            "f3a48d",
            "a5d76a9989211a5fcaf1be686e43ee8eaf3897e4e86408f75a83a7243ecf428c9b41487671bc7713998fca117e5cc25e21b5f747b15baeea08749b9fc4565641b46d7d31c4ffadaba190e1bdf2c9dfa4c0b717651ea139271e9ad4925c2cece3476260b79513ba53911b6cb598a95a9b940358b69cb940683e4d85c09aeef1f10c536b20553950c80b2604dadf91771a920e0fedccbd41dae9a16a60a3ac3be49725cee1c9c27e8ba9be315d07f6f8c89279f103754be4e416e96332540d338d5c6e519cb55ae8f400c6f472cb6bfc0f5d169ce1e6696ee1207d8ddae3d495a8b3a9632e60c60721716d6160954d654b8ab1595adb137b5e0b8c16e95a6f6498fc2f37554d4821b079813f0e9a5a715007eec91ab19d3dc3b735343c3700ce77c099b0c815c6f5a7661467292a255ee3fd088d53964b81eb83e6ed61aee2171fe84a27e7216f6438575670433136f74eade198906fed3ba8865470a79d29abcbd1014ffc6f745fcf07c02f669004837f9a9f6217e4a18ca195436e39ca31f299",
            "d993f55123ac01667b246327c8ceec2c0f2f6630f5ea2f207f7c27721d29ccb8e736a4752659dc2f166e2ec5ea6b08031196ea74b8f60f7790075195d1b247127f7bb0c2ecfd141e7e93a897b259732b6153af3542eb7289b1a18dc0aefeb4d129c9e0e27d7ef25d3afc9945277e75cb87cc7d1c9cb39e7e6ab2a49bbdf65e1c",
            "36515d1109a32f90e9781574e5c8e48bb31db004a5c0f8062b0f663612d42c329aa01fdaf9ca5dee4278af2d6fd0ff27dfccd14a7a8fd562716b02305687f4a6ae06bcef5a038c76b54a0d0793ef40a3071f3f42ff2bd9604149e2f8a60bf8abc16a58ce5aaaff310e0fbaf1afc8f042420c4733204fb7e204e8b6eb3330d1da14fe5e08d2384e361aad4f89277d151acadc34f60bbe60d5c52ffe90ba3a7c3428fdfe25b10d562aa9597f0778e45c7af388458e300f6c4c943e5daee2ce75bd97bbac44a2f685c6c76238e10895bcb0217e542b70d34c4d78c0e92846281c62071c86ac5e923603dc3d4267f7d1c2c35929ba30df4138ea82d8b537e86dd293c789afc11e6c2fd5a47b42d64afa5b01aa72cb22177f61db1c9f8fbd4d7f7d05025758106806e5bfbfcea32c7d47e9618dfb86ba92fad131caf2bd25ae0911f556ce784bf604075dc66b13be04791076433705fc4ad2b5e923a79b6d2b67b5037037ceb9544e9cb1efa4879ca911c3a266bbe6a8a23ce7a3455ebf8c7e48dbc3",
            TestName = "ANS X931 Verify - 3072 - SHA-512"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t224, 3072,
            "f51501",
            "9ae12bddf01bbbcec1f18bf749075914d45c92a5981498c0949835e5196fa37a87464aa90d847235ca656de2943e4e6b9c9454cc389c4d4b90764043f7154c541fe4ae3c859d89d9a11f432607def1e738e6c103cda009d9bd420cfa48242070988ee8860c1468a6843881909ba84c49300b6fdf8a0a1548aa6300f61cf1dfcec0ea50b65601b7a327ef7c08ae98536152866b0a3753f0361c2a4a701737a8b626cbfca2cd32a6c8c4559d758ccee511b51f7ec4b6a4ef308823e1c132d3109c0c6199cc895f220e307ffd2968c0f02aa5528d8034681e18ea6bce8500eb7923ab6ad59a51282e384b788dd77f4e16a47a1bb55cc375b400cc2c7368f1e5fef07385396744c27b82fa376f729174a98a6e876bdb5960c6ea8f6c7d3764f2c16a122105dd441b50acd53bd626ebfc191a4f4f729d1f497bf00155496db501ec327fad1a5677a853ae3b7d3738b2cbb446e477a1af8c99e64386c65a8393b0c8e48cd408e07c2a2c5f3b59e04d17926dbba43e844d2fd570fab5e8999f570facc3",
            "6de40e4f02769c179348d88eeb470aacb3c54bf8e81f964b8c9d22d79b99ef6740e49fe849658829d90307df5cc617ecc03822e1e31217c14714bc080d3546eb21fc27e2b22e2764e5a9b6f1ca9080568fa8432df302dda3fedbaa7eefc00c5e77f64b422418a04f20028ccd1bee6e7386dd55e40239137918b893412a836c46",
            "153c3045381b4f5388907b3155ba72140d89fc98eb0937e4f66ad16fd9744db1acf2085b8d74d746711fb895c80224918ff29d7780cd3ece532ec975fb43066a4cfdf9879691da75313bf70b7bce0ec0c29311860fbd1b19a238c81a7b4c1d606ae70707a5eaa851cc41597e67f5ce8d54c861af87fae22ba8340bcfcaaf82a7105f1919a4495bd713e2c9bbe36c4a47f5a05bc09a73131e521208cbdcca736e46b07e09f277351be9b76f0aaf8a4d53fbea228d73529d2a99b1aa20a77fdc43998cdad2a191b75262fb4e4adcbd89c280e8eae07c32898f31ee93809ebceb9b0cdd4a683b3d5d3be4a93d60d5e5e731ce097806c55ccabfefa17b4a7a84147098cab1dfd49a1e6b598acba7f12848ae3795068ccba6ce5248235c8d69d74994785019f7a21e8722f2ad875b741dfcdf5a78fb1477b2c059848530e37809b96f36da4cc857f104571a663155f09922d3f47fe7285bacd08627abbb0255128d6e68430ee38a4e2d91454c09f45966746d08c95a0de64243d296234dedfbd8ccb5",
            TestName = "ANS X931 Verify - 3072 - SHA-512/224"
        )]
        [TestCase(ModeValues.SHA2, DigestSizes.d512t256, 3072,
            "c9a021",
            "a7651cdece05fc7ca84f7a477043a185a96dd481174a8f569306538532fc7f2e24d485d756c6e676651da49e25e2fbf547fcdc7a51bd56787501f66705589ab19d1ef24bf78b069c87957ee8c29ac8a6325cd96a58cba9da758c93fa62f96b6f2a997fc07004b6658b9cac744e09b68123a31921726703b03905c3a5d45b6eecb84df72cf4f6dbc18c4ad959b23d104f3dc3e30f0fae8813ff01616d95fb97877ac2c892f0b4af9a5884cdeb780b4ebffa063877789dbbf3f29d119cf899eb60d58e3d4dc9ac91ccb875c48e9fe85785f5e655e9a4f709e4a6984740b7471464639078c469e36da0b3c6b344db6f3da361977e449350e2513809e3aed9ec57008f246b9a75ffb5f398b015f83be25c659db64a7db07adc38e727e49225a94d928fb55e53b28b52a0378b535ffda6f62c0f1583c6682350823bc9979d588d57888d3c21f07c74996d3bdeb8258c35d463e90d8e4c5b452f321965882bb9bd2aae53624916120b8637ea5b82f2192278b36037e87906e3b1dbae06442a880e4a25",
            "91f231bfe4f47c2fe2577fe1dd72477b73bc7fd0c132415fd4f92c1c6045b774b579c48bee9079c86cbb4b93834b5b5d72d206e19985b7aae6e500d6919fea1909b089052eccd388c001b2b6179857c8153cd2655a5edf21b6d70344e4cfd8cc75dea5b50a723277c671dbd1031fe2c544410ae46b8361cb2d175deec29f2a94",
            "11a03b4bdb0b7efb83a0b674d241f9b264e4b24cae0a747da267bc102fce974c3230e44a422ece39ba0e91836bad424b60f8c9f1f039644c61d92bb8b2823554dd80fc405ac4d7c29689e1c3f4a220507fa983325b82ed8767eff5428844feeaddd291ff767992eb497cefd811f7781e84ddb5cff5281b41bfdce10eb6bdb063dd58cc794405861a99d71ba2890dfa72455c0e95f90b0e352d08b8aa6bd65ee4ae64eadf5b16cf75142dcd20a46cf0655c97739b2861b0b11e0571a323780334c33b7bef502fefc218cb404f77b5d16d65f2291be8b33494e33359b3e238e74bcf5394297a480fef04b555d788618e924ae25cc70a733913a8bfaa56f375c6f5f6e98608fa347b1306b9a87901efbd441390f87c6ec1534a9ca53d9093ca83902644e7cbc380523a879a82bcfba51991f2270ca1104198bbd028655d9e1016e422711c6cfcbcd50b309cc0e599ebf6e461917fae9d676d2a00ec09c45be22c124a72f5a84b2e2f56a7a8e8ada59a1ca267141d4a154d409b8be1a302cfdf99f3",
            TestName = "ANS X931 Verify - 3072 - SHA-512/256"
        )]
        #endregion VerifyTests
        public void ShouldVerifyCorrectly(ModeValues mode, DigestSizes dig, int nlen, string eHex, string nHex, string msgHex, string sigHex)
        {
            var shaFactory = new ShaFactory();
            var sha = shaFactory.GetShaInstance(new HashFunction(mode, dig));
            var signatureBuilder = new SignatureBuilder();
            var ansxPaddingScheme = new AnsxPadder(sha);

            var msg = new BitString(msgHex);
            var e = new BitString(eHex).ToPositiveBigInteger();
            var n = new BitString(nHex).ToPositiveBigInteger();
            var pubKey = new PublicKey {N = n, E = e};
            var sig = new BitString(sigHex);
            var rsa = new Rsa(new RsaVisitor());

            var result = signatureBuilder
                .WithMessage(msg)
                .WithSignature(sig)
                .WithPublicKey(pubKey)
                .WithDecryptionScheme(rsa)
                .WithPaddingScheme(ansxPaddingScheme)
                .BuildVerify();

            Assert.IsTrue(result.Success, result.ErrorMessage);
        }
    }
}
